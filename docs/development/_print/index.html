<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.139.4"><link rel=canonical type=text/html href=/docs/development/><link rel=alternate type=application/rss+xml href=/docs/development/index.xml><meta name=robots content="noindex, nofollow"><link rel=icon type=image/svg+xml href=/favicons/favicon.svg><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png><link rel=icon type=image/png href=/favicons/favicon-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/favicon-64x64.png sizes=64x64><link rel=icon type=image/png href=/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/favicon-128x128.png sizes=128x128><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Development | YMCA Website Services</title>
<meta name=description content="Welcome to the development corner of the YMCA Website Services distribution.
For YMCA Associations OpenY Release Schedule For Developers Development Processes Updating YMCA Website Services Development FAQ Code review best practices For QA Engineers YMCA Website Services Smoke Tests Index Community Guidelines Best Practices Code of Conduct Coding Standards Pull Request Standards Legal Participant Agreement Terms of Use Terms and Conditions Getting Started with YMCA Website Services Development Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of Sandboxes that you can use."><meta property="og:url" content="/docs/development/"><meta property="og:site_name" content="YMCA Website Services"><meta property="og:title" content="Development"><meta property="og:description" content="Welcome to the development corner of the YMCA Website Services distribution.
For YMCA Associations OpenY Release Schedule For Developers Development Processes Updating YMCA Website Services Development FAQ Code review best practices For QA Engineers YMCA Website Services Smoke Tests Index Community Guidelines Best Practices Code of Conduct Coding Standards Pull Request Standards Legal Participant Agreement Terms of Use Terms and Conditions Getting Started with YMCA Website Services Development Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of Sandboxes that you can use."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Development"><meta itemprop=description content="Welcome to the development corner of the YMCA Website Services distribution.
For YMCA Associations OpenY Release Schedule For Developers Development Processes Updating YMCA Website Services Development FAQ Code review best practices For QA Engineers YMCA Website Services Smoke Tests Index Community Guidelines Best Practices Code of Conduct Coding Standards Pull Request Standards Legal Participant Agreement Terms of Use Terms and Conditions Getting Started with YMCA Website Services Development Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of Sandboxes that you can use."><meta itemprop=dateModified content="2024-08-15T16:38:16+03:00"><meta itemprop=wordCount content="244"><meta name=twitter:card content="summary"><meta name=twitter:title content="Development"><meta name=twitter:description content="Welcome to the development corner of the YMCA Website Services distribution.
For YMCA Associations OpenY Release Schedule For Developers Development Processes Updating YMCA Website Services Development FAQ Code review best practices For QA Engineers YMCA Website Services Smoke Tests Index Community Guidelines Best Practices Code of Conduct Coding Standards Pull Request Standards Legal Participant Agreement Terms of Use Terms and Conditions Getting Started with YMCA Website Services Development Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of Sandboxes that you can use."><link rel=preload href=/scss/main.min.ba7dada1c07c0f45d2bd8f9ebeeb8a55b37178c66890f39fb1822de52264d26d.css as=style integrity="sha256-un2tocB8D0XSvY+evuuKVbNxeMZokPOfsYIt5SJk0m0=" crossorigin=anonymous><link href=/scss/main.min.ba7dada1c07c0f45d2bd8f9ebeeb8a55b37178c66890f39fb1822de52264d26d.css rel=stylesheet integrity="sha256-un2tocB8D0XSvY+evuuKVbNxeMZokPOfsYIt5SJk0m0=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.6.3.min.js integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin=anonymous></script><link rel=preload href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.5.2 as=style integrity="sha512-TW5eKlwwg7OfQUVBqxjp94/uqtjJJbhkRE3++XGEQjAL1n3y//QVqS3acPkwqkzInaFRtj+w05uyxDbfDXiI1A==" crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.5.2 integrity="sha512-TW5eKlwwg7OfQUVBqxjp94/uqtjJJbhkRE3++XGEQjAL1n3y//QVqS3acPkwqkzInaFRtj+w05uyxDbfDXiI1A==" crossorigin=anonymous></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-3GMSKCY94X"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3GMSKCY94X")}</script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 288 221" enable-background="new 0 0 288 221"><path fill="#fff" d="M258.829.94h-82.891c-6.134.0-11.106 4.972-11.106 11.105.0 1.912.42 3.702 1.326 5.272l41.607 72.061a11.09 11.09.0 009.617 5.57c4.117.0 7.701-2.244 9.619-5.57l41.604-72.061c.908-1.57 1.328-3.36 1.328-5.272C269.934 5.912 264.967.94 258.829.94m17.034 6.017a6.07 6.07.0 016.074-6.068 6.064 6.064.0 016.062 6.068 6.065 6.065.0 01-6.062 6.071 6.07 6.07.0 01-6.074-6.071m1.252.0a4.832 4.832.0 004.822 4.817 4.83 4.83.0 004.811-4.817 4.82 4.82.0 00-4.811-4.81 4.823 4.823.0 00-4.822 4.81z"/><g><defs><rect id="SVGID_1_" width="288" height="221"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#fff" d="M284.217 10.003h-.578c-.225.0-.344-.027-.51-.221l-1.645-2.056h-.438v1.948c0 .248-.102.329-.314.329h-.4c-.273.0-.367-.053-.367-.329V4.221c0-.296.174-.307.367-.307h1.754c1 0 1.209.059 1.566.413.312.326.463.892.463 1.703.0 1.025-.412 1.601-1.344 1.67l1.562 1.866c.181.216.149.437-.116.437m-1.475-5.117c-.244-.12-1.385-.065-1.695-.065V6.82h1.162c.412.0.607-.067.719-.207.064-.107.131-.218.131-.665.0-.672-.108-.949-.317-1.062zm-152.965 98.36c0 .01.01.017.01.022v-.009l-.01-.013m73.032 1.39-.457-.79-52.35-90.674C145.639 5.613 137.273.94 127.98.94H85.549a8.573 8.573.0 00-8.571 8.57c0 1.471.34 2.881 1.024 4.06l51.785 89.698a27.014 27.014.0 013.728 13.735c0 4.864-1.281 9.424-3.517 13.371l-45.029 78.001c-.683 1.172-1.021 2.584-1.021 4.057a8.567 8.567.0 008.57 8.568h43.537c9.289.0 17.658-4.67 22.021-12.228l.896-1.56 43.299-74.998.807-1.395c2.207-3.827 3.227-8.203 3.227-12.854.0-4.846-1.242-9.423-3.496-13.329z"/></g><path fill="#fff" d="M83.18 140.865c-.793.0-1.584.327-2.309.457-2.436.527-5.139 1.058-8.037 1.058-1.582.0-3.035-.332-3.957-.726-2.041-.921-2.238-3.493-2.174-6.792h16.079c2.306.0 2.767-.392 2.767-4.016.0-4.223-.392-8.371-2.435-11.334-1.911-2.703-5.208-4.089-10.677-4.089-5.798.0-9.427 1.517-11.4 4.353-2.047 2.896-2.641 6.785-2.641 12.582.0 6.53.924 10.817 3.695 13.385 2.173 2.042 5.735 3.09 10.68 3.09 2.831.0 6.717-.261 9.942-.856 2.047-.327 2.375-1.378 2.375-2.898.0-.726.0-1.518-.127-2.173-.201-.858-.795-2.041-1.781-2.041M66.703 128.47c0-4.807.992-6.453 5.734-6.453 4.483.0 5.071 1.709 5.071 5.795v1.255H66.703v-.597zm-23.548-13.046c-3.562.0-6.722 1.184-8.902 2.239v-12.191c0-1.251-.524-2.838-2.566-2.838h-2.965c-1.91.0-2.899.594-2.899 2.838v39.875c0 1.578.526 2.629 2.375 2.629h3.489c2.042.0 2.566-1.119 2.566-2.964V129.91c0-4.726.978-6.338 5.633-6.338 4.406.0 4.988 1.679 4.988 5.688v1.232h-.018c.01.635.016 1.357.016 2.168v12.352c0 1.98.654 2.964 2.368 2.964h3.5c2.035.0 2.566-1.119 2.566-2.964v-20.227c0-4.29-2.045-9.361-10.151-9.361zM18.977 123.327h-7.115v13.25c0 3.095.133 4.283.396 4.808.198.335.532.529.987.529 1.849.0 3.884-.987 5.406-.987 1.451.0 1.783 1.12 1.783 1.841v2.373c0 2.439-.664 3.103-2.769 3.298-2.11.196-3.559.328-5.739.328-6.989.0-8.5-2.57-8.5-10.413v-15.026H1.58c-1.248.0-1.58-.855-1.58-1.908v-2.836c0-1.65.656-2.174 1.777-2.174h1.649v-5.34c0-2.24.922-2.902 2.834-2.902h2.967c2.041.0 2.635 1.648 2.635 2.902v5.34h6.461c1.447.0 2.24.198 2.24 2.109v2.304c0 2.239-.398 2.504-1.586 2.504m155.151 76.898 5.053 8.552 4.775 2.756c.662.384.797.88.422 1.517l-.541.961c-.43.733-.824.945-1.598.496l-4.598-2.654-10.481-.123c-.293.007-.572-.034-.773-.151-.549-.317-.414-.92-.205-1.278l.689-1.195c.383-.665.756-.745 1.287-.737l7.179.144-3.701-6.226c-.268-.45-.364-.806.021-1.471l.566-.976c.334-.582.795-.668 1.219-.422.266.151.539.549.686.807M196.514 192.042l-.539.93c-.383.664-.857.715-1.508.402l-9.376-4.642c.388.461.945 1.079 1.377 1.563 1.676 1.976 3.5 4.006 4.571 5.369.43.543.584.991.164 1.715l-.332.582c-.426.734-.876.804-1.562.701-1.713-.25-4.413-.767-6.963-1.234-.646-.106-1.436-.326-2.029-.43l8.705 5.804c.602.406.793.845.412 1.502l-.541.937c-.398.687-.867 1.035-1.652.496l-12.277-8.604c-.76-.526-.567-1.065-.258-1.601l.705-1.222c.357-.618.74-.816 1.344-.734 2.521.359 6.938 1.219 10.326 1.811-2.209-2.633-5.166-6.028-6.736-8.032-.371-.481-.391-.906-.031-1.528l.703-1.222c.309-.531.682-.97 1.516-.578l13.585 6.336c.859.4.794.986.396 1.679M203.475 180.39c-.486.998-.758 1.57-1.35 2.595-.477.825-1.117 1.787-1.781 2.468-2.541 2.655-5.602 1.803-9.447-.416-6.528-3.771-6.558-6.541-4.058-10.873.594-1.023.955-1.554 1.574-2.47.592-.873.949-.992 1.449-.703l.731.421c.795.459.984.75.574 1.454-.475.828-.818 1.164-1.497 2.341-.414.711-1.012 1.903-1.088 2.602-.178 1.642 1.554 2.699 4.108 4.168 2.512 1.453 4.541 2.453 6.01.727.299-.361.705-.957 1.102-1.645.68-1.178.803-1.645 1.273-2.469.408-.709.752-.687 1.555-.224l.734.421c.488.281.572.656.111 1.603M211.623 165.868l-.705 1.221c-.398.688-.844.697-1.381.594l-3.344-.621c-.529.97-.936 1.679-1.505 2.654a94.672 94.672.0 01-1.493 2.539l2.105 2.406c.486.545.715.916.277 1.666l-.588 1.028c-.438.758-.701.75-1.031.556-.135-.072-.365-.296-.588-.576l-10.078-11.888c-.547-.648-.719-1.07-.242-1.889l.523-.909c.473-.826.93-.892 1.736-.75l15.719 2.678c.139.019.273.041.391.106.55.319.409.828.204 1.185m-14.471-.537 4.211 4.809c.297-.516.621-1.127.992-1.768.398-.693.691-1.148 1.062-1.791l-6.265-1.25z"/></svg></span><span class=navbar-brand__name>YMCA Website Services</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class=nav-item><a class=nav-link href=/docs/glossary/><span>Glossary</span></a></li><li class=nav-item><a class=nav-link href=/roadmap/><span>Roadmap</span></a></li><li class=nav-item><a class=nav-link href=/blog/><span>Updates</span></a></li><li class="td-light-dark-menu nav-item dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"><div class=td-search><div class=td-search--algolia id=docsearch-1></div></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/development/>Return to the regular view of this page</a>.</p></div><h1 class=title>Development</h1><ul><li>1: <a href=#pg-8c95d8532edc4e6a021339f13237038a>Onboarding</a></li><ul></ul><li>2: <a href=#pg-0eec02d1f012c235d94eea040b06de14>3rd-party dependencies</a></li><ul></ul><li>3: <a href=#pg-66142b350bf5e809654b6436938cc4b0>Acceptance Testing</a></li><ul></ul><li>4: <a href=#pg-003c35fb6d8352141e0a16ef5597a8c4>anti spam protection</a></li><ul></ul><li>5: <a href=#pg-266b7a98bf0aedb541c3d57319c11a3a>Code of Conduct and Best Practices</a></li><ul></ul><li>6: <a href=#pg-69c079fb4921132db608af61d6beff86>Code Review Quality Best Practices</a></li><ul></ul><li>7: <a href=#pg-8458fa891c891e6ac5d1a8398940de90>Colorways</a></li><ul></ul><li>8: <a href=#pg-e516f4f95441139c8e710754b11eea8e>Composer</a></li><ul></ul><li>9: <a href=#pg-5702b65f9b76db2a1abac3c7e55ba756>Composer version constraints for YMCA Website Services</a></li><ul></ul><li>10: <a href=#pg-b710d1098232c9abd460f1a431e5a118>Contributing</a></li><ul></ul><li>11: <a href=#pg-53910b8a7d1743cda23cda2569e58867>Create & Use New View Modes</a></li><ul></ul><li>12: <a href=#pg-421b29718da441e0406edf863b72067f>Daxko</a></li><ul></ul><li>13: <a href=#pg-cf2281b87b1905231b650c39b1b9e2a9>Decoupled (external) projects</a></li><ul></ul><li>14: <a href=#pg-98387d4c80a088cd89ca1eedb9435593>Decoupling components as independent modules</a></li><ul></ul><li>15: <a href=#pg-2ee1799b8bdaad376953162d43cb32a4>Dependencies in drupal info.yml</a></li><ul></ul><li>16: <a href=#pg-d0234314d5cf529adfacfd9dc234a2fc>Deprecating and removing components</a></li><ul></ul><li>17: <a href=#pg-e5e77b82ed465a1a79e16199974124db>Development FAQ</a></li><ul></ul><li>18: <a href=#pg-ba2edc5c10fdcc4292e7ed4d4626d912>Drupal 10 update</a></li><ul></ul><li>19: <a href=#pg-12d4beeaad5bdb13df8a46a690efc2f6>Drupal 9 core dependencies version flexibility</a></li><ul></ul><li>20: <a href=#pg-fc55a1b49a06c32f686fcc092df7cd28>Drupal-SA-CORE-2018-004 security update</a></li><ul></ul><li>21: <a href=#pg-82275f3be4b9061ff50a7f386c6ae551>Google Custom Search Configuration</a></li><ul></ul><li>22: <a href=#pg-80222643eee1c09fc10870b87cfa2b27>GroupEx PRO quick start</a></li><ul></ul><li>23: <a href=#pg-b42f02de276f63b60282c5e601fb0b1f>How to contribute large features (back-porting, etc)</a></li><ul></ul><li>24: <a href=#pg-08b6528e0a5921b4742caeb5a3590d80>How to develop themes in YMCA Website Services</a></li><ul></ul><li>25: <a href=#pg-0370c16bd6bdb61a50279a5d0c3f59b2>Important versions for upgrade path</a></li><ul></ul><li>26: <a href=#pg-17567d6693fe9a00b0a5bf3af2788b5a>Install Solr site search</a></li><ul></ul><li>27: <a href=#pg-f0f2cd2b401cae86c91fe6759f168e26>Install SSL certificate</a></li><ul></ul><li>28: <a href=#pg-febf06c2a321ab3f2bd52b94caddd713>Installation With Drush</a></li><ul></ul><li>29: <a href=#pg-b3449da639923af81005cfe31af51cac>Module Development</a></li><ul></ul><li>30: <a href=#pg-1300e8e5aebb2d73df94f2f6c04962af>one-click install how-to</a></li><ul></ul><li>31: <a href=#pg-81195635ad423ad343082fdc4ecab652>Open Y analytics sunset</a></li><ul></ul><li>32: <a href=#pg-a97c11c973243b9fd7fa8284b4f9070b>Participant Agreement</a></li><ul></ul><li>33: <a href=#pg-b12f79c60869676dba1be99d0244ac4c>Patch YMCA Website Services</a></li><ul></ul><li>34: <a href=#pg-d215f669ae63afefbf5a776f222b4243>Profile custom configuration</a></li><ul></ul><li>35: <a href=#pg-e55df29deb8e9db26c29eaed2c619fb0>Program Event Framework</a></li><ul><li>35.1: <a href=#pg-6b6cd6f32e13540ecf39f3e05cf11aa0>Activity Finder</a></li><ul><li>35.1.1: <a href=#pg-6baf5f590747c78e0e74a2ef64afd201>Adding Activity Finder to your site</a></li><ul></ul><li>35.1.2: <a href=#pg-b2056fc5cab10f929a44c332b8102fc8>Bootstrap version support for Activity Finder</a></li><li>35.1.3: <a href=#pg-64bd222410c78abcfc9f90c814006a69>Configuring Solr for Activity Finder</a></li><ul></ul></ul><li>35.2: <a href=#pg-d548bf68496eaba7c365614751b91cc6>PEF Schedules</a></li><ul></ul><li>35.3: <a href=#pg-8789c12d3402c271167ebb2ef622955a>Traction Rec Integration</a></li><ul></ul></ul><li>36: <a href=#pg-541617a506b4363b56c7bcf59ec9f30a>Pull Requests review standard</a></li><ul></ul><li>37: <a href=#pg-4fec31bc5d3f3949a48b79b2c5d0264a>Release processes</a></li><ul></ul><li>38: <a href=#pg-d2ae48703454e5a7b7a33f10fe06c223>Release Schedule and Guidelines</a></li><ul></ul><li>39: <a href=#pg-18ec7b7f0e48493342dfc92282bc850f>SA-CORE-2018-002 security update</a></li><ul></ul><li>40: <a href=#pg-3e458c8850b84d0f6330b82b6e574591>Sandboxes</a></li><ul></ul><li>41: <a href=#pg-634b272db567df243c17992d22637c3e>Secure devops for composer 2 release</a></li><ul></ul><li>42: <a href=#pg-8d4cd1fe848b513772e1d10d2af1b2d2>Server Requirements</a></li><ul></ul><li>43: <a href=#pg-927b4dc0cbf26cc50923ce4b32e9704a>Smoke Tests Index</a></li><ul></ul><li>44: <a href=#pg-de155b22fcc9252bfab1ce44463bf1f3>Start new YMCA Website Services project</a></li><ul></ul><li>45: <a href=#pg-51589e8d7642df820aa44605d589f220>technology pipeline</a></li><ul></ul><li>46: <a href=#pg-3551213e6f9ca5f228f4a74ba85ceae9>Terms and Conditions</a></li><ul></ul><li>47: <a href=#pg-ce698b250a98968edd46374b53279593>Testing YMCA Website Services for PHP 7.4 version support</a></li><ul></ul><li>48: <a href=#pg-9c3ba0a566fd06ae070db6a9704be0f4>Tests</a></li><ul></ul><li>49: <a href=#pg-846d22eabec2b7a086b1319b7a0152f9>Theming and Design</a></li><ul></ul><li>50: <a href=#pg-1e0608324e7cc6c56e78ac8c0c3cd375>Tour</a></li><ul></ul><li>51: <a href=#pg-f95cce86e97c20c8b981ca9d0ba2caad>Upgrade OpenY 8.1.3 to 8.2.2.1</a></li><ul></ul><li>52: <a href=#pg-67ca83e8e9fe6bc99856967b843bef43>Upgrade path</a></li><ul></ul><li>53: <a href=#pg-d431a35b8f6dfca62f50b56faab041c0>Upgrade to Open Y 1.x</a></li><ul></ul><li>54: <a href=#pg-bffcf0befc5ba9efa917cebf13e6a9b4>Upgrade use case from 8.2.2.3 to 8.2.7.3</a></li><ul></ul><li>55: <a href=#pg-162c99cc4ea4af161d0d5efe9d6f9028>Upgrading from 9.2.11.5 to 10.3</a></li><ul></ul><li>56: <a href=#pg-1fa923d650f02253cc2538ed936380ca>Upgrading to a new version of the distribution</a></li><ul></ul><li>57: <a href=#pg-143fb946dce93f2b691f74685ff6064a>Videos</a></li><ul></ul><li>58: <a href=#pg-4a27a35c82c95f9ac91303400eed7ee2>Virtual Y Configuration</a></li><ul></ul><li>59: <a href=#pg-8f2050f68eaacd2d7561812d82b58c3c>Website Services Terms of Use</a></li><ul></ul></ul><div class=content><p>Welcome to the development corner of the YMCA Website Services distribution.</p><h2 id=for-ymca-associations>For YMCA Associations<a class=td-heading-self-link href=#for-ymca-associations aria-label="Heading self-link"></a></h2><ul><li><a href=/docs/development/open-y-release-schedule-and-guidelines/>OpenY Release Schedule</a></li></ul><h2 id=for-developers>For Developers<a class=td-heading-self-link href=#for-developers aria-label="Heading self-link"></a></h2><ul><li><a href=/docs/development/open-y-technology-pipeline/>Development Processes</a></li><li><a href=/docs/development/openy-upgrade-how-to-for-developers/>Updating YMCA Website Services</a></li><li><a href=/docs/development/development-faq/>Development FAQ</a></li><li><a href=/docs/development/code-review-quality-best-practices/>Code review best practices</a></li></ul><h2 id=for-qa-engineers>For QA Engineers<a class=td-heading-self-link href=#for-qa-engineers aria-label="Heading self-link"></a></h2><ul><li><a href=/docs/development/open-y-smoke-tests-index/>YMCA Website Services Smoke Tests Index</a></li></ul><hr><h2 id=community-guidelines>Community Guidelines<a class=td-heading-self-link href=#community-guidelines aria-label="Heading self-link"></a></h2><h3 id=best-practices>Best Practices<a class=td-heading-self-link href=#best-practices aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a></li><li><a href=/docs/development/code-review-quality-best-practices/>Coding Standards</a></li><li><a href=/docs/development/open-y-pull-requests-review-standard/>Pull Request Standards</a></li></ul><h3 id=legal>Legal<a class=td-heading-self-link href=#legal aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/ws-participant-agreement/>Participant Agreement</a></li><li><a href=/docs/development/ws-terms-of-use/>Terms of Use</a></li><li><a href=/docs/development/ws-terms-conditions/>Terms and Conditions</a></li></ul><h2 id=getting-started-with-ymca-website-services-development>Getting Started with YMCA Website Services Development<a class=td-heading-self-link href=#getting-started-with-ymca-website-services-development aria-label="Heading self-link"></a></h2><p>Whether you are just getting started with YMCA Website Services or need to test a feature in a stable environment, the YMCA Website Services Core Team maintains a number of
<a href=/docs/development/sandboxes/>Sandboxes</a> that you can use.</p><h3 id=processes--components>Processes & Components<a class=td-heading-self-link href=#processes--components aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/open-y-technology-pipeline/>Development Processes</a></li><li><a href=/docs/development/development-faq/>Development-FAQ</a></li><li><a href=/docs/development/videos/>Videos</a></li><li><a href=/docs/development/openy-anti-spam-protection/>Spam Protection Strategies</a></li></ul><h3 id=environment-setup>Environment Setup<a class=td-heading-self-link href=#environment-setup aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/open-y-3rd-party-dependencies/>Tech Stack</a></li><li><a href=/docs/development/open-y-one-click-install-how-to/>Open-Y-one-click-install-how-to</a></li><li><a href=/docs/development/install-solr-site-search-for-open-y/>Install-Solr-site-search-for-Open-Y</a></li><li><a href=/docs/development/install-ssl-certificate-for-the-openy-site/>Install-SSL-certificate-for-the-OpenY-site</a></li><li><a href=/docs/development/drupal-9-core-dependencies-version-flexibility/>Switching Drupal Core Versions</a></li></ul><h2 id=contributing-to-ymca-website-services>Contributing to YMCA Website Services<a class=td-heading-self-link href=#contributing-to-ymca-website-services aria-label="Heading self-link"></a></h2><h3 id=working-with-existing-functionality>Working with Existing Functionality<a class=td-heading-self-link href=#working-with-existing-functionality aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/how-to-develop-themes-in-open-y/>Working with Themes</a></li><li><a href=/docs/development/open-y-2.0-root-yaml-files/>Working with the YMCA Website Services Profile</a></li><li><a href=/docs/development/open-y-smoke-tests-index/>Smoke Tests for Validating Changes</a></li></ul><h3 id=adding-and-removing-functionality>Adding and Removing Functionality<a class=td-heading-self-link href=#adding-and-removing-functionality aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/how-to-contribute-large-features-into-open-y-backporting-etc/>How to Contribute a New Component</a></li><li><a href=/docs/development/deprecate-and-remove-components-from-open-y/>How we Deprecate Components</a></li></ul><h3 id=dependency-management>Dependency Management<a class=td-heading-self-link href=#dependency-management aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/composer-version-constraints-for-open-y/>Managing Composer Version Constraints</a></li><li><a href=/docs/development/secure-devops-for-composer-2-release/>Updating to Composer 2</a></li></ul><h3 id=decoupling-ymca-website-services>Decoupling YMCA Website Services<a class=td-heading-self-link href=#decoupling-ymca-website-services aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/decouple-component-from-open-y-as-independent-module-project/>Intro to Decoupling YMCA Website Services Components</a></li><li><a href=/docs/development/decoupled--external--projects-of-openy/>List of Decoupled Components</a></li><li><a href=/docs/development/dependencies-in-drupal-info.yml/>Managing Drupal Dependencies while Decoupling</a></li><li><a href=/docs/development/open-y-update-sunset---opt-out-tutorial/>Analytics Decoupling and Opt-out</a></li></ul><h2 id=ongoing-maintenance>Ongoing Maintenance<a class=td-heading-self-link href=#ongoing-maintenance aria-label="Heading self-link"></a></h2><h3 id=releases>Releases<a class=td-heading-self-link href=#releases aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/open-y-release-schedule-and-guidelines/>Open-Y-Release-Schedule-and-Guidelines</a></li><li><a href=/docs/development/how-we-release-openy-distribution-from-code-perspective/>How-we-release-OpenY-distribution-from-code-perspective</a></li></ul><h3 id=update-processes--notices>Update Processes & Notices<a class=td-heading-self-link href=#update-processes--notices aria-label="Heading self-link"></a></h3><ul><li><a href=/docs/development/openy-upgrade-how-to-for-developers/>Updating YMCA Website Services</a></li><li><a href=/docs/development/important-versions-for-upgrade-path/>Important-versions-for-upgrade-path</a></li></ul><p>These documents are for old versions of YMCA Website Services, but may contain useful information for troubleshooting future update issues.</p><ul><li><a href=/docs/development/openy-security---drupal-sa-core-2018-004/>SA-CORE-2018-004</a></li><li><a href=/docs/development/openy-security-update-how-to.-update-drupal-core-only/>SA-CORE-2018-002</a></li><li><a href=/docs/development/openy-upgrade-for-developers.-upgrade-to-old-openy-1.x-version/>Upgrade from 8.0.x to 8.1.x</a></li><li><a href=/docs/development/upgrade-openy-8.1.3-to-8.2.2.1/>Upgrade-OpenY-8.1.3-to-8.2.2.1</a></li><li><a href=/docs/development/upgrade-use-case-from-8.2.2.3-to-8.2.7.3/>Upgrade-use-case-from-8.2.2.3-to-8.2.7.3</a></li><li><a href=/docs/development/upgrade_use_case_drupal_9_drupal_10_1/>openy-9.x-2.11.5 to 10.3 latest distribution</a></li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8c95d8532edc4e6a021339f13237038a>1 - Onboarding</h1><div class=lead>Welcome to YMCA Website Services</div><h2 id=list-of-migrated-repositoriesprojects>List of migrated repositories/projects<a class=td-heading-self-link href=#list-of-migrated-repositoriesprojects aria-label="Heading self-link"></a></h2><p>In 2022, maintenance of the distribution moved from Open Y LLC to Y-USA. With this, repository locations have changed:</p><ul><li>YMCA Website Services (formerly Open Y):
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a></li><li>YMCA Virtual Experience (formerly Virtual Y):
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content target=_blank>YCloudYUSA/yusaopeny_gated_content</a></li><li>Activity Finder:
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>YCloudYUSA/yusaopeny_activity_finder</a></li><li>Membership Framework:
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank>YCloudYUSA/yusaopeny_memberships</a></li><li>YMCA Digital Services Docs:
<a href=https://github.com/YCloudYUSA/yusaopeny_docs target=_blank>YCloudYUSA/yusaopeny_docs</a></li><li>YMCA Website Services distribution (formerly Open Y project)
<a href=https://github.com/YCloudYUSA/yusaopeny-project target=_blank>YCloudYUSA/yusaopeny-project</a></li></ul><h2 id=how-to-start-developing-open-y>How to start developing Open Y<a class=td-heading-self-link href=#how-to-start-developing-open-y aria-label="Heading self-link"></a></h2><p>In order to get a copy of the latest development version of the distribution, please follow steps from
<a href=https://github.com/YCloudYUSA/yusaopeny#latest-development-version-drupal-9-2x target=_blank>YUSA OpenY README</a>.</p><p>Pay attention Open Y has a modular structure, so if you plan changes to specific component - create Pull Request/Merge Request in respective project or repository, based on component&rsquo;s composer.json data.</p><p>In order to test specific component, create a PR to
<a href=https://github.com/YCloudYUSA/yusaopeny/pulls target=_blank>yusaopeny</a> and add a reference in composer.json of Open Y in order for the build system to start using updated component.</p><h3 id=qa-sandboxes-for-open-y>QA sandboxes for Open Y<a class=td-heading-self-link href=#qa-sandboxes-for-open-y aria-label="Heading self-link"></a></h3><p>The YMCA Website Services core team manages
<a href=../../wiki/sandboxes>sandboxes</a> for various configurations of the distribution to facilitate evaluation, to help with QA, and enable investigation of issues.</p><h2 id=how-to-start-developing-virtual-y>How to start developing Virtual Y<a class=td-heading-self-link href=#how-to-start-developing-virtual-y aria-label="Heading self-link"></a></h2><p><a href=https://github.com/YCloudYUSA/yusaopeny_gated_content#development target=_blank>Get started with the README</a></p><p><a href=../../wiki/sandboxes/#virtual-y-sandboxes>QA sandboxes for Virtual Y</a></p><h2 id=how-to-start-developing-membership-framework>How to start developing Membership Framework<a class=td-heading-self-link href=#how-to-start-developing-membership-framework aria-label="Heading self-link"></a></h2><p><a href=https://github.com/YCloudYUSA/yusaopeny_memberships#installation target=_blank>Get started with the README</a></p><p><a href=../../wiki/sandboxes/#membership-framework-sandboxes>QA sandboxes for Membership Framework</a></p><h2 id=how-to-start-developing-activity-finder>How to start developing Activity Finder<a class=td-heading-self-link href=#how-to-start-developing-activity-finder aria-label="Heading self-link"></a></h2><p>Activity Finder is installed with the distribution by default.</p><p><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder#open-y-activity-finder target=_blank>Get started with the README</a></p><p><a href=../../wiki/sandboxes/#activity-finder-sandboxes>QA Sandboxes for Activity Finder</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-0eec02d1f012c235d94eea040b06de14>2 - 3rd-party dependencies</h1><p>YMCA Website Services&rsquo;s system requirements generally track
<a href=https://www.drupal.org/docs/system-requirements target=_blank>those of Drupal</a> with some occasional more opinionated recommendations.</p><h2 id=general-requirements>General Requirements<a class=td-heading-self-link href=#general-requirements aria-label="Heading self-link"></a></h2><p>Supported versions may differ based on your Drupal version.</p><ul><li>A
<a href=https://www.drupal.org/docs/system-requirements/web-server-requirements target=_blank>supported web server</a> like Apache or Nginx</li><li>A
<a href=https://www.drupal.org/docs/system-requirements/database-server-requirements target=_blank>supported database server</a> like MySQL or MariaDB</li><li>A
<a href=https://www.drupal.org/docs/system-requirements/php-requirements target=_blank>supported version of PHP</a></li><li>A Linux-based operating system<ul><li><a href=https://ubuntu.com/ target=_blank>Ubuntu</a> 16, 18, and 20 are supported.</li><li>CentOS or similar may work as well.</li></ul></li></ul><p>Recommended for advanced functionality, but not required:</p><ul><li><a href=https://lucene.apache.org/solr/ target=_blank>Apache SOLR</a> search server<ul><li>Version 4.9.1 and version 8 have been tested for Activity Finder. Other versions are works in progress.</li></ul></li></ul><h3 id=for-high-loadperformance-sites>For high load/performance sites<a class=td-heading-self-link href=#for-high-loadperformance-sites aria-label="Heading self-link"></a></h3><ul><li>A memory-based key-value store<ul><li><a href=http://memcached.org/ target=_blank>Memcache</a></li><li><a href=https://redis.io target=_blank>Redis</a></li></ul></li><li>A reverse proxy/HTTP cache<ul><li><a href=https://varnish-cache.org/ target=_blank>Varnish</a></li><li><a href=https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/ target=_blank>Nginx reverse proxy</a></li></ul></li></ul><p>See also Drupal&rsquo;s recommendations for
<a href=https://www.drupal.org/docs/managing-site-performance-and-scalability target=_blank>managing site performance and scalability</a>.</p><h3 id=for-development>For development<a class=td-heading-self-link href=#for-development aria-label="Heading self-link"></a></h3><ul><li><a href=https://www.virtualbox.org/ target=_blank>Oracle VM Virtualbox</a></li><li><a href=https://www.vagrantup.com/ target=_blank>Vagrant configuration manager</a></li><li><a href=https://www.ansible.com/ target=_blank>Ansible configuration manager and automation</a></li><li><a href=https://getcomposer.org/ target=_blank>Composer package manager</a></li><li><a href=https://www.docker.com/ target=_blank>Docker virtual environments</a></li></ul><p>See our
<a href=https://github.com/YCloudYUSA/yusaopeny-project#installation target=_blank>installation instructions</a> for a full walkthrough of these tools.</p><h2 id=software-libraries-and-frameworks>Software libraries and frameworks<a class=td-heading-self-link href=#software-libraries-and-frameworks aria-label="Heading self-link"></a></h2><p>YMCA Website Services leverages many other open source frameworks including, but not limited to:</p><ul><li><a href=https://drupal.org/project/drupal target=_blank>Drupal</a></li><li><a href=https://symfony.com/ target=_blank>Symfony</a></li><li><a href=https://reactjs.org/ target=_blank>ReactJS</a></li><li><a href=https://vuejs.org/ target=_blank>Vue.js</a></li><li><a href=https://www.google.com/recaptcha/intro/v3.html target=_blank>Google reCAPTCHA</a></li><li><a href=https://nodejs.org/en/ target=_blank>NodeJS</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-66142b350bf5e809654b6436938cc4b0>3 - Acceptance Testing</h1><p>YMCA Website Services is a big distribution with a large amount of modules, components, subsystems, and business
processes, therefore we have to take appropriate steps to ensure the stability of major functionality during development.</p><p>For the automated tests we have created
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/.github/PULL_REQUEST_TEMPLATE.md target=_blank>General Checks template</a>
on GitHub every developer should follow to get review approval from YMCA Website Services core team.
However, General Checks are for testing functionality for the current proposed change only, not for Regression Testing.</p><p>For regression testing,
<a href=/docs/development/tests/#behat>Behat tests</a> in this flow are provided automatically on each build by YMCA Website Services community.</p><p>Every pull request should include a testing plan prior to release into YMCA Website Services. This plan should cover the testing of all workflows and functionality to ensure that they continue to work with any new code or change implemented. This is because it is possible for conflicts to occur between elements of YMCA Website Services, Drupal Modules, and Drupal Core. These pull request testing plans will increase productivity and decrease effort for manual Acceptance Testing of upcoming Releases. This testing plan should cover specific features and functionality that is likely to cause regression issues post-release or post-upgrade to the latest version of YMCA Website Services once this new code is implemented.</p><p>Example of testing plan: If the Drupal core is updated it is important to gather all Drupal core Release Notes since last release
core upgrade for YMCA Website Services and analyze important issues fixed.
Example - in case if you are doing upgrade from latest 8.4.0 to 8.4.4:</p><ul><li><a href=https://www.drupal.org/project/drupal/releases/8.4.4 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.4</a> (translations)</li><li><a href=https://www.drupal.org/project/drupal/releases/8.4.3 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.3</a> (postgreSQL and migration)</li><li><a href=https://www.drupal.org/project/drupal/releases/8.4.2 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.2</a> (migrations, taxonomy, ckeditor)</li><li><a href=https://www.drupal.org/project/drupal/releases/8.4.1 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.1</a> (composer)</li></ul><p>This means the list of systems should be tested are</p><ul><li>multilingual</li><li>postgreSQL support</li><li>migration</li><li>taxonomy</li><li>ckeditor</li><li>composer</li></ul><p>This list could be extended by analyzing some highly important parts of YMCA Website Services distributions that depends from the above
subsystems. It is not required to spend time on every module that has a dependency taxonomy, but it is important to test at least one impacted module to ensure it is still working post-implementation. In case if there is a Behat test already created for the subsystem in a list then a manual test could be skipped as long as the build is not failing due to the module or element covered in the associated Behat test.</p><p>How to choose which modules to test: These can be a random selection from the list of systems impacted, or one of the oldest modules in a system impacted. This is because there is a higher chance that a minor change could cause a regression issue for the modules that have not received recent or regular updates.</p><p>The oldest modules(contrib modules) that have dependencies from the above list should also be updated, but
to improve productivity, these updates should only be initiated if there is a security issue or a module stopped working because of
the subsystems getting updated within an upcoming release. In case if a respective module update creates more issues
that the older version of said module - then it is better to keep the old module and fix an associated regression bug.
Tip: usually a new version of the module already contains a bug fix, so adding a patch from the drupal.org to composer.json of the YMCA Website Services distribution is preferred to get distribution
released. Keep in mind, you will need to create a follow-up task for the module to be updated after release.</p><p>After creating list of modules that could introduce regression issues it is highly recommended to follow
Quick-start section of the module&rsquo;s readme files, that usually is shipped with modules.
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-1.x/modules/custom/location_finder/README.md#quickstart target=_blank>Example for the location_finder</a>.
In case if a module has no Quick-start or Acceptance testing section in readme - it is important to test at least one place
where functionality of the module should be working. It is highly recommended to add this manual test steps as
a follow-up task,
<a href=https://github.com/YCloudYUSA/yusaopeny/issues/new target=_blank>new issue</a> or even better - create Pull Request
with changes to readme into YMCA Website Services repository. For the sake of performance, adding step by step how-to to the respective
module&rsquo;s README.md file is highly recommended. It takes only a few minutes to write a couple of lines of documentation which will greatly help others with future contributions and changes.</p><p>Optional, but greatly appreciated: Add a Drupal tour for the how-to, created in README will benefit future YMCA Website Services users and developers.
Having a tour for the business functionality is highly recommended to ship with the component - it creates an in-site visual guided documentation and helps to decrease time for the Acceptance testing.</p><p>And last, but not the lease - adding Behat tests to the system will ensure functionality is tested on every pull
request, on every CI build in the future.</p><h3 id=rule>Rule<a class=td-heading-self-link href=#rule aria-label="Heading self-link"></a></h3><p>Every release of YMCA Website Services since 8.1.9 should include list of subsystems, changed in release for the community to be aware of the possible regressions on their end.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-003c35fb6d8352141e0a16ef5597a8c4>4 - anti spam protection</h1><p>In order to protect YMCA Website Services customers, we have added anti-spam protection based on CAPTCHA and Google reCAPTCHA out of the box in YMCA Website Services core</p><p>You can check
<a href="https://www.youtube.com/watch?v=sx36hoDj4Wc" target=_blank>the tutorial for how to install and configure reCaptcha on your site</a>.</p><p>In the majority of cases having the above configuration in place will protect you from 99% of spam, unless there is human-entered spam that has no protection. To overcome some human-based spam you should use blacklist logic for blocking email domains, used in spam messages.</p><p>For that, you can use
<a href=https://www.drupal.org/project/protected_submissions target=_blank>the Protected Submissions module</a> module, which allows you to harden all submissions on a site with a list of stop words as well as per-language settings.</p><h2 id=virtual-y-use-case>Virtual Y use case<a class=td-heading-self-link href=#virtual-y-use-case aria-label="Heading self-link"></a></h2><p>In order to overcome caching issues, Virtual Y uses the
<a href=https://www.drupal.org/project/simple_recaptcha target=_blank>simple_recaptcha</a> module which could be used in similar cases.</p><p>The CAPTCHA + reCAPTCHA module solution has presented some reliability issues. The most recent
<a href=https://www.drupal.org/project/captcha/issues/3089263 target=_blank>discussion and fix from drupal.org</a> has also not reliably resolved issues for some clients.</p><p>At some point, the “Simple reCaptcha” module was used on a project and had no issues, so we’ve started to replace the “CAPTCHA” + “reCAPTCHA” modules with “Simple reCAPTCHA”.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-266b7a98bf0aedb541c3d57319c11a3a>5 - Code of Conduct and Best Practices</h1><p>The YMCA Website Services community aims to build from the methods and best practices of other open-source projects, such as the
<a href=https://drupal.org target=_blank>Drupal community</a> and the
<a href=http://drupal.ua target=_blank>Drupal Ukrainian community</a>.</p><h1 id=bylaws>Bylaws<a class=td-heading-self-link href=#bylaws aria-label="Heading self-link"></a></h1><p>For the OpenY distribution we have
<a href=/docs/development/ws-terms-of-use/>Terms of Use</a> and
<a href=/docs/development/ws-participant-agreement/>Participant Agreement</a>.</p><h1 id=development>Development<a class=td-heading-self-link href=#development aria-label="Heading self-link"></a></h1><p>To understand how we use and develop technologies, refer to the documents below:</p><ul><li><a href=https://www.drupal.org/dcoc target=_blank>Drupal Code of Conduct</a></li><li><a href=https://www.conventionalcommits.org/en/v1.0.0/ target=_blank>Conventional commits policy</a></li><li><a href=https://www.drupal.org/docs/develop/standards target=_blank>Drupal Coding Standards</a></li><li><a href=/docs/development/development-faq/>YMCA Website Services Development FAQ</a></li><li><a href=/docs/development/code-review-quality-best-practices/>YMCA Website Services Development Best Practices</a></li></ul><p>JavaScript Code Standards</p><ul><li><a href=https://github.com/airbnb/javascript/tree/master/react target=_blank>Airbnb React/JSX Style Guide</a> (for reviewing JavaScript ES5/ES6)</li><li><a href=https://vuejs.org/v2/style-guide/ target=_blank>Vue.js code style guide</a> (for Vue.js components)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-69c079fb4921132db608af61d6beff86>6 - Code Review Quality Best Practices</h1><p>This document serves as an addition to our
<a href=/docs/development/open-y-code-of-conduct-and-best-practices/>Code of Conduct and Best Practices</a>. It is more technical and in-depth for specific cases that were discussed during code quality review processes the YMCA Website Services team has in place. During this process, all code should be reviewed by 1-2 developers before being merged into the YMCA Website Services codebase.</p><h1 id=general-rules>General Rules<a class=td-heading-self-link href=#general-rules aria-label="Heading self-link"></a></h1><p>Components in YMCA Website Services (whether modules, themes, or other code structures) should be, as much as possible, reusable and atomic. All features, content types, settings, styles, etc. should be bundled together to create a cohesive component.</p><ol><li>General naming conventions<ol><li>Features module naming<ol><li><strong>openy_${entity_type|abbr}_${entity_bundle|abbr}_${feature|optional}</strong><ol><li>Example: <strong>openy_node_blog_feature</strong></li><li><strong>openy_prgf_sc_feature</strong> -> OpenY Paragraph Simple Content (name within yml)</li></ol></li></ol></li><li>Fields naming (&lt;=20 chars)<ol><li><strong>field_${entity_type|abbr}_${entity_bundle|abbr}_{name|abbr}</strong><ol><li>Example: <strong>field_prgf_sc_body</strong></li></ol></li></ol></li><li><strong>All descriptions are mandatory!</strong></li></ol></li><li>Module naming conventions - Depending on the context we should choose the name from this list:<ol><li><strong>${project_name|abbr}_${business_name|abbr</strong>} - when the code looks like legacy and has specifics that are not ready to be open-sourced</li><li><strong>openy_${business_name|abbr}</strong> - when the code is ready to be ejected to OpenY package</li><li><strong>${business_name}</strong> - when the code is so abstract that it has no connection to OpenY and is ready to be hosted on Drupal.org as an independent project.</li></ol></li></ol><h2 id=code-sharing>Code Sharing<a class=td-heading-self-link href=#code-sharing aria-label="Heading self-link"></a></h2><p>To support reuse by the community, the MODULE-NAME should relate to the business logic of the module. It is not good to create modules by abstracting them out of the business. All modules that have been shared to drupal.org from past projects were possible to share only because they represent some feature, tied to a business need. For example:</p><ul><li>personify - module for SOAP related methods for working with Personify API</li><li>acrypt - Asymmetric crypt algorithm</li></ul><p>and so on.</p><h1 id=php>PHP<a class=td-heading-self-link href=#php aria-label="Heading self-link"></a></h1><h2 id=return-early-pattern>Return early pattern<a class=td-heading-self-link href=#return-early-pattern aria-label="Heading self-link"></a></h2><p>To keep readability in functions and methods, it is wise to return early if simple conditions apply that can be checked at the beginning of a method:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>foo</span><span class=p>(</span><span class=nv>$bar</span><span class=p>,</span> <span class=nv>$baz</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$foo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// logic goes here
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nv>$calculated_value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>It&rsquo;s better to return early, keeping indentation and brainpower needed to follow the code low.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>foo</span><span class=p>(</span><span class=nv>$bar</span><span class=p>,</span> <span class=nv>$baz</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$foo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// logic goes here
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nv>$calculated_value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><h2 id=define-early-pattern>Define early pattern<a class=td-heading-self-link href=#define-early-pattern aria-label="Heading self-link"></a></h2><p>When you have a condition that aims to change the value of a variable without additional logic, get rid of <code>if else elseif</code> code and instead define your variable early and change it via conditions.</p><p>Before:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$a</span> <span class=o>=</span> <span class=s1>&#39;hello&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nv>$text</span> <span class=o>=</span> <span class=s1>&#39;Welcome to site&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nv>$text</span> <span class=o>=</span> <span class=s1>&#39;Register please&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$text</span> <span class=o>=</span> <span class=s1>&#39;Register please&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$a</span> <span class=o>=</span> <span class=s1>&#39;hello&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nv>$text</span> <span class=o>=</span> <span class=s1>&#39;Welcome to site&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=null-checks-with-isset>Null Checks with <code>isset</code><a class=td-heading-self-link href=#null-checks-with-isset aria-label="Heading self-link"></a></h2><p><a href=https://www.php.net/manual/en/function.isset.php target=_blank><code>isset()</code></a> verifies if set and not null. There is no need to do additional verification against NULL.</p><p>Before:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;video&#39;</span> <span class=o>=&gt;</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>])</span> <span class=o>||</span> <span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=k>NULL</span><span class=p>)</span> <span class=o>?</span> <span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;video&#39;</span> <span class=o>=&gt;</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]))</span> <span class=o>?</span> <span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><h2 id=dependency-injection>Dependency Injection<a class=td-heading-self-link href=#dependency-injection aria-label="Heading self-link"></a></h2><p>For the decoupled and easier to upgrade code in Drupal 8+ Dependency injection should be used instead of calling methods from services statically.</p><p>See the Drupal API
<a href=https://api.drupal.org/api/drupal/core%21core.api.php/group/container/9.3.x target=_blank>Overview of the Dependency Injection Container and Services</a>.</p><p>Before:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nv>$node</span> <span class=o>=</span> <span class=nx>Drupal</span><span class=o>::</span><span class=na>entityTypeManager</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>getStorage</span><span class=p>(</span><span class=s1>&#39;node&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>load</span><span class=p>(</span><span class=nv>$result</span><span class=o>-&gt;</span><span class=na>getField</span><span class=p>(</span><span class=s1>&#39;nid&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>getValues</span><span class=p>()[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$node</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>entityTypeManager</span><span class=o>-&gt;</span><span class=na>getStorage</span><span class=p>(</span><span class=s1>&#39;node&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>load</span><span class=p>(</span><span class=nv>$result</span><span class=o>-&gt;</span><span class=na>getField</span><span class=p>(</span><span class=s1>&#39;nid&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>getValues</span><span class=p>()[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><h2 id=creating-meaningful-log-messages>Creating meaningful log messages<a class=td-heading-self-link href=#creating-meaningful-log-messages aria-label="Heading self-link"></a></h2><p>To provide useful logging for site managers, we need to write meaningful log messages with a proper context.</p><p>Before:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$type</span> <span class=o>==</span> <span class=s1>&#39;program&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=k>NULL</span> <span class=o>||</span> <span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_images&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=k>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>\Drupal</span><span class=o>::</span><span class=na>logger</span><span class=p>(</span><span class=s1>&#39;272&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>notice</span><span class=p>(</span><span class=nv>$type</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>After:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$type</span> <span class=o>==</span> <span class=s1>&#39;program&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_videos&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=k>NULL</span> <span class=o>||</span> <span class=nv>$feed</span><span class=p>[</span><span class=s1>&#39;profile_media_images&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=k>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>\Drupal</span><span class=o>::</span><span class=na>logger</span><span class=p>(</span><span class=s1>&#39;form_import&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>notice</span><span class=p>(</span><span class=s2>&#34;FORM IMPORT: type is </span><span class=si>$type</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><h1 id=maintaining-an-upgrade-path>Maintaining an Upgrade Path<a class=td-heading-self-link href=#maintaining-an-upgrade-path aria-label="Heading self-link"></a></h1><p>All changes in configurations should be added to appropriate hook_update_N to update already existing environments. We suggest using the
<a href=https://www.drupal.org/project/confi target=_blank>Config Importer and Tools
</a>package for working with hook_update_N.</p><h2 id=install-files>Install files<a class=td-heading-self-link href=#install-files aria-label="Heading self-link"></a></h2><h3 id=openyinstall-in-profile><code>openy.install</code> in profile<a class=td-heading-self-link href=#openyinstall-in-profile aria-label="Heading self-link"></a></h3><p>In this file, we should put updates that are related to the distribution in general and don&rsquo;t fit into any feature.</p><ul><li>Enable/Disable module</li><li>General configs</li></ul><h3 id=openy_install-in-modules><code>openy_*.install</code> in modules<a class=td-heading-self-link href=#openy_install-in-modules aria-label="Heading self-link"></a></h3><p>If you update some configuration for a specific feature, make sure that you put updates into this file in the appropriate module.</p><h2 id=config-management>Config Management<a class=td-heading-self-link href=#config-management aria-label="Heading self-link"></a></h2><h3 id=revert-only-specific-property-from-config>Revert only specific property from config<a class=td-heading-self-link href=#revert-only-specific-property-from-config aria-label="Heading self-link"></a></h3><p>This is the preferred method of updating configs as it will result in fewer conflicts for upgrading customized YMCA Website Services instances.</p><p>With
<a href=https://www.drupal.org/project/confi target=_blank>config_import module</a> we can update only part of the full config.</p><p>For updating specific property in config use the <code>openy_upgrade_tool.param_updater</code> service:</p><ol><li>Find the module where your config lives.</li><li>Create a new <code>hook_update_N</code> in the <code>openy_*.install</code> file.</li><li>In that hook add the update code (for example):</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$config</span> <span class=o>=</span> <span class=nx>drupal_get_path</span><span class=p>(</span><span class=s1>&#39;module&#39;</span><span class=p>,</span> <span class=s1>&#39;openy_media_image&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/install/views.view.images_library.yml&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$config_importer</span> <span class=o>=</span> <span class=nx>\Drupal</span><span class=o>::</span><span class=na>service</span><span class=p>(</span><span class=s1>&#39;openy_upgrade_tool.param_updater&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>(</span><span class=nv>$config</span><span class=p>,</span> <span class=s1>&#39;views.view.images_library&#39;</span><span class=p>,</span> <span class=s1>&#39;display.default.display_options.pager&#39;</span><span class=p>);</span>
</span></span></code></pre></div><p>Where:</p><ul><li><code>$config</code> variable contains path to config with config name, like:</li><li><code>views.view.images_library</code> - config name</li><li><code>display.default.display_options.pager</code> - config specific property (you can set value from a nested array with variable depth)</li></ul><h3 id=revert-full-configs>Revert full configs<a class=td-heading-self-link href=#revert-full-configs aria-label="Heading self-link"></a></h3><p>This variant uses extensive config file manipulation and increases the time for an upgrade.</p><p>For updating full config or several configs from directory use the <code>openy_upgrade_tool.importer</code> service:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$config_dir</span> <span class=o>=</span> <span class=nx>drupal_get_path</span><span class=p>(</span><span class=s1>&#39;module&#39;</span><span class=p>,</span> <span class=s1>&#39;openy_media_image&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/install&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$config_importer</span> <span class=o>=</span> <span class=nx>\Drupal</span><span class=o>::</span><span class=na>service</span><span class=p>(</span><span class=s1>&#39;openy_upgrade_tool.importer&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>setDirectory</span><span class=p>(</span><span class=nv>$config_dir</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>importConfigs</span><span class=p>([</span><span class=s1>&#39;views.view.images_library&#39;</span><span class=p>]);</span>
</span></span></code></pre></div><p>Where:</p><ul><li><code>$config_dir</code> - path to directory with config</li><li><code>views.view.images_library</code> - config name</li></ul><p>Also you can update several configs from a directory:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>importConfigs</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;views.view.images_library&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;views.view.example_view&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></div><h1 id=javascript-includes>JavaScript includes<a class=td-heading-self-link href=#javascript-includes aria-label="Heading self-link"></a></h1><p><img src=https://user-images.githubusercontent.com/563412/122801945-6f28b700-d2cd-11eb-8d0c-694432e8cbf0.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-8458fa891c891e6ac5d1a8398940de90>7 - Colorways</h1><div class=lead>What goes into making the selectable colorways in Layout Builder.</div><h2 id=css-variables>CSS Variables<a class=td-heading-self-link href=#css-variables aria-label="Heading self-link"></a></h2><h3 id=base-variables>Base variables<a class=td-heading-self-link href=#base-variables aria-label="Heading self-link"></a></h3><p>We start by defining a base set of colors based on the &ldquo;Y Color Wheel and Neighbored Color Zones&rdquo; from the &ldquo;Websites & Platforms Style Guide&rdquo;, available in the
<a href=https://theybrand.org/ target=_blank>YMCA Brand Resource Center</a>.</p><p><figure class=image-caption><a href=/docs/development/colorways/colorways--colorwheel.png title="View original image"><img alt="A color wheel with labels corresponding to the official YMCA colors." srcset="/docs/development/colorways/colorways--colorwheel_hu5876717367352641258.png 458w,
/docs/development/colorways/colorways--colorwheel_hu851995010912045821.png 726w,
/docs/development/colorways/colorways--colorwheel_hu6890167765815645167.png 1200w" sizes=50vw src=/docs/development/colorways/colorways--colorwheel_hu5876717367352641258.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></p><blockquote><p><strong>Note:</strong> RGB variable values are not complete color definitions and must be wrapped in <code>rgb{a}()</code>, like <code>background-color: rgb(var(--ylb-color-rgb-red-dark), 0.5);</code>.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=nd>:root</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-red-dark</span><span class=o>:</span> <span class=n>#a92b31<span class="px-2 ms-1" style=background-color:#a92b31></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-red-dark</span><span class=o>:</span> <span class=n>169, 43, 49<span class="px-2 ms-1" style=background-color:#a92b31></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-red</span><span class=o>:</span> <span class=n>#ed1c24<span class="px-2 ms-1" style=background-color:#ed1c24></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-red</span><span class=o>:</span> <span class=n>237, 28, 36<span class="px-2 ms-1" style=background-color:#ed1c24></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-red-light</span><span class=o>:</span> <span class=n>#f15922<span class="px-2 ms-1" style=background-color:#f15922></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-red-light</span><span class=o>:</span> <span class=n>241, 89, 34<span class="px-2 ms-1" style=background-color:#f15922></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-orange-dark</span><span class=o>:</span> <span class=n>#dd5828<span class="px-2 ms-1" style=background-color:#dd5828></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-orange-dark</span><span class=o>:</span> <span class=n>221, 88, 40<span class="px-2 ms-1" style=background-color:#dd5828></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-orange</span><span class=o>:</span> <span class=n>#f47920<span class="px-2 ms-1" style=background-color:#f47920></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-orange</span><span class=o>:</span> <span class=n>244, 121, 32<span class="px-2 ms-1" style=background-color:#f47920></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-orange-light</span><span class=o>:</span> <span class=n>#fcaf17<span class="px-2 ms-1" style=background-color:#fcaf17></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-orange-light</span><span class=o>:</span> <span class=n>252, 175, 23<span class="px-2 ms-1" style=background-color:#fcaf17></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-green-dark</span><span class=o>:</span> <span class=n>#006b6b<span class="px-2 ms-1" style=background-color:#006b6b></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-green-dark</span><span class=o>:</span> <span class=n>0, 107, 107<span class="px-2 ms-1" style=background-color:#006b6b></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-green</span><span class=o>:</span> <span class=n>#01a490<span class="px-2 ms-1" style=background-color:#01a490></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-green</span><span class=o>:</span> <span class=n>1, 164, 144<span class="px-2 ms-1" style=background-color:#01a490></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-green-light</span><span class=o>:</span> <span class=n>#20bdbe<span class="px-2 ms-1" style=background-color:#20bdbe></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-green-light</span><span class=o>:</span> <span class=n>32, 189, 190<span class="px-2 ms-1" style=background-color:#20bdbe></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-blue-dark</span><span class=o>:</span> <span class=n>#0060af<span class="px-2 ms-1" style=background-color:#0060af></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-blue-dark</span><span class=o>:</span> <span class=n>0, 96, 175<span class="px-2 ms-1" style=background-color:#0060af></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-blue</span><span class=o>:</span> <span class=n>#0089d0<span class="px-2 ms-1" style=background-color:#0089d0></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-blue</span><span class=o>:</span> <span class=n>0, 137, 208<span class="px-2 ms-1" style=background-color:#0089d0></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-blue-light</span><span class=o>:</span> <span class=n>#00aeef<span class="px-2 ms-1" style=background-color:#00aeef></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-blue-light</span><span class=o>:</span> <span class=n>0, 174, 239<span class="px-2 ms-1" style=background-color:#00aeef></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-purple-dark</span><span class=o>:</span> <span class=n>#5c2e91<span class="px-2 ms-1" style=background-color:#5c2e91></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-purple-dark</span><span class=o>:</span> <span class=n>92, 46, 145<span class="px-2 ms-1" style=background-color:#5c2e91></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-purple</span><span class=o>:</span> <span class=n>#92278f<span class="px-2 ms-1" style=background-color:#92278f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-purple</span><span class=o>:</span> <span class=n>146, 39, 143<span class="px-2 ms-1" style=background-color:#92278f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-purple-light</span><span class=o>:</span> <span class=n>#c6168d<span class="px-2 ms-1" style=background-color:#c6168d></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-purple-light</span><span class=o>:</span> <span class=n>198, 22, 141<span class="px-2 ms-1" style=background-color:#c6168d></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-white</span><span class=o>:</span> <span class=n>#FFFFFF<span class="px-2 ms-1" style=background-color:#fff></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-white</span><span class=o>:</span> <span class=n>255, 255, 255<span class="px-2 ms-1" style=background-color:#fff></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-light-grey-1</span><span class=o>:</span> <span class=n>#f2f2f2<span class="px-2 ms-1" style=background-color:#f2f2f2></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-light-grey-1</span><span class=o>:</span> <span class=n>242, 242, 242<span class="px-2 ms-1" style=background-color:#f2f2f2></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-light-grey-2</span><span class=o>:</span> <span class=n>#e7e7e7<span class="px-2 ms-1" style=background-color:#e7e7e7></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-light-grey-2</span><span class=o>:</span> <span class=n>231, 231, 231<span class="px-2 ms-1" style=background-color:#e7e7e7></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-light-grey-3</span><span class=o>:</span> <span class=n>#cccccc<span class="px-2 ms-1" style=background-color:#ccc></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-light-grey-3</span><span class=o>:</span> <span class=n>204, 204, 204<span class="px-2 ms-1" style=background-color:#ccc></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-grey-1</span><span class=o>:</span> <span class=n>#636466<span class="px-2 ms-1" style=background-color:#636466></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-grey-1</span><span class=o>:</span> <span class=n>99, 100, 102<span class="px-2 ms-1" style=background-color:#636466></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-grey-2</span><span class=o>:</span> <span class=n>#4F4F4F<span class="px-2 ms-1" style=background-color:#4f4f4f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-grey-2</span><span class=o>:</span> <span class=n>79, 79, 79<span class="px-2 ms-1" style=background-color:#4f4f4f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-grey-3</span><span class=o>:</span> <span class=n>#3F4042<span class="px-2 ms-1" style=background-color:#3f4042></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-grey-3</span><span class=o>:</span> <span class=n>63, 64, 66<span class="px-2 ms-1" style=background-color:#3f4042></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-dark-grey-1</span><span class=o>:</span> <span class=n>#2F2F2F<span class="px-2 ms-1" style=background-color:#2f2f2f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-dark-grey-1</span><span class=o>:</span> <span class=n>47, 47, 47<span class="px-2 ms-1" style=background-color:#2f2f2f></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-dark-grey-2</span><span class=o>:</span> <span class=n>#231F20<span class="px-2 ms-1" style=background-color:#231f20></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-dark-grey-2</span><span class=o>:</span> <span class=n>35, 31, 32<span class="px-2 ms-1" style=background-color:#231f20></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-black</span><span class=o>:</span> <span class=n>#000000<span class="px-2 ms-1" style=background-color:#000></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=na>--ylb-color-rgb-black</span><span class=o>:</span> <span class=n>0, 0, 0<span class="px-2 ms-1" style=background-color:#000></span></span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=colorway-variables>Colorway variables<a class=td-heading-self-link href=#colorway-variables aria-label="Heading self-link"></a></h3><p>Each colorway begins with four initial colors, derived from the above color wheel:</p><ul><li>PrimaryColor</li><li>SecondaryColor</li><li>TertiaryColor</li><li>PartnerColor</li></ul><p>All page elements should be composed of these four variables, with &ldquo;primary/secondary/tertiary&rdquo; providing complimentary colors and &ldquo;partner&rdquo; providing a complimentary option for buttons or other calls to action.</p><p>Each variable is prefixed with <code>ws</code>. RGB versions of these four options are provided for use with <code>rgba()</code> styles.</p><p>Additionally, 5 variables are used to more specifically define the gradients in the Y logo:</p><ul><li>LogoChevronDark</li><li>LogoChevronMid</li><li>LogoChevronLight</li><li>LogoTriangleDark</li><li>LogoTriangleLight</li></ul><p>These variables should not be used in page components outside the logo. The Canadian Y logo does not change colors, and therefore these extra colors are not needed for Canadian colorways.</p><p>All together, these variables make up a colorway:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=nt>--wsPrimaryColor</span>
</span></span><span class=line><span class=cl><span class=nt>--wsPrimaryColorRGB</span>
</span></span><span class=line><span class=cl><span class=nt>--wsSecondaryColor</span>
</span></span><span class=line><span class=cl><span class=nt>--wsSecondaryColorRGB</span>
</span></span><span class=line><span class=cl><span class=nt>--wsTertiaryColor</span>
</span></span><span class=line><span class=cl><span class=nt>--wsTertiaryColorRGB</span>
</span></span><span class=line><span class=cl><span class=nt>--wsPartnerColor</span>
</span></span><span class=line><span class=cl><span class=nt>--wsPartnerColorRGB</span>
</span></span><span class=line><span class=cl><span class=nt>--wsLogoChevronDark</span>
</span></span><span class=line><span class=cl><span class=nt>--wsLogoChevronMid</span>
</span></span><span class=line><span class=cl><span class=nt>--wsLogoChevronLight</span>
</span></span><span class=line><span class=cl><span class=nt>--wsLogoTriangleDark</span>
</span></span><span class=line><span class=cl><span class=nt>--wsLogoTriangleLight</span>
</span></span></code></pre></div><p>These variables should reference base variables, or other colors provided. Once combined, the full colorway definition should look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=nd>:root</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsPrimaryColor</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsPrimaryColorRGB</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-rgb-blue-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsSecondaryColor</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsSecondaryColorRGB</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-rgb-blue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsTertiaryColor</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue-light</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsTertiaryColorRGB</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-rgb-blue-light</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsPartnerColor</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-purple-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsPartnerColorRGB</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-rgb-purple-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsLogoChevronDark</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsLogoChevronMid</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsLogoChevronLight</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-blue-light</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsLogoTriangleDark</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-purple-dark</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=na>--wsLogoTriangleLight</span><span class=o>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>ylb-color-purple-light</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=logo-colors>Logo Colors<a class=td-heading-self-link href=#logo-colors aria-label="Heading self-link"></a></h2><p>In order to provide consistency across colorways and reduce code duplication, the logo has been decomposed into 6 sections:</p><ul><li>&ldquo;the&rdquo;</li><li>&ldquo;chevron&rdquo;</li><li>&ldquo;ymca&rdquo;</li><li>&ldquo;triangle&rdquo;</li><li>&ldquo;registeredtm&rdquo;</li><li>&ldquo;areas-of-impact&rdquo;</li></ul><p>The &ldquo;chevron&rdquo; and &ldquo;triangle&rdquo; components are composed of <code>radialGradient</code> elements which leverage the additional <code>wsLogo</code> variables defined above. The other components use the existing colorway variables. Each component is a <code>path</code> with an <code>id</code> and the color defined in a <code>fill</code>.</p><p><figure class=image-caption><a href=/docs/development/colorways/colorways--logo-breakdown.png title="View original image"><img alt="The YMCA logo with labels corresponding to the colors used in each component as described in text below." srcset="/docs/development/colorways/colorways--logo-breakdown_hu5633449770954091984.png 458w,
/docs/development/colorways/colorways--logo-breakdown_hu11009190345225008587.png 726w,
/docs/development/colorways/colorways--logo-breakdown_hu15067592640032781761.png 1200w" sizes=50vw src=/docs/development/colorways/colorways--logo-breakdown_hu5633449770954091984.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></p><ul><li><code>#logo-the</code> uses <code>--wsSecondaryColor</code></li><li><code>#logo-chevron</code> uses a gradient composed of (from top to bottom) <code>--wsLogoChevronLight</code>, <code>--wsLogoChevronMid</code>, and <code>--wsLogoChevronDark</code></li><li><code>#logo-ymca</code> uses <code>--wsPartnerColor</code></li><li><code>#logo-triangle</code> uses a gradient composed of (from left to right) <code>--wsLogoTriangleLight</code> and <code>--wsLogoTriangleDark</code></li><li><code>#logo-registeredtm uses </code>&ndash;wsPartnerColor`</li><li><code>#logo-areas-of-interest</code> uses <code>--wsSecondaryColor</code></li></ul><h2 id=y-styles>Y Styles<a class=td-heading-self-link href=#y-styles aria-label="Heading self-link"></a></h2><p>Each &ldquo;Y Styles&rdquo; option enables a different library, as seen in
<a href=https://github.com/YCloudYUSA/y_lb/blob/main/y_lb.ws_style_option.yml target=_blank>y_lb.ws_style_option.yml</a>. Those libraries
<a href=https://www.drupal.org/node/2497313 target=_blank>can be overridden by a custom theme</a> if necessary.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e516f4f95441139c8e710754b11eea8e>8 - Composer</h1><p>Please always make sure <code>composer.lock</code> file is updated after any changes in <code>composer.json</code> file.
You can use <code>composer update</code> command to update any package, in this case composer will take care about updating of <code>composer.lock</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>composer update drupal/metatag
</span></span></code></pre></div><p>Also you can use <code>composer update --lock</code> command to force updating of <code>composer.lock</code> file according to dependencies in <code>composer.json</code>.</p><p>Please check official composer documentation for details:
<a href=https://getcomposer.org/doc/01-basic-usage.md target=_blank>https://getcomposer.org/doc/01-basic-usage.md</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-5702b65f9b76db2a1abac3c7e55ba756>9 - Composer version constraints for YMCA Website Services</h1><p>In 2020, due to changes in Drupal core release management and demand from YMCA Website Services customers to improve upgrade path flexibility and stability, the YMCA Website Services team added extended composer version constraints to our <code>composer.json</code>.</p><p>Examples from
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json target=_blank>composer.json</a>:</p><ul><li><code>"drupal/ckeditor_bootstrap_buttons": "^1.2 || ^2.0.0",</code> - this line means previous version was 1.2 or any 1.x starting from 1.2, and latest tested - 2.0.0 with allowed any stable 2.x starting from 2.0.0</li><li><code>"drupal/custom_formatters": "^3.0 || ^3.0@beta",</code> - tested with 3.0 beta of custom_formatters and allowed any 3.x starting from 3.0 (when it will be released)</li></ul><p>By having multiple OR (<code>||</code>) conditions we are providing information for developers on which versions could be used for upgrades. There are cases when the latest, even stable version of dependency could be incompatible with some other functionality and it makes sense to keep the version older while functionality is in the process of upgrading.</p><p>For example, if, for some reason, <code>custom_formatters</code> 3.0 won&rsquo;t be compatible with any of YMCA Website Services dependencies at the time of release, a developer can select an older beta version in order to proceed with the upgrade.</p><p>To select a specific version of a dependency when you do an upgrade of YMCA Website Services, add a dependency and its version alongside YMCA Website Services at the <code>composer require...</code> step.</p><p>For example:</p><p>from
<a href=/docs/development/openy-upgrade-how-to-for-developers/>upgrade doc</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span class=line><span class=cl>composer update --prefer-dist --with-dependencies --prefer-stable --no-suggest
</span></span></code></pre></div><p>then change the dependency version</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span class=line><span class=cl>composer require drupal/custom_formatters:3.0@beta1
</span></span></code></pre></div><p>You can change any of the dependency versions without upgrading YMCA Website Services by running only the <code>composer require...</code> command for specific dependencies and Drupal Update DB routines afterward.</p><p>Check
<a href=https://getcomposer.org/doc/articles/versions.md target=_blank>official Composer documentation about version constraints</a> and
<a href=https://www.drupal.org/docs/updating-drupal/updating-modules-and-themes-using-composer target=_blank>updating Drupal modules with Composer</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b710d1098232c9abd460f1a431e5a118>10 - Contributing</h1><p>The YMCA Website Services distribution is open source, and we welcome contributions from the YMCA Movement, the Drupal community, and beyond. Be sure to check our
<a href=/community>Community Resources</a> for how to get in touch and our
<a href=/roadmap>Roadmap</a> to see if your request is already in progress.</p><h2 id=issues>Issues<a class=td-heading-self-link href=#issues aria-label="Heading self-link"></a></h2><p>If you have a support request, you&rsquo;ve found a bug, or you have a feature request you can start in our primary repository,
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a>:</p><ul><li>Search through
<a href=https://github.com/YCloudYUSA/yusaopeny/issues target=_blank>known issues/requests</a>.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny/issues/new target=_blank>Create new issue</a>.</li></ul><p>If you are able to pinpoint the issue to a specific piece of functionality, you can open an issue on
<a href=../decoupled--external--projects-of-openy>the appropriate module</a>.</p><h2 id=pull-requests>Pull Requests<a class=td-heading-self-link href=#pull-requests aria-label="Heading self-link"></a></h2><p>We use the GitHub
<a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/getting-started/about-collaborative-development-models#fork-and-pull-model target=_blank>&ldquo;Fork and pull model&rdquo;</a> for community contributions. If you have some time to make a contribution to the project, here are the steps that will help you:</p><ul><li><a href=https://help.github.com/articles/fork-a-repo/ target=_blank>Create a fork</a> of
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a>.</li><li>Commit & push changes into your fork.</li><li><a href=https://help.github.com/articles/creating-a-pull-request/ target=_blank>Create new Pull Request</a>.</li><li>Write steps for review. In this way maintainers can go through steps on build to verify your fix/feature.<ul><li>Ensure steps for review added to README.md file in a module&rsquo;s/project&rsquo;s directory if it makes sense to check them on regular basis. Often this is needed for crucial parts of the system which is main business functionality of the component. Example of super simple steps for review
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-1.x/modules/custom/location_finder/README.md#quickstart target=_blank>see in Quickstart section of location_finder module</a>, please.</li></ul></li><li>Wait for a CI build and ask maintainers for review.</li></ul><p><strong>Important:</strong> make sure your git email is associated with account on drupal.org, otherwise you won&rsquo;t get commits there.</p><h2 id=merge-requests>Merge Requests<a class=td-heading-self-link href=#merge-requests aria-label="Heading self-link"></a></h2><p>Modules on Drupal.org follow their Merge Request process. The Drupal Wiki has in-depth documentation on these processes:</p><ul><li><a href=https://www.drupal.org/docs/develop/issues/overview-of-projects-and-issues target=_blank>Overview of projects and issues</a></li><li><a href=https://www.drupal.org/docs/develop/git/using-gitlab-to-contribute-to-drupal target=_blank>Using GitLab to contribute to Drupal</a></li></ul><h2 id=drupalorg-credits>Drupal.org credits<a class=td-heading-self-link href=#drupalorg-credits aria-label="Heading self-link"></a></h2><p>If you would like to get drupal.org credits for your contribution:</p><ul><li>Create issue on
<a href="https://www.drupal.org/project/issues/openy?categories=All" target=_blank>drupal.org</a></li><li>Link drupal.org issue to GitHub Pull Request</li><li>Specify in GitHub Pull Request link to drupal.org issue</li><li>Once PR has been merged, reviewer will close drupal.org issue with appropriate credits.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-53910b8a7d1743cda23cda2569e58867>11 - Create & Use New View Modes</h1><p>As with any other entity in Drupal, when it comes to render the rendering it in different contexts, you might want to have specific view modes.</p><p>Here you can find instructions how you can add new view modes into embedded entity form on YMCA Website Services distribution.</p><h3 id=create-a-new-view-mode>Create a new View Mode<a class=td-heading-self-link href=#create-a-new-view-mode aria-label="Heading self-link"></a></h3><ol><li>Go to &lsquo;View modes&rsquo; page: Structure -> Display modes -> View modes (or visit the URL: <code>/admin/structure/display-modes/view</code>
<img src=../../assets/view_mode_in_menu.png alt="Configuration project add/update form"></li></ol><p><img src=../../assets/view_mode_types.png alt="Configuration project add/update form"></p><ol start=2><li>Create new view mode: click &lsquo;Add view mode&rsquo; button and select entity type (or visit the URL: <code>/admin/structure/display-modes/view/add</code></li></ol><p><img src=../../assets/view_mode_firt_way_to_create.png alt="Configuration project add/update form"></p><p>or after each entity type you can see &lsquo;Add new {Name} view mode&rsquo; and click on it
<img src=../../assets/view_mode_seond_way.png alt="Configuration project add/update form"></p><ol start=3><li>Select &ldquo;Media&rdquo; and then give a name to your new view mode (or visit the URL: /<code>admin/structure/display-modes/view/add/media</code>
<img src=../../assets/view_mode_creating.png alt="Configuration project add/update form"></li></ol><h3 id=use-the-view-mode>Use the View Mode<a class=td-heading-self-link href=#use-the-view-mode aria-label="Heading self-link"></a></h3><ol><li>Go to Configuration -> Text editor embed buttons (or visit the URL: <code>/admin/config/content/embed</code>
<img src=../../assets/view_mode_using.png alt="Configuration project add/update form"></li></ol><p><img src=../../assets/view_mode_using_list.png alt="Configuration project add/update form"></p><ol start=2><li>Then make sure you enable the new view mode in &ldquo;Allowed Entity Embed Display plugins&rdquo;, and at the bottom of the page click &ldquo;Save&rdquo;.
<img src=../../assets/view_mode_enable.png alt="Configuration project add/update form"></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-421b29718da441e0406edf863b72067f>12 - Daxko</h1><p>Relates to:
<a href=/docs/content-structure/paragraphs/program-registration-daxko/>Program Registration (Daxko)</a></p><p>Configuration setting at <code>/admin/config/development/daxko</code></p><p>Account configuration must be setup before the Program Registration paragraph will work.</p><h2 id=groupex-pro>GroupEx Pro<a class=td-heading-self-link href=#groupex-pro aria-label="Heading self-link"></a></h2><p>There are three methods of integrating GroupEx Pro with your YMCA Website Services site. In order from most to least complex/customizable:</p><ul><li>API integration</li><li>Embedded schedules</li><li>Responsive schedule link</li></ul><h3 id=groupex-pro-apis>GroupEx PRO APIs<a class=td-heading-self-link href=#groupex-pro-apis aria-label="Heading self-link"></a></h3><div class="alert alert-warning" role=alert><h4 class=alert-heading>Deprecation Notice</h4>On February 28, 2023, Daxko is planning to sunset the GroupEx PRO Public API in favor of their Daxko Group API v1.</div><p>YMCA Digital Services with the help of YMCA of the North have developed and adopted a Syncer for Repeat Application which helps to migrate from the GroupEx PRO Public API to the Daxko Group API v1 and pulls data from GroupEx PRO to Program Event Framework.</p><p>See
<a href=https://github.com/open-y-subprojects/openy_daxko_gxp_syncer target=_blank>open-y-subprojects/openy_daxko_gxp_syncer</a> for how to configure the Syncer.</p><h3 id=embedded-schedules>Embedded schedules<a class=td-heading-self-link href=#embedded-schedules aria-label="Heading self-link"></a></h3><p>This replaces the deprecated
<a href=/docs/user-documentation/paragraphs/embedded-gxp-schedule/>Embedded GroupEx Pro Schedule Paragraph</a>.</p><p>Embed code for GroupEx Pro schedules can be found in your GroupEx Pro admin interface.</p><ul><li>Look for the &ldquo;New embed&rdquo; toggle.<figure class=image-caption><a href=/docs/development/daxko/gxp-embed-toggle-new.png title="View original image"><img alt="Screenshot showing &ldquo;New Schedule&rdquo; and other options in the GroupEx Pro admin." srcset="/docs/development/daxko/gxp-embed-toggle-new_hu16977679139000423355.png 458w,
/docs/development/daxko/gxp-embed-toggle-new_hu12676985044533966652.png 726w,
/docs/development/daxko/gxp-embed-toggle-new_hu15976845671507362332.png 1200w" sizes=50vw src=/docs/development/daxko/gxp-embed-toggle-new_hu16977679139000423355.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></li><li>Expand the options and choose any filters or colors that you prefer.</li><li>Disable the &ldquo;Fixed Header&rdquo; option.<figure class=image-caption><a href=/docs/development/daxko/gxp-embed-settings.png title="View original image"><img alt="Screenshot showing &ldquo;Schedule Hosting LInk / Embedded Code for New Schdule&rdquo; from Daxko" srcset="/docs/development/daxko/gxp-embed-settings_hu11407882878277223652.png 458w,
/docs/development/daxko/gxp-embed-settings_hu11896102052019748945.png 726w,
/docs/development/daxko/gxp-embed-settings_hu2023087212801101028.png 1200w" sizes=50vw src=/docs/development/daxko/gxp-embed-settings_hu11407882878277223652.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></li><li>Copy the resulting code, that will look something like this, substituting <code>000</code> for your own account number, and adding any location or category filters as needed:<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>acct</span> <span class=o>=</span> <span class=s1>&#39;000&#39;</span><span class=p>;</span> <span class=kd>var</span> <span class=nx>loc</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span> <span class=kd>var</span> <span class=nx>cat</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span> <span class=kd>var</span> <span class=nx>stylesheet</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span> <span class=kd>var</span> <span class=nx>hideLastnames</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>jsHost</span> <span class=o>=</span> <span class=p>((</span><span class=s2>&#34;https:&#34;</span> <span class=o>==</span> <span class=nb>document</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>protocol</span><span class=p>)</span> <span class=o>?</span> <span class=s2>&#34;https://&#34;</span> <span class=o>:</span> <span class=s2>&#34;http://&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=s2>&#34;&lt;scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt src=&#39;&#34;</span> <span class=o>+</span> <span class=nx>jsHost</span> <span class=o>+</span> <span class=s2>&#34;ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js&#39; type=&#39;text/javascript&#39;&gt;&lt;/scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=s2>&#34;&lt;scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt&gt;var jQuery = jQuery.noConflict(true);&lt;/scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=s2>&#34;&lt;scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt src=&#39;&#34;</span> <span class=o>+</span> <span class=nx>jsHost</span> <span class=o>+</span> <span class=s2>&#34;www.groupexpro.com/schedule/embed/schedule_embed_responsive.2.js.php?a=&#34;</span> <span class=o>+</span> <span class=nx>acct</span> <span class=o>+</span> <span class=s2>&#34;&#39; type=&#39;text/javascript&#39;&gt;&lt;/scr&#34;</span> <span class=o>+</span> <span class=s2>&#34;ipt&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div></li><li>Navigate to your YMCA website.</li><li>Follow the directions to add a
<a href=/docs/user-documentation/paragraphs/code/>Code Paragraph</a> or a
<a href=/docs/user-documentation/layout-builder/>Code Block</a>.</li><li>Paste the embed code into your block.</li><li>Save the paragraph/block and the page.</li></ul><p>If the pasted code does not appear on the page, ensure your site is updated with
<a href=https://github.com/open-y-subprojects/openy_features/pull/29 target=_blank>this change</a> to enable direct copy/pasting of embed codes.</p><p>While the incoming code is controlled by Daxko/GroupEx Pro, many changes can be made with CSS. Try the
<a href=https://www.drupal.org/project/css_editor target=_blank>CSS Editor module (≥2.0.1)</a> which is bundled with the distribution, or work with your development partner to make customizations.</p><h3 id=responsive-schedule-link>Responsive schedule link<a class=td-heading-self-link href=#responsive-schedule-link aria-label="Heading self-link"></a></h3><p>GroupEx Pro also provides direct links to the schedule page. These can be found in the &ldquo;New Embed&rdquo; section. Simply copy the link and add it to any link field or button on your site.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cf2281b87b1905231b650c39b1b9e2a9>13 - Decoupled (external) projects</h1><h1 id=inventory-of-external-modules-available-via-composer>Inventory of external modules available via Composer<a class=td-heading-self-link href=#inventory-of-external-modules-available-via-composer aria-label="Heading self-link"></a></h1><p>Check all GitHub for the tag
<a href=https://github.com/topics/openy-decoupled target=_blank><code>openy-decoupled</code></a></p><h2 id=github-hosted>GitHub hosted<a class=td-heading-self-link href=#github-hosted aria-label="Heading self-link"></a></h2><ol><li><a href=https://github.com/YCloudYUSA/yusaopeny_block_modal target=_blank><code>YCloudYUSA/yusaopeny_block_modal</code></a> - Implements a simple block with a body and title that will be used to display modal windows.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank><code>YCloudYUSA/yusaopeny_memberships</code></a> - Membership Framework for OpenY and Drupal.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_prgf_sidebar_menu target=_blank><code>YCloudYUSA/yusaopeny_prgf_sidebar_menu</code></a> - SideBar menu for referencing menu blocks and using in SideBars across different pages.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_loc_filter target=_blank><code>YCloudYUSA/yusaopeny_loc_finder</code></a> - Extended Location Finder</li><li><a href=https://github.com/Open-Y-subprojects/reqclique_gxp_sync target=_blank><code>Open-Y-subprojects/reqclique_gxp_sync</code></a> - Reqclique Group Exercise Sync</li><li><a href=https://github.com/open-y-subprojects/virtual_y_signaling_server target=_blank><code>open-y-subprojects/virtual_y_signaling_server</code></a> - Signalling server for Virtual Y</li><li><a href=https://github.com/open-y-subprojects/openy_daxko_gxp_syncer target=_blank><code>open-y-subprojects/openy_daxko_gxp_syncer</code></a> - Daxko GroupEx PRO v1 API Syncer into Program Event Framework</li><li><a href=https://github.com/open-y-subprojects/ynorth_gxp_spots_proxy target=_blank><code>open-y-subprojects/ynorth_gxp_spots_proxy</code></a> - Availability Spots Cache Proxy for Groupex PRO embed API Syncer into PEF</li><li><a href=https://github.com/open-y-subprojects/openy_node_alert target=_blank><code>open-y-subprojects/openy_node_alert</code></a> - Alerts APP for YMCA Website Services</li><li><a href=https://github.com/open-y-subprojects/openy_focal_point target=_blank><code>open-y-subprojects/openy_focal_point</code></a> - YMCA Website Services Focal Point routines</li><li><a href=https://github.com/open-y-subprojects/shared_content_server target=_blank><code>open-y-subprojects/shared_content_server</code></a> - Shared Content Server</li><li><a href=https://github.com/ynorth-projects/openy_node_session target=_blank><code>ynorth-projects/openy_node_session</code></a> - YMCA Website Services Node Session</li><li><a href=https://github.com/ynorth-projects/openy_repeat target=_blank><code>ynorth-projects/openy_repeat</code></a> - Repeat API for PEF. Schedules APP built in Vue.js</li><li><a href=https://github.com/ynorth-projects/openy_pef_gxp_sync target=_blank><code>ynorth-projects/openy_pef_gxp_sync</code></a> - Groupex Pro Embed/OpenY Syncer into PEF</li><li><a href=https://github.com/ymcatwincities/ymca_sync target=_blank><code>ymcatwincities/ymca_sync</code></a> - Syncer backend core</li><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank><code>YCloudYUSA/yusaopeny_activity_finder</code></a> - Activity Finder app</li><li><a href=https://github.com/ymcatwincities/media_entity_document target=_blank><code>ymcatwincities/media_entity_document</code></a> - Media Entity Document</li><li><a href=https://github.com/ynorth-projects/openy_prgf_session_table target=_blank><code>ynorth-projects/openy_prgf_session_table</code></a> - if you need to present couple of Sessions in a table view without using any complex app like Schedules or Activity Finder</li></ol><h2 id=drupalorg-hosted>Drupal.org hosted<a class=td-heading-self-link href=#drupalorg-hosted aria-label="Heading self-link"></a></h2><ol><li><a href=https://www.drupal.org/project/upgrade_tool target=_blank><code>drupal/upgrade_tool</code></a> - YMCA Website Services Upgrade Tool</li><li><a href=https://github.com/ymcatwincities/paragraph_skins target=_blank><code>ymcatwincities/paragraph_skins</code></a> - Skins component from OpenY. Decoupled to
<a href=https://www.drupal.org/project/paragraph_skins target=_blank><code>drupal/paragraph_skins</code></a></li><li><a href=https://www.drupal.org/project/openy_autocomplete_path target=_blank><code>drupal/openy_autocomplete_path</code></a> - YMCA Website Services Autocomplete Path. Works in Drupal 8 only. Removed from <code>9.*</code> YMCA Website Services releases.</li></ol><h2 id=decoupling-mind-map>Decoupling mind-map<a class=td-heading-self-link href=#decoupling-mind-map aria-label="Heading self-link"></a></h2><p><img src=https://user-images.githubusercontent.com/563412/123959435-d540c880-d9b6-11eb-89ed-8af3f21095dd.png alt="YMCA Website Services decoupling"></p></div><div class=td-content style=page-break-before:always><h1 id=pg-98387d4c80a088cd89ca1eedb9435593>14 - Decoupling components as independent modules</h1><h2 id=history>History<a class=td-heading-self-link href=#history aria-label="Heading self-link"></a></h2><p>In 2019 the YMCA Website Services team started decoupling major components to streamline the distribution and simplify support.</p><p>Communication started in the Community Board - Ejecting modules from OpenY distro as independent projects.</p><p>The decoupling process is ongoing. See
<a href=/docs/development/decoupled--external--projects-of-openy/>the index of decoupled projects</a>.</p><p>In 2021 the YMCA Website Services core team faced coupling blockers in the distribution during
<a href=https://github.com/YCloudYUSA/yusaopeny/milestone/21 target=_blank>the upgrade from Drupal 8 to Drupal 9</a></p><p>To formalize the ongoing development and maintenance strategy, the YMCA Website Services core team
<a href="https://docs.google.com/presentation/d/1H09GsUsSdt3RoN7rbKpNv4eihCNos74Y2KCbJBJXRqc/edit?usp=sharing" target=_blank>shared its decoupling plan with the wider community</a> in mid-2021.</p><p>This document elaborates on those processes.</p><h2 id=policy>Policy<a class=td-heading-self-link href=#policy aria-label="Heading self-link"></a></h2><ul><li>Every new component or sub-project of YMCA Website Services should be developed in its own repository - either on GitHub or Drupal.org.<ul><li>Drupal.org example:
<a href=https://www.drupal.org/project/paragraph_skins target=_blank>paragraph_skins</a></li><li>GitHub Example:
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>openy_activity_finder</a></li></ul></li><li>The decoupled project could be<ul><li><strong>part of YMCA Website Services core</strong> - e.g.
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>Activity Finder</a> and
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.2.8.0/composer.json#L112 target=_blank>added to YMCA Website Services profile by default</a>, or</li><li><strong>not part of the core</strong>, e.g.
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank>YMCA Website Services Membership Framework</a> which could be
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships/blob/master/README.md#installation target=_blank>installed later</a>.</li></ul></li><li><strong>GitHub</strong> should be used when there is no strategy to make a component or project available for the wider Drupal community - that is, when it is tied to YMCA business and unlikely to be leveraged by somebody else.</li><li><strong>Drupal.org</strong> should be used when the component could be useful to projects outside of YMCA Website Services.</li></ul><h2 id=process>Process<a class=td-heading-self-link href=#process aria-label="Heading self-link"></a></h2><h3 id=for-creating-a-new-decoupled-component>for creating a new decoupled component<a class=td-heading-self-link href=#for-creating-a-new-decoupled-component aria-label="Heading self-link"></a></h3><ol><li>Create a new GitHub/Drupal.org repository.</li><li>Work on getting an initial release with at least <code>beta</code> version stability.</li><li>Create a composer.json file for the component in order to be able to start using it via <code>composer</code>. See
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content/blob/master/composer.json target=_blank>Virtual Y</a> for an example.</li><li>Make it available for the public via packagist.org or drupal.org as a release. Ensure <code>podarok</code> is added as a co-maintainer to the respective system.</li><li>Suggest adding to YMCA Website Services by
<a href=https://github.com/YCloudYUSA/yusaopeny/issues target=_blank>opening an issue</a>.</li><li>If approved, create a Pull Request adding it as a dependency in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json target=_blank>composer.json</a>.</li><li>Ensure this component is enabled in any of the packages maintained in the
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/openy.packages.yml target=_blank>YMCA Website Services profile installation</a></li><li>Ask for review and release, according to the
<a href=/docs/development/how-we-release-openy-distribution-from-code-perspective/>release plan</a>.</li></ol><h3 id=for-decoupling-an-existing-component-of-ymca-website-services>for decoupling an existing component of YMCA Website Services<a class=td-heading-self-link href=#for-decoupling-an-existing-component-of-ymca-website-services aria-label="Heading self-link"></a></h3><p>Follow the steps above, but:</p><ul><li>After creating the repo, filter the selected component by running <code>git filter-branch --subdirectory-filter ...</code> from the latest development branch of the YMCA Website Services profile. This keeps credits of work done for this component as a part of the
<a href=/docs/development/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a>.</li><li>After separating the code, ensure the ejected code is not duplicated in the YMCA Website Services profile. Remove duplicated code in the same Pull Request in which you add the new dependency.</li></ul><h2 id=examples>Examples<a class=td-heading-self-link href=#examples aria-label="Heading self-link"></a></h2><h3 id=how-to-update-module-on-drupalorg>How to update module on Drupal.org<a class=td-heading-self-link href=#how-to-update-module-on-drupalorg aria-label="Heading self-link"></a></h3><ul><li>Git filter-branch to get a history of changes.</li><li>Change git origin to Drupal.org project.</li><li>Create a new branch and push the code to Drupal.org.</li><li>Create and push tag to Drupal.org. Create a release on drupal.org.</li><li>Update composer.json in this distribution with a new tag.</li></ul><h3 id=how-to-decouple-module-from-yn-to-drupalorg>How to decouple module from YN to Drupal.org<a class=td-heading-self-link href=#how-to-decouple-module-from-yn-to-drupalorg aria-label="Heading self-link"></a></h3><p>Example:
<a href=https://www.drupal.org/project/paragraph_skins target=_blank>paragraph_skins</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git clone git@github.com:YCloudYUSA/yusaopeny.git decouple
</span></span><span class=line><span class=cl>rm -rf decouple_copy <span class=o>&amp;&amp;</span> cp -a decouple decouple_copy
</span></span><span class=line><span class=cl><span class=nb>cd</span> decouple_copy
</span></span><span class=line><span class=cl>git filter-branch --subdirectory-filter docroot/modules/contrib/paragraph_skins
</span></span><span class=line><span class=cl>git clean -dfx
</span></span><span class=line><span class=cl>git remote remove origin <span class=o>&amp;&amp;</span> git remote add origin git@git.drupal.org:project/paragraph_skins.git
</span></span><span class=line><span class=cl>git pull origin 8.x-1.x --allow-unrelated-histories
</span></span><span class=line><span class=cl><span class=c1># Resolve conflicts if applicable.</span>
</span></span><span class=line><span class=cl>git push origin production:8.x-1.x
</span></span><span class=line><span class=cl><span class=c1># Create tags and release on Drupal.org</span>
</span></span></code></pre></div><h3 id=how-to-decouple-module-from-ymca-website-services-to-ymca-website-services-subprojectshttpsgithubcomopen-y-subprojects>How to decouple module from YMCA Website Services to
<a href=https://github.com/Open-Y-subprojects target=_blank>YMCA Website Services Subprojects</a><a class=td-heading-self-link href=#how-to-decouple-module-from-ymca-website-services-to-ymca-website-services-subprojectshttpsgithubcomopen-y-subprojects aria-label="Heading self-link"></a></h3><p>Request a repository for the module. Example:
<a href=https://github.com/Open-Y-subprojects/shared_content_server target=_blank>shared_content_server</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git clone git@github.com:YCloudYUSA/yusaopeny.git decouple
</span></span><span class=line><span class=cl>rm -rf decouple_copy <span class=o>&amp;&amp;</span> cp -a decouple decouple_copy
</span></span><span class=line><span class=cl><span class=nb>cd</span> decouple_copy
</span></span><span class=line><span class=cl>git filter-branch --subdirectory-filter docroot/profiles/contrib/openy/modules/custom/SOME_MODULE_HERE
</span></span><span class=line><span class=cl>git clean -dfx
</span></span><span class=line><span class=cl>git remote remove origin <span class=o>&amp;&amp;</span> git remote add origin git@github.com:Open-Y-subprojects/SOME_MODULE_HERE.git
</span></span><span class=line><span class=cl>git push origin production
</span></span><span class=line><span class=cl><span class=c1># Create composer.json on the decoupled repository. Example: https://github.com/YCloudYUSA/yusaopeny_activity_finder/blob/4.x/composer.json</span>
</span></span><span class=line><span class=cl>git clone git@github.com:ynorth-projects/distribution.git yn-distribution
</span></span><span class=line><span class=cl><span class=c1># Update composer json for distrubution. See below</span>
</span></span></code></pre></div><p><a href=https://github.com/YCloudYUSA/yusaopeny/pull/2288/files#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34R111 target=_blank>Example for Activity Finder</a></p><h1 id=references>References<a class=td-heading-self-link href=#references aria-label="Heading self-link"></a></h1><ul><li>A useful article for future decoupling -
<a href=https://medium.com/@ayushya/move-directory-from-one-repository-to-another-preserving-git-history-d210fa049d4b target=_blank>Move files from one repository to another, preserving git history</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-2ee1799b8bdaad376953162d43cb32a4>15 - Dependencies in drupal info.yml</h1><p>In order to generate <code>composer.json</code>, Drupal.org defines specific rules in the modules <code>info.yml</code> file</p><p>If you need to add a dependency to the Drupal.org module you should provide a format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>dependencies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>drupal:webform</span><span class=w>
</span></span></span></code></pre></div><p>In this case, your module will have composer dependency to
<a href=https://dgo.to/webform target=_blank>drupal/webform</a></p><p>If you make it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>dependencies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>whatevernameyouwish:webform</span><span class=w>
</span></span></span></code></pre></div><p>the Drupal.org packaging routine will replace it with <code>drupal:webform</code> on the fly.</p><p>In order to break the dependency on composer level but still tell Drupal core to have module dependency while resolving dependencies during the process of enabling the module, you should use the simplified format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>dependencies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>webform</span><span class=w>
</span></span></span></code></pre></div><p>In the above case, composer won&rsquo;t have any dependencies, but your module will require that the webform module be available in the codebase in order to be enabled by Drupal core.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d0234314d5cf529adfacfd9dc234a2fc>16 - Deprecating and removing components</h1><p>Occasionally old code is deprecated from the YMCA Website Services codebase. In order to minimize disruption to existing sites, we use the following process:</p><ol><li><strong>Decide</strong> - Before removing components from the distribution we gather feedback from the community to protect active projects from having components accidentally removed. This is accomplished via messaging in the YMCA Website Services Slack and discussion on Monthly calls.</li><li><strong>Deprecate</strong> - Once a decision is made, we notify users that the feature will be removed soon. The deprecated component is moved from the <code>YMCA Website Services</code> package group to the <code>YMCA Website Services (Deprecated)</code> package group. For example:
<a href=https://github.com/open-y-subprojects/openy_features/pull/15/files target=_blank>Deprecate Daxko Program Registration Paragraph</a>. Deprecation notices are posted in point and quarterly releases of YMCA Website Services.</li><li><strong>Uninstall</strong> - Before removing code, components should be uninstalled via an update hook in the distribution and any hard dependencies should be removed. Uninstalls must occur <em>at least one point (fix) release</em> after the deprecation notice.</li><li><strong>Remove</strong> - Complete removal of the component from the codebase or <code>composer.json</code> should happen <em>at least one quarterly (feature) release</em> after the deprecation notice.</li></ol><p>Additionally, the following housekeeping steps should be taken when deprecating a component:</p><ol><li>The release where the deprecated component has been uninstalled should be added to the
<a href=https://github.com/YCloudYUSA/yusaopeny/wiki/Important-versions-for-upgrade-path target=_blank>important versions document</a> in the Wiki.</li><li>Code should be decoupled to external GitHub repositories with all history of commits, marked as <code>openy-decoupled</code>, and archived.</li></ol><h2 id=uxcx-for-deprecated-components>UX/CX for deprecated components<a class=td-heading-self-link href=#uxcx-for-deprecated-components aria-label="Heading self-link"></a></h2><p>In order to deliver a high-quality upgrade path and keep the distribution on the bleeding edge of technologies we occasionally replace old and aged components with new ones for a better User eXperience and Content eXperience.</p><p>In order to achieve deprecations we have a policy that aims to provide a comfortable migration path for all components of the distribution.</p><ol><li>When we create a component that will replace an old one we must introduce a period of overlap, when both components are available in the system for some time (6-18 months usually). This allows users to have time and resources to migrate from the old to the new one before it is removed from the distribution. See the
<a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder#update-from-version-3x-to-version-4x target=_blank>Activity Finder v3 to v4 migration</a>.</li><li>Deprecated components are moved to the deprecated modules group in the list of modules at Admin > Extend. Also, we add
<a href=https://www.drupal.org/node/3215042 target=_blank><code>lifecycle</code> and <code>lifecycle_link</code></a> to the documentation in every deprecated module in order to provide enough information for the community. See
<a href=https://git.drupalcode.org/project/groupexpro/-/commit/67e7234257abe5f9107f9f5d4a0736e044879dc7 target=_blank>Deprecate openy_gxp.info.yml</a>.</li><li>All titles of deprecated components in the Content Editing interface should be renamed to add the suffix <code>(deprecated)</code> to help Content Managers on a daily basis to not chose an old component and use a new one.<figure class=image-caption><a href=/img/deprecated_naming.png title="View original image"><img alt="Naming Example" srcset="/img/deprecated_naming_hu9487052366098887089.png 458w,
/img/deprecated_naming_hu1319338114223600679.png 726w,
/img/deprecated_naming_hu17443035256505968810.png 1200w" sizes=50vw src=/img/deprecated_naming_hu9487052366098887089.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></li><li>For the majority of content components an automated migration path is expensive and sometimes even impossible, so we have a &ldquo;lazy migration&rdquo; practice in our community which puts the responsibility of migration on Content Managers and Strategists. Once new components are available in the distribution all editors should start using them and rebuild old pages by replacing old components with new ones. After the communicated timeframe (6-18 months) old components are removed from the distribution, but if an association needs it the component will be available as an independent—but unsupported—project. It can be supported by a 3rd-party agency or developer as long as it is needed.</li><li>After the communicated timeframe (6-18 months) the Core team will remove the component from the distribution and keep it in an independent project for archival reasons. Usually, the project is marked as archived/obsolete in order to clarify that it is not supported and is possibly insecure.</li><li>If the normal timeframe (6-18 months) is not achievable due to unforeseeable circumstances, the Core team will add proper notifications and tutorials for the community to help migrate in a comfortable way in a shorter period of time. See the
<a href=https://ds-docs.y.org/docs/development/daxko/#groupex-pro-apis target=_blank>GroupEx Pro API deprecation notice</a>.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-e5e77b82ed465a1a79e16199974124db>17 - Development FAQ</h1><h1 id=ymca-website-services-developer-faq>YMCA Website Services Developer FAQ<a class=td-heading-self-link href=#ymca-website-services-developer-faq aria-label="Heading self-link"></a></h1><h2 id=local-development>Local Development<a class=td-heading-self-link href=#local-development aria-label="Heading self-link"></a></h2><h3 id=getting-started-with-a-local-environment>Getting started with a local environment<a class=td-heading-self-link href=#getting-started-with-a-local-environment aria-label="Heading self-link"></a></h3><p>To start developing you need to obtain the latest YMCA Website Services codebase. See the
<a href=https://github.com/YCloudYUSA/yusaopeny-project#latest-development-version-drupal-9-2x target=_blank><code>openy-project</code> repository</a> for the full process.</p><p><a href="https://www.youtube.com/watch?v=0XbqXlDyDCY" target=_blank>This video tutorial</a> will walk you through how to initiate a local development environment.</p><p>The YMCA Website Services team has pre-built environments and walkthroughs using either
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm#drupal-vagrant-dev-box-for-openy-support target=_blank>Vagrant and VirtualBox</a> or
<a href=https://github.com/YCloudYUSA/yusaopeny-docksal#get-started target=_blank>Docker and Docksal</a>. Choose the method that you&rsquo;re most comfortable with and get started!</p><h3 id=gathering-information-about-your-local-environment>Gathering information about your local environment<a class=td-heading-self-link href=#gathering-information-about-your-local-environment aria-label="Heading self-link"></a></h3><p>To best troubleshoot issues, it&rsquo;s helpful for the YMCA Website Services team to have as much information about your environment as possible. Before you ask for help, watch this tutorial on
<a href="https://www.youtube.com/watch?v=01y617maeBE" target=_blank>how to gather that information</a>.</p><h3 id=debugging-with-xdebug-in-your-local>Debugging with Xdebug in your local<a class=td-heading-self-link href=#debugging-with-xdebug-in-your-local aria-label="Heading self-link"></a></h3><p>The Docksal project maintains detailed information for
<a href=https://docs.docksal.io/tools/xdebug/ target=_blank>using Xdebug with VSCode, PHPStorm, and more</a>.</p><h2 id=contributing>Contributing<a class=td-heading-self-link href=#contributing aria-label="Heading self-link"></a></h2><h3 id=who-should-i-specify-for-review>Who should I specify for review?<a class=td-heading-self-link href=#who-should-i-specify-for-review aria-label="Heading self-link"></a></h3><p>We have a best practice to get at least 2 independent reviews before merging code. Please request a review from the YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) and somebody else (from your team or another YMCA Website Services partner).</p><h3 id=who-is-responsible-for-merging>Who is responsible for merging?<a class=td-heading-self-link href=#who-is-responsible-for-merging aria-label="Heading self-link"></a></h3><p>The YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) is responsible for final approval, merging, and release management on the YMCA Website Services project.</p><h3 id=what-labels-in-prs-should-i-use>What labels in PRs should I use?<a class=td-heading-self-link href=#what-labels-in-prs-should-i-use aria-label="Heading self-link"></a></h3><h3 id=what-milestone-should-i-specify>What milestone should I specify?<a class=td-heading-self-link href=#what-milestone-should-i-specify aria-label="Heading self-link"></a></h3><h3 id=why-i-cant-add-labels-or-specify-milestones>Why I can&rsquo;t add labels or specify milestones?<a class=td-heading-self-link href=#why-i-cant-add-labels-or-specify-milestones aria-label="Heading self-link"></a></h3><p>All of these require you to be granted Contributor access to the YMCA Website Services GitHub repository. Contact the YMCA Website Services Lead Technical Architect (Andrii Podanenko, <code>@podarok</code>) to get access. Labels are usually set by the YMCA Website Services Core Team.</p><h3 id=why-are-the-steps-for-review-in-pull-requests-so-important>Why are the steps for review in Pull Requests so important?<a class=td-heading-self-link href=#why-are-the-steps-for-review-in-pull-requests-so-important aria-label="Heading self-link"></a></h3><p>When you send your code for review our team must know both how to review the code and what to test to verify the functionality. You are the only source of truth for how to check functionality. Adding steps for review will help the reviewer and QA team to verify that the issue is resolved.</p><h3 id=why-should-i-add-a-reference-to-the-github-issue-in-my-pr-description>Why should I add a reference to the GitHub issue in my PR description?<a class=td-heading-self-link href=#why-should-i-add-a-reference-to-the-github-issue-in-my-pr-description aria-label="Heading self-link"></a></h3><p>As we are a community-led project, there may be a long time between creating an issue and resolving it in a Pull Request. The reviewer should be able to understand the context and possible discussion around the issue to be resolved with your PR. The more context we have, the better and faster we can review the request.</p><h3 id=in-what-format-should-i-add-commits-should-i-add-internal-jira-task-id-or-github-issue>In what format should I add commits, should I add internal Jira task ID or GitHub issue?<a class=td-heading-self-link href=#in-what-format-should-i-add-commits-should-i-add-internal-jira-task-id-or-github-issue aria-label="Heading self-link"></a></h3><p>It is important to make commit messages with some sort of sense for the human to read them when digging back in history. Adding any task identifications from the project management system is allowed.</p><h3 id=what-is-the-deepcode-bot>What is the &ldquo;DeepCode&rdquo; bot?<a class=td-heading-self-link href=#what-is-the-deepcode-bot aria-label="Heading self-link"></a></h3><p>DeepCode bot is the automated, machine learning code review system that analyses huge amounts of GitHub repositories and is sometimes useful to find common issues before humans do reviews. It is helpful, but not always necessary to fix issues found by the DeepCode bot because sometimes it fails. If you see a comment be sure to read the report. If the report makes sense, then fix the issue suggested by the bot.</p><h2 id=build-automation--ci>Build Automation & CI<a class=td-heading-self-link href=#build-automation--ci aria-label="Heading self-link"></a></h2><h3 id=what-ci-processes-does-ymca-website-services-have-in-place>What CI processes does YMCA Website Services have in place?<a class=td-heading-self-link href=#what-ci-processes-does-ymca-website-services-have-in-place aria-label="Heading self-link"></a></h3><p>To get a fully working YMCA Website Services site for the code change you are about to push for review there is a build generating system installed for the YMCA Website Services GitHub repository that automatically generates a dedicated temporary website with your changes applied.</p><h3 id=why-are-some-builds-created-automatically-and-some-not>Why are some builds created automatically and some not?<a class=td-heading-self-link href=#why-are-some-builds-created-automatically-and-some-not aria-label="Heading self-link"></a></h3><p>By default, builds are configured for trusted users, so if you are getting a message from the bot like</p><blockquote><p>&ldquo;Can one of the admins verify this patch? Use &ldquo;o+k to test&rdquo; or &lsquo;&rsquo;t+est this please&rdquo; for manual build execution."</p></blockquote><p>then your username is not in the allowlist and somebody from the YMCA Website Services Core Team can comment to initiate a build for you. Contact <code>@podarok</code> to get your build generated or your name added to the allowlist.</p><h3 id=how-do-i-create-a-build-for-my-pr>How do I create a build for my PR?<a class=td-heading-self-link href=#how-do-i-create-a-build-for-my-pr aria-label="Heading self-link"></a></h3><p>If you are on the allowlist then simply create a Pull Request from your fork to the YMCA Website Services repository. After up to 30 minutes you&rsquo;ll receive comments with links to the generated site builds.</p><h3 id=when-are-builds-deleted-from-the-server>When are builds deleted from the server?<a class=td-heading-self-link href=#when-are-builds-deleted-from-the-server aria-label="Heading self-link"></a></h3><p>Usually, you have a day for the build to be wiped out from the server. If there is an upcoming deadline and many PRs are coming in, the lifetime could be significantly shorter, down to a couple of hours.</p><h3 id=who-should-i-contact-to-get-logs-from-the-build-server>Who should I contact to get logs from the build server?<a class=td-heading-self-link href=#who-should-i-contact-to-get-logs-from-the-build-server aria-label="Heading self-link"></a></h3><p>Andrii Podanenko <code>@podarok</code> or Dima Danylevskyi <code>@danylevskyi</code></p><h3 id=what-should-i-do-if-tests-fail>What should I do if tests fail?<a class=td-heading-self-link href=#what-should-i-do-if-tests-fail aria-label="Heading self-link"></a></h3><p>If you have any concerns with reports generated by the code checkers that are used in YMCA Website Services ask YMCA Website Services Lead Technical Architect Andrii Podanenko to get them resolved. The majority of these systems are works-in-progress and it is helpful to have feedback on them.</p><h2 id=how-do-i-install-ymca-website-services-on-pantheon-hosting>How do I install YMCA Website Services on Pantheon hosting<a class=td-heading-self-link href=#how-do-i-install-ymca-website-services-on-pantheon-hosting aria-label="Heading self-link"></a></h2><p>See
<a href=https://github.com/YCloudYUSA/yusaopeny/issues/2004 target=_blank>request from a community</a>. The solution is described in
<a href=https://pantheon.io/docs/nested-docroot target=_blank>Pantheon&rsquo;s documentation on nested docroots</a>. We suggest that you maintain your own <code>composer.json</code> with the specified web-root directory, as described in the
<a href=https://github.com/pantheon-systems/example-drops-8-composer/blob/master/composer.json#L94 target=_blank>Pantheon examples</a>.</p><h2 id=upgrade-troubleshooting>Upgrade Troubleshooting<a class=td-heading-self-link href=#upgrade-troubleshooting aria-label="Heading self-link"></a></h2><p>See
<a href=/docs/development/openy-upgrade-how-to-for-developers/>Upgrading to a new version of the distribution</a> for full instructions.</p><h3 id=config-is-missing>Config is missing<a class=td-heading-self-link href=#config-is-missing aria-label="Heading self-link"></a></h3><p>Occasionally, configuration will get removed or otherwise go missing in the upgrade process. For instance, the list of colors could go missing in the Layout Builder styles pane.</p><p><figure class=image-caption><a href=/docs/development/development-faq/faq-config-missing-styles.png title="View original image"><img alt="A screenshot with missing colors." srcset="/docs/development/development-faq/faq-config-missing-styles_hu12014814425034083862.png 458w,
/docs/development/development-faq/faq-config-missing-styles_hu824634619722860699.png 726w,
/docs/development/development-faq/faq-config-missing-styles_hu10644022602861583000.png 1200w" sizes=50vw src=/docs/development/development-faq/faq-config-missing-styles_hu12014814425034083862.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></p><p>Usually, these changes are resolved by update hooks that import new config, but on occasion, these too can fail or break. In that case, we have a few options for resolving the issue:</p><ol><li>Re-run the most recent related update hook.</li><li>Import the config with drush.</li><li>Import the config with the Drupal UI.</li></ol><p>The first step in any of this troubleshooting is to try to find the offending config. In this case, searching your codebase for &ldquo;text-color&rdquo; might lead you to
<a href=https://github.com/YCloudYUSA/y_lb/blob/main/config/optional/bootstrap_styles.settings.yml target=_blank>this config file in y_lb</a>. Now, we can try a few things&mldr;</p><blockquote><p>NOTE: These methods could damage your site if not tested. Please take a backup before proceeding.</p></blockquote><h4 id=re-run-an-update-hook>Re-run an update hook<a class=td-heading-self-link href=#re-run-an-update-hook aria-label="Heading self-link"></a></h4><p>Often, searching an adjacent <code>.install</code> file can get you an existing
<a href=https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Extension%21module.api.php/function/hook_update_N/10 target=_blank>update hook</a> to import the missing configuration. In our example case,
<a href=https://github.com/YCloudYUSA/y_lb/blob/main/y_lb.install#L39-L50 target=_blank>y_lb_update_9001</a> imports the one settings file that we&rsquo;re looking for. It doesn&rsquo;t matter that the hook is old, if we re-run it, it will import the file in its current state in our file system.</p><p>To re-run the update hook (via
<a href="https://gist.github.com/bsingr/e3ff80534e9e4f7d50ba6b240e932c80?permalink_comment_id=4671780#gistcomment-4671780" target=_blank>gist</a>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>drush</span> <span class=nx>php</span><span class=o>-</span><span class=k>eval</span> <span class=s2>&#34;\Drupal::moduleHandler()-&gt;loadInclude(&#39;y_lb&#39;, &#39;install&#39;); y_lb_update_9001();&#34;</span>
</span></span></code></pre></div><p>Understanding this command:</p><ul><li><a href=https://www.drush.org/12.x/commands/php_eval/ target=_blank><code>drush php-eval</code></a> evaluates an arbitrary php command on the command line.</li><li><a href=https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Extension%21ModuleHandler.php/function/ModuleHandler%3A%3AloadInclude/10 target=_blank><code>\Drupal::moduleHandler()->loadInclude($module, $type)</code></a> loads the <code>y_lb.install.php</code> file.</li><li><code>y_lb_update_9001();</code> runs the individual function from the file.</li></ul><h4 id=import-config-with-drush>Import config with drush<a class=td-heading-self-link href=#import-config-with-drush aria-label="Heading self-link"></a></h4><p>Suppose the target config exists mostly on its own, or you wish to import the entire config of a module (due to a failed install, for instance). In that case, you can use
<a href=https://www.drush.org/11.x/commands/config_import/ target=_blank><code>drush config:import</code></a> with <code>--partial</code> and <code>--source</code> pointing to a module directory, relative to the Drupal root. In this case:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>drush config-import --partial --source<span class=o>=</span>modules/contrib/y_lb/config/optional/
</span></span></code></pre></div><p>Be aware that all configs in that directory will be imported. Targeting a single config file with drush is impossible, although you could also temporarily move the config to its own directory.</p><h4 id=import-config-with-the-ui>Import config with the UI<a class=td-heading-self-link href=#import-config-with-the-ui aria-label="Heading self-link"></a></h4><p>Another way to import a single configuration file is with the Drupal &ldquo;Config Synchronization&rdquo; admin pages. To import a single item:</p><ul><li>Go to <strong>Admin</strong> > <strong>Configuration</strong> > <strong>Development</strong> > <strong>Config Synchronization</strong> > <strong>Import</strong> > <strong>Single item</strong> (<code>admin/config/development/configuration/single/import</code>).</li><li>Choose the <strong>Configuration type</strong> (if you are unsure, choose &ldquo;Simple Configuration&rdquo;)</li><li>Paste in the configuration from the file and click <strong>Import</strong>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ba2edc5c10fdcc4292e7ed4d4626d912>18 - Drupal 10 update</h1><div class=lead>The update from Drupal 9 to 10 is easier than some, but still comes with some challenges.</div><p>The distribution core team has gone through these steps to ensure as smooth of a transition as possible. If your site is up-to-date and using no additional dependencies you may be able to skip right to the update, but otherwise you&rsquo;ll want to review these steps.</p><h2 id=resources>Resources<a class=td-heading-self-link href=#resources aria-label="Heading self-link"></a></h2><ul><li><a href=https://www.drupal.org/docs/upgrading-drupal/upgrading-from-drupal-8-or-later/upgrading-from-drupal-9-to-drupal-10 target=_blank>Upgrading from Drupal 9 to Drupal 10 (drupal.org)</a></li><li><a href=https://www.drupal.org/docs/core-modules-and-themes/deprecated-and-obsolete target=_blank>Deprecated and obsolete extensions (drupal.org)</a></li><li><a href=https://github.com/mglaman/composer-drupal-lenient target=_blank>mglaman/composer-drupal-lenient</a> - can help install modules that do not yet have official Drupal 10 support.</li></ul><h2 id=review-important-versions>Review important versions<a class=td-heading-self-link href=#review-important-versions aria-label="Heading self-link"></a></h2><p>Step through the distribution&rsquo;s
<a href=../important-versions-for-upgrade-path/#important-versions>important versions</a> until you reach <code>9.2.13.0</code>. You should be running the latest Drupal 9.5.x before you begin the upgrade to 10.</p><h2 id=pre-checks>Pre-checks<a class=td-heading-self-link href=#pre-checks aria-label="Heading self-link"></a></h2><ol><li>CKEditor<ol><li>If any custom/contrib modules are used, CKE5 should likely be done AFTER your D10 upgrade</li><li>Contrib checks will NOT be found in the next step, be sure to check these manually</li></ol></li><li>Dependency cleanup<ol><li>Modules not installed, but in composer.json should be cleaned up to prevent unwanted dependency issues in trying to update.</li></ol></li><li>Admin theme<ol><li>If your website uses a
<a href=https://www.drupal.org/docs/core-modules-and-themes/deprecated-and-obsolete#s-recommendations-for-deprecated-themes target=_blank>deprecated admin theme</a>, you should migrate to the Claro theme and test the admin experience. If necessary you can keep the deprecated theme as a contrib package but that is not recommended and won&rsquo;t be supported by the distribution.</li></ol></li></ol><h2 id=upgrade-report>Upgrade Report<a class=td-heading-self-link href=#upgrade-report aria-label="Heading self-link"></a></h2><ul><li>Install Upgrade Status<ul><li><code>fin composer show drupal/core | grep versions</code></li><li><code>fin composer require --dev drupal/core-dev:[copy version above] --update-with-all-dependencies</code></li><li><code>fin composer require drupal/upgrade_status</code></li><li><code>fin drush en upgrade_status</code></li></ul></li><li>Run the report<ul><li><code>/admin/reports/upgrade-status</code></li></ul></li><li>Check if the website is using custom CKEditor plugins with
<a href=https://www.drupal.org/project/ckeditor_plugin_report target=_blank>CKEditor Plugin Report</a></li></ul><h2 id=keep--kill>Keep / Kill<a class=td-heading-self-link href=#keep--kill aria-label="Heading self-link"></a></h2><ul><li>Based from the report above, determine which modules (if any) could be removed without impacting the site</li><li>From the remaining, review if the module<ul><li>Has a D10 ready version</li><li>Has a D10 ready Fork/Patch<ul><li><a href=https://github.com/mglaman/composer-drupal-lenient target=_blank>mglaman/composer-drupal-lenient</a> allows you to install outdated modules without using forks!</li></ul></li><li>Has been abandoned</li></ul></li><li>Itemize based on the above with notes of efforts to continue using the modules</li></ul><h2 id=custom-modules-and-themes>Custom modules and themes<a class=td-heading-self-link href=#custom-modules-and-themes aria-label="Heading self-link"></a></h2><ul><li>Run custom modules and themes through
<a href=https://github.com/mglaman/drupal-check target=_blank>drupal-check</a> and
<a href=https://www.drupal.org/docs/contributed-modules/code-review-module/php-codesniffer-command-line-usage target=_blank>phpcs</a> and fix issues<ul><li>Some common issues:<ul><li><a href=https://www.drupal.org/node/3158256 target=_blank>Remove jQuery dependency from the once feature</a></li><li><a href=https://www.drupal.org/docs/upgrading-drupal/upgrading-from-drupal-8-or-later/upgrading-from-drupal-9-to-drupal-10-0/migrating-dependencies-on-core-jquery-ui-libraries target=_blank>Migrating dependencies on core jQuery UI libraries</a></li><li><a href=https://www.drupal.org/node/2940031 target=_blank>Functions file_create_url() and file_url_transform_relative() are deprecated</a></li><li><a href=https://www.drupal.org/node/3201242 target=_blank>Access checking must be explicitly specified on content entity queries</a></li><li><a href=https://www.drupal.org/node/2940438 target=_blank>drupal_get_path() and drupal_get_filename() have been deprecated in favor of extension listing services</a></li><li><a href=https://www.drupal.org/node/3071078 target=_blank>Preparing for Twig 2 in Drupal 9</a></li></ul></li></ul></li><li>Search for <code>hook_field_widget_form_alter</code>, <code>hook_field_widget_multivalue_form_alter</code>, <code>hook_field_widget_WIDGET_TYPE_form_alter</code> and <code>hook_field_widget_multivalue_WIDGET_TYPE_form_alter</code>. These hooks have been deprecated in Drupal 9.2 and not available anymore in Drupal 10.
<a href=https://www.drupal.org/node/3180429 target=_blank>Streamline field widget hooks</a></li></ul><h2 id=patches>Patches<a class=td-heading-self-link href=#patches aria-label="Heading self-link"></a></h2><ul><li>Review patches in <code>composer.json</code>. Review any that are no longer applying or may be duplicated by the distribution.</li><li>Carefully review and re-roll custom patches.</li></ul><h2 id=update>Update<a class=td-heading-self-link href=#update aria-label="Heading self-link"></a></h2><p>At this point you should be ready to update to the latest version of the distribution:</p><ul><li>Edit the <code>ycloudyusa</code> version in your project root <code>composer.json</code>: <code>"ycloudyusa/yusaopeny":"^10.3",</code></li><li>Run <code>composer update</code></li><li>If errors occur, review the conflicts, check out the
<a href=https://www.drupal.org/docs/updating-drupal/updating-drupal-core-via-composer#known-issues target=_blank>known issues</a>, and attempt to resolve them.</li><li>Re-run the previous steps until they complete successfully</li><li>Run <code>drush updb</code>, review the updates, and run them.</li></ul><h2 id=smoke-tests>Smoke tests<a class=td-heading-self-link href=#smoke-tests aria-label="Heading self-link"></a></h2><p>We recommend reviewing critical functionality after the update to ensure any custom functionality still works.</p><h2 id=troubleshooting>Troubleshooting<a class=td-heading-self-link href=#troubleshooting aria-label="Heading self-link"></a></h2><h3 id=composer-issues>Composer issues<a class=td-heading-self-link href=#composer-issues aria-label="Heading self-link"></a></h3><p>Composer can be &mldr; tricky. To resolve composer conflicts:</p><ul><li>If specific modules conflict, try requiring them directly to get more information about the conflict.</li><li>Make good use of
<a href=https://getcomposer.org/doc/03-cli.md#depends-why target=_blank>composer why</a> and
<a href=https://getcomposer.org/doc/03-cli.md#prohibits-why-not target=_blank>composer why-not</a></li></ul><h3 id=update-hook-conflicts>Update hook conflicts<a class=td-heading-self-link href=#update-hook-conflicts aria-label="Heading self-link"></a></h3><p>If you run into an error like this:</p><blockquote><p>> [notice] Update started: y_lb_update_9011</p><p>> [error] Configuration <em class=placeholder>core.entity_view_display.node.lb_event.featured</em> depends on the <em class=placeholder>core.entity_view_mode.node.featured</em> configuration that will not exist after import.</p></blockquote><p>you may be able to resolve it yourself.</p><p>Breaking down the error message:</p><ul><li><code>core.entity_view_mode.node.featured</code> is missing, which is blocking
<a href=https://github.com/YCloudYUSA/y_lb/blob/main/y_lb.install#L199 target=_blank>y_lb_update_9011</a> from installing <code>core.entity_view_display.node.lb_event.featured</code></li><li>We need to figure out where <code>core.entity_view_mode.node.featured</code> <em>should</em> be coming from, so we can search our code for that.<ul><li>Use the &ldquo;Find in files&rdquo; command in your IDE to search <code>docroot/modules</code>, or</li><li>from the command line:<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>╰─ grep -rI <span class=s2>&#34;core.entity_view_mode.node.featured&#34;</span>
</span></span><span class=line><span class=cl>./contrib/ws_event/config/optional/core.entity_view_display.node.lb_event.featured.yml:    - core.entity_view_mode.node.featured
</span></span><span class=line><span class=cl>./contrib/y_lb_article/config/optional/core.entity_view_display.node.article_lb.featured.yml:    - core.entity_view_mode.node.featured
</span></span></code></pre></div></li><li>Looking at those files in the codebase, they are identical, so we could manually import them from either module. Let&rsquo;s do it.</li></ul></li></ul><ol><li><p>Add an update hook to your own custom module
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/108/files#diff-2b10287d954ae6b7c36a1af05970dc0f2ee602047b2215d60d9052a15a8819b5R1233-R1240 target=_blank>like this example</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// This goes in mymodule.install as the next update hook.
</span></span></span><span class=line><span class=cl><span class=c1>// Increment the number accordingly.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>function</span> <span class=nf>mymodule_update_9000</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$path</span> <span class=o>=</span> <span class=nx>\Drupal</span><span class=o>::</span><span class=na>service</span><span class=p>(</span><span class=s1>&#39;extension.list.module&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>getPath</span><span class=p>(</span><span class=s1>&#39;ws_event&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/optional&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=sd>/** @var \Drupal\config_import\ConfigImporterService $config_importer */</span>
</span></span><span class=line><span class=cl>    <span class=nv>$config_importer</span> <span class=o>=</span> <span class=nx>\Drupal</span><span class=o>::</span><span class=na>service</span><span class=p>(</span><span class=s1>&#39;config_import.importer&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>setDirectory</span><span class=p>(</span><span class=nv>$path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$config_importer</span><span class=o>-&gt;</span><span class=na>importConfigs</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;core.entity_view_mode.node.featured&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p>Use
<a href=https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Extension%21module.api.php/function/hook_update_dependencies/10.0.x target=_blank>hook_update_dependencies</a> to ensure this new update runs before the failing one.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// This also goes in mymodule.install.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>function</span> <span class=nf>mymodule_update_dependencies</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>$dependencies</span><span class=p>[</span><span class=s1>&#39;y_lb&#39;</span><span class=p>][</span><span class=mi>9011</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;mymodule&#39;</span> <span class=o>=&gt;</span> <span class=mi>9000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p>Re-run <code>drush updb</code>.</p></li><li><p>If you run into other missing configs, add them to the list to be imported in <code>update</code> hook and re-run <code>updb</code>.</p></li><li><p>Consider backporting your customization which led to the challenge of doing this upgrade in order for it to be covered and tested by distribution developers.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-12d4beeaad5bdb13df8a46a690efc2f6>19 - Drupal 9 core dependencies version flexibility</h1><p>This document is no longer updated.</p><p>To update the version of Drupal being used on your site independent of YMCA Website Services see
<a href=https://www.drupal.org/docs/updating-drupal/updating-drupal-core-via-composer target=_blank>Updating Drupal Core via Composer</a>. Be aware that <code>openy/composer.json</code> may set
<a href="https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/composer.json#:~:text=%22drupal/-,core%2Drecommended,-%22%3A%20%22%3E%3D9.1%2C%20%3C9.3%22%2C" target=_blank>Drupal core version constraints</a>.</p><hr><p>February 2021 release tagged Drupal core both 9.0.x and 9.1.x as allowed to be used.</p><p>Composer by default is installing the latest stable version, so a command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development OPENY --no-interaction
</span></span></code></pre></div><p>will install YMCA Website Services on latest 9.1.x Drupal core.</p><p>If there is a need to stay on Drupal 9.0.x stable core please use</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development OPENY --no-interaction
</span></span><span class=line><span class=cl><span class=nb>cd</span> OPENY
</span></span><span class=line><span class=cl>composer require drupal/core:~9.0.7
</span></span></code></pre></div><p>where 9.0.7 - is a needed version for your YMCA Website Services instance</p><p>For modules see
<a href=/docs/development/composer-version-constraints-for-open-y/>Composer-version-constraints-for-Open-Y</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-fc55a1b49a06c32f686fcc092df7cd28>20 - Drupal-SA-CORE-2018-004 security update</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/development/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>To update your OpenY site with security fix from Drupal core
<a href=https://www.drupal.org/SA-CORE-2018-004 target=_blank>https://www.drupal.org/SA-CORE-2018-004</a>
OpenY team is suggesting 2 options- via patch and via Drupal core upgrade(or OpenY upgrade).
Drupal core upgrade or OpenY upgrade is not always possible, but security issue should be fixed asap.
So consider to apply patch and plan OpenY upgrade later.</p><h3 id=how-to-apply-the-patch>How to apply the patch<a class=td-heading-self-link href=#how-to-apply-the-patch aria-label="Heading self-link"></a></h3><h3 id=patching-openy-releases-801---8110-drupal-cores-82x-83x-84x>Patching OpenY releases 8.0.1 - 8.1.10 (Drupal cores 8.2.x, 8.3.x, 8.4.x)<a class=td-heading-self-link href=#patching-openy-releases-801---8110-drupal-cores-82x-83x-84x aria-label="Heading self-link"></a></h3><p>For patching your OpenY release, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial - you should:
if your site is located in /var/www/html</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/SA-CORE-2018-004.patch
</span></span></code></pre></div><p>if your site is located in /var/www/openy</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/openy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/SA-CORE-2018-004.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>sudo cp docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php /var/backups/RequestSanitizer.php
</span></span><span class=line><span class=cl>sudo cp docroot/core/modules/file/src/Element/ManagedFile.php /var/backups/ManagedFile.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 --dry-run &lt; SA-CORE-2018-004.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># patch -p1 --dry-run &lt; SA-CORE-2018-004.patch</span>
</span></span><span class=line><span class=cl>checking file core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span><span class=line><span class=cl>checking file core/modules/file/src/Element/ManagedFile.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 &lt; SA-CORE-2018-004.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git add docroot/core/modules/file/src/Element/ManagedFile.php docroot/core/lib/Drupal/Core/Security <span class=o>&amp;&amp;</span> git commit -m <span class=s2>&#34;Patching OpenY core&#34;</span> <span class=o>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><p>==========================</p><h3 id=how-to-patch-your-digitalocean-openy-install>How to patch your Digitalocean OpenY install<a class=td-heading-self-link href=#how-to-patch-your-digitalocean-openy-install aria-label="Heading self-link"></a></h3><p>In case if you have followed tutorial you should have your OPenY installed on you DigitalOcean server(droplet) in a predictable for current document folder. That&rsquo;s why we prepared a short how to patch your OpenY site in a most simple way if you are not a Tech Guru, but just a user</p><ol><li>Log in as an admin user to your site admin UI by visiting <code>/user/login</code> URI page.</li><li>Login to your DigitalOcean cloud console at digitalocean.com and find Access Console in the dropdown for the droplet you are using for the OpenY
<img src=https://user-images.githubusercontent.com/563412/38104705-b2ebf8fe-3392-11e8-8c27-55db3ed032ff.png alt=image></li><li>You should see a popup window with a black screen where console asks you for the login. Use <code>root</code> user and a password generated for you upon droplet creation.</li><li>After login to a console run the command below, respectively to the version of your Drupal core.</li></ol><h3 id=one-line-script-to-patch-drupal-core-for-openy>One line script to patch Drupal core for OpenY<a class=td-heading-self-link href=#one-line-script-to-patch-drupal-core-for-openy aria-label="Heading self-link"></a></h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bash &lt; &lt;<span class=o>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/runSA-CORE-2018-004.sh<span class=o>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-82275f3be4b9061ff50a7f386c6ae551>21 - Google Custom Search Configuration</h1><p>The YMCA Website Services release <strong>8.2.4</strong> introduces Google Custom Search (aka Google Programmable Search Engine) for the website out of the box.</p><h2 id=enabling-the-module>Enabling the module<a class=td-heading-self-link href=#enabling-the-module aria-label="Heading self-link"></a></h2><h3 id=fresh-installations>Fresh installations<a class=td-heading-self-link href=#fresh-installations aria-label="Heading self-link"></a></h3><p>The search feature is included in the <code>Extended</code> installation type. For <code>Standard</code> see the <a href=#existing-websites>Existing websites</a> section.</p><p>If you are installing a fresh YMCA Website Services website and going through the installation process via the web interface, on the third-party integration step, you can specify a Google Search ID. If you specify the Google Search ID in this form, your site&rsquo;s search feature will be up and running.</p><h3 id=existing-websites>Existing websites<a class=td-heading-self-link href=#existing-websites aria-label="Heading self-link"></a></h3><p>The search feature is not automatically enabled after upgrading a YMCA Website Services website. You have to manually enable it.</p><p>To do that:</p><ol><li>Log in as an admin (or a user with the <code>administrator</code> role).</li><li>Go to the YMCA Website Services package install page (Admin menu > YMCA Website Services > Extend > Install, or <code>/admin/openy/extend/list</code>)</li><li>Find the <code>Search</code> package there, tick the checkbox, and submit the form.</li></ol><p>Now, the search modules are enabled, and the website header should have a search field. Upon installation, the modules create a Landing page for search results and point the header search form to the page.</p><h2 id=configuring-the-google-search-modules>Configuring the Google Search modules<a class=td-heading-self-link href=#configuring-the-google-search-modules aria-label="Heading self-link"></a></h2><ol><li>Go to the Google Search settings form (Admin menu > YMCA Website Services > Settings > Google Search settings, or <code>/admin/openy/settings/google-search</code>).</li><li>Set the value of the <code>Google Search ID</code> field (see the following <a href=#obtaining-search-engine-id>section</a> for details) and submit the form.</li></ol><h3 id=obtaining-search-engine-id>Obtaining Search Engine ID<a class=td-heading-self-link href=#obtaining-search-engine-id aria-label="Heading self-link"></a></h3><ol><li>Go to
<a href=https://cse.google.com/ target=_blank>https://cse.google.com/</a>, register if you haven&rsquo;t yet, and log in if you aren&rsquo;t logged in.</li><li>Create the Search Engine (this process is explained in
<a href="https://support.google.com/programmable-search/answer/11082370?hl=en&amp;ref_topic=4513742&amp;sjid=719872083080201556-NC" target=_blank>Google&rsquo;s documentation</a>:<ol><li>Click &ldquo;New Search Engine&rdquo;.</li><li>Specify the domain of your website (e.g. <code>www.example.com</code>).</li><li>Specify the name of the Search Engine (e.g. <code>example.com</code>).</li><li>Click &ldquo;Create&rdquo;.</li></ol></li><li>On the newly created Search Engine page there is the <code>Search engine ID</code> field. Use this value in the YMCA Website Services Google Search configuration form.</li></ol><h2 id=configuring-the-search-engine-look-and-feel>Configuring the Search Engine look and feel<a class=td-heading-self-link href=#configuring-the-search-engine-look-and-feel aria-label="Heading self-link"></a></h2><ol><li>Go to the <code>Look and feel</code> section of the Search Engine</li><li>In the <code>Layout</code> tab, select the <code>Full width</code> option and click <code>Save</code></li></ol><p>If this change hasn&rsquo;t been made, the search results on the website are shown in a popup window.</p><h3 id=dealing-with-ads>Dealing with ads<a class=td-heading-self-link href=#dealing-with-ads aria-label="Heading self-link"></a></h3><p>By default, newly created Search engines use the Free Edition (with ads) of the service. As YMCAs are non-profit organizations they have the option to
<a href="https://support.google.com/programmable-search/answer/11082370?hl=en&amp;ref_topic=4513742&amp;sjid=719872083080201556-NC" target=_blank>switch to Non-profit Edition</a> of the CSE, where it is possible to disable ads.</p><p>If you are already registered as a Non-profit in Google:</p><ol><li>From the
<a href=https://cse.google.com target=_blank>CSE Control Panel</a>, select the search engine you want to change.</li><li>Click <strong>Overview</strong> then <strong>Ads</strong></li><li>Toggle the <strong>Show Ads</strong> option to off.</li></ol><h3 id=layout-builder-and-google-search>Layout Builder and Google Search<a class=td-heading-self-link href=#layout-builder-and-google-search aria-label="Heading self-link"></a></h3><p>The Google Custom Search Engine can also be used with
<a href=../../user-documentation/layout-builder>Layout Builder</a>:</p><ol><li>If you have an existing site, disable the old search page:<ul><li>Go to <code>/search</code>.</li><li>Remove the URL alias by unchecking <strong>Generate automatic URL alias</strong> in the sidebar then deleting <code>/search</code>.</li><li>Uncheck <strong>Published</strong> and <strong>Save</strong> to un-publish the page.</li></ul></li><li>Create a new <strong>Landing Page (Layout Builder)</strong> (<code>node/add/landing_page_lb</code>):<ul><li>Set the <strong>Title</strong> to &ldquo;Search&rdquo;.</li><li>Ensure <strong>Generate automatic URL alias</strong> is unchecked in the sidebar and set the alias to <code>/search</code>.<ul><li>If that alias results in an error, you can remove the old one at <strong>Admin</strong> > <strong>Configuration</strong> > <strong>Search and metadata</strong> > <strong>URL aliases</strong></li></ul></li><li>Check <strong>Published</strong> then <strong>Save and edit layout</strong>.</li></ul></li><li>Add a
<a href=../../user-documentation/layout-builder/banner>Small Banner</a> to the header with a title for the page, like &ldquo;Search&rdquo;.</li><li>Add the search results code to the page:<ul><li>In the <strong>Body</strong> section, <strong>Add block</strong> and choose <strong>Code Block</strong></li><li>In <strong>Code</strong>, add the embed code from the CSE configuration. You may need to add an outer div to fit your page layout, for example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;paragraph paragraph--type--google-search py-4&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>script</span> <span class=na>async</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cse.google.com/cse.js?cx=[id]&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gcse-search&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div></li><li><strong>Save layout</strong> and check your page</li></ul></li><li>Change the Google Search config to use your new page:<ul><li>Go to <strong>Admin</strong> > <strong>YMCA Website Services</strong> > <strong>Settings</strong> > <strong>Google Search settings</strong> (<code>/admin/openy/settings/google-search</code>) and set the <strong>Search page id</strong> to the node id of your new page.</li><li>Or, change the config with drush:<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>drush cset openy_google_search.settings search_page_id &lt;nid&gt;
</span></span></code></pre></div></li></ul></li><li>Test the search box in the Layout Builder page header to ensure the new configuration works as expected.</li></ol><h2 id=advanced-setup>Advanced setup<a class=td-heading-self-link href=#advanced-setup aria-label="Heading self-link"></a></h2><p>Google maintains documentation on
<a href="https://support.google.com/customsearch/topic/4542213?hl=en&amp;ref_topic=4513868" target=_blank>how to configure advanced search features</a></p><h3 id=mutli-site-search>Mutli-site search<a class=td-heading-self-link href=#mutli-site-search aria-label="Heading self-link"></a></h3><p>You can add multiple domains to the custom search engine if your association maintains multiple websites, for example, if your camps run at different website domains</p><p>You can also add not only the whole website but its parts by specifying patterns like <code>example.com/blog/*</code>. See
<a href="https://support.google.com/programmable-search/answer/12397162?hl=en&amp;ref_topic=4513742&amp;sjid=719872083080201556-NC" target=_blank>Update sites in your search engine</a> for details.</p><h3 id=refinements-and-facets>Refinements and facets<a class=td-heading-self-link href=#refinements-and-facets aria-label="Heading self-link"></a></h3><p><a href="https://support.google.com/programmable-search/answer/12425418?hl=en&amp;ref_topic=4542213&amp;sjid=719872083080201556-NC" target=_blank>Use Refinements to narrow the scope of search</a></p><p>Refinements let users filter results according to the categories you provide.</p><p>Refinements appear in the search results page as tabs. The content of each tab is configured in the Search features > Refinement section of the Custom Search Control panel.</p><p>To set up a dedicated tab in search results for Blog posts do the following:</p><ol><li>In the Control panel, go to <code>Search features</code> > <code>Refinements</code></li><li>Click <code>Add</code><ol><li>Set the name of the refinement to <code>Blog</code></li><li>Select <code>Search only the sites with this label</code> for <code>How to search sites with this label?</code></li><li>Click <code>Ok</code></li></ol></li><li>Go to <code>Setup</code></li><li>Find <code>Sites to search</code>, click <code>Add</code><ol><li>Add the <code>example.org/blog/*</code> in the text field</li><li>Select <code>Blog</code> in the Label dropdown</li><li>Select <code>Include just this specific page or URL pattern I have entered</code></li><li>Click <code>Save</code></li></ol></li></ol><p>The search results page now shows the <code>Blog</code> tab that only shows blog entries relevant to the search term.</p><h3 id=promotions>Promotions<a class=td-heading-self-link href=#promotions aria-label="Heading self-link"></a></h3><p><a href="https://support.google.com/programmable-search/answer/13280560?hl=en&amp;ref_topic=4542213&amp;sjid=719872083080201556-NC" target=_blank>Use Promotions to highlight a page in searches</a></p><h2 id=information-for-developers>Information for developers<a class=td-heading-self-link href=#information-for-developers aria-label="Heading self-link"></a></h2><p><a href=https://developers.google.com/custom-search/docs/overview target=_blank>Google Custom Search Developers documentation</a></p><h3 id=enabling-via-drush>Enabling via Drush<a class=td-heading-self-link href=#enabling-via-drush aria-label="Heading self-link"></a></h3><p>Use the following snippet to enable the package on existing websites:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>drush en openy_google_search
</span></span></code></pre></div><h3 id=configuring-the-module-via-drush>Configuring the module via Drush<a class=td-heading-self-link href=#configuring-the-module-via-drush aria-label="Heading self-link"></a></h3><p>Use the following snippet when you install YMCA Website Services via Drush to set the Search Engine ID:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>drush</span> <span class=n>site</span><span class=o>-</span><span class=n>install</span> <span class=n>openy</span> \
</span></span><span class=line><span class=cl>   <span class=o>--</span><span class=n>account</span><span class=o>-</span><span class=k>pass</span><span class=o>=</span><span class=n>password</span> \
</span></span><span class=line><span class=cl>   <span class=o>--</span><span class=n>db</span><span class=o>-</span><span class=n>url</span><span class=o>=</span><span class=s2>&#34;mysql://user:pass@host:3306/db&#34;</span> \
</span></span><span class=line><span class=cl>   <span class=o>--</span><span class=n>root</span><span class=o>=/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>docroot</span> \
</span></span><span class=line><span class=cl>   <span class=n>openy_configure_profile</span><span class=o>.</span><span class=n>preset</span><span class=o>=</span><span class=n>extended</span> \
</span></span><span class=line><span class=cl>   <span class=n>openy_theme_select</span><span class=o>.</span><span class=n>theme</span><span class=o>=</span><span class=n>openy_rose</span> \
</span></span><span class=line><span class=cl>   <span class=n>openy_third_party_services</span><span class=o>.</span><span class=n>google_search_engine_id</span><span class=o>=</span><span class=s2>&#34;01234567890123456789:abcedefgh&#34;</span>
</span></span></code></pre></div><p>The <code>openy_third_party_services.google_search_engine_id</code> parameter sets the Search Engine ID (<code>01234567890123456789:abcedefgh</code> in the example).</p><p>Use the following snippet to set the Search Engine ID on already installed websites:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>drush config-set openy_google_search.settings google_engine_id &#34;01234567890123456789:abcedefgh&#34;
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-80222643eee1c09fc10870b87cfa2b27>22 - GroupEx PRO quick start</h1><p>This document has been moved to
<a href=https://github.com/ynorth-projects/openy_pef_gxp_sync#readme target=_blank>ynorth-projects/openy_pef_gxp_sync</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b42f02de276f63b60282c5e601fb0b1f>23 - How to contribute large features (back-porting, etc)</h1><p>These are our best practices for back-porting large features into YMCA Website Services and contributing code for others to use.</p><h2 id=summary>Summary<a class=td-heading-self-link href=#summary aria-label="Heading self-link"></a></h2><ul><li>The YMCA Website Services core team is excited for you to contribute to the distribution for all to benefit from.</li><li>There&rsquo;s a lot that goes into back-porting your code &ndash; details below.</li><li>These steps ensure that we are collaborating while continuing to support YMCA Website Services in a sustainable way.</li></ul><p><em>Before getting started, please keep these notes in mind</em></p><ul><li>Back-porting requires a process called decoupling. This is where your developers remove any hard-coded variables or dependencies on any integration from your website code. This makes it so the feature you wish to contribute can work for anyone the broader Y movement. Meaning, <em>as an example</em> , anything that ties into Personify APIs will have to have those hooks replaced with Program Event Framework so that it could function with any CRM source that an YMCA Website Services site might be using.</li><li>This decoupled code will then need to be thoroughly tested to ensure it can function when not relying on any fee-based, or non-secure, technology or systems .</li><li>Once the decoupling is complete, the YMCA Website Services core team will need to review every line of code that goes before it goes into the distribution . This helps us ensure it won&rsquo;t break any of the other elements of YMCA Website Services, and that the code is 100% secure. As of 2019 we have 3 templates in YMCA Website Services that work across mobile, desktop and tablet breakpoints . We need to test new features/code across all these templates to make sure nothing breaks across hundreds of possible use-case scenarios ( <em>example</em> : adding a schedule block to a location landing page using the Carnation template when on the mobile breakpoint that is powered by ActiveNet through Program Event Framework&mldr;)</li><li>Once a feature is in YMCA Website Services, someone must pay to maintain that code . Does this code rely on any other Drupal modules to function? What if there&rsquo;s an update to that module? That update needs to be tested to ensure it&rsquo;s compatible with the now contributed code &ndash; and if it breaks, we have to write new code to fix it. What if there&rsquo;s a security patch that involves the contributed code? We would then have to spend time applying the patch, etc.</li><li>Is your customization a new feature or a replacement of existing YMCA Website Services functionality/UX? We prefer you have A/B testing data demonstrating that your customization is a clear improvement over the current YMCA Website Services experience. There are many ways to run AB tests so please consult with the YMCA Website Services team on your hypothesis, method, and success criteria to ensure that the results are valid and reliable.</li></ul><p><em>Steps/process for back-porting code into YMCA Website Services</em></p><blockquote><p>Most problems have at least a generic component and can be approached in part through abstracted development.</p></blockquote><p>We recommend beginning development with an eye toward
<a href=https://guidebook.civicactions.com/en/latest/practice-areas/engineering/drupal/most-important-decision-in-developing-a-drupal-site-contributed-vs-custom-development/ target=_blank>these &ldquo;abstracted&rdquo; solutions</a> - providing configuration instead of static templates, solving root causes instead of using local patches, using generic language instead of client specific. This will ensure that your features are easily contributed even before you begin this process.</p><ol><li>List each customization/feature you want to contribute to YMCA Website Services</li></ol><ul><li>It&rsquo;s plausible that there are portions of your code that it might not make sense to put into the distribution, either because it&rsquo;s duplicative to what YMCA Website Services already has, or it might be cost prohibitive to decouple it from your site for back-porting.</li><li>In the early days of YMCA Website Services, we were less stringent on this step. As long as there was no security or technical risk we accepted any contribution into YMCA Website Services. This led to some problems such as having two nearly identical paragraph types called Blog Post and News Post. These were contributed by two different associations. This caused significant confusion until we resolved the issue with the launch YMCA Website Services 2.0 where we deprecated some of this functionality.</li><li>You can start this process by taking an inventory of all your customizations that you feel would be good to backport into the distribution.</li><li>The end deliverable of this step is a list of each independent feature you think it makes sense to contribute.</li></ul><ol start=2><li>Your Prioritization</li></ol><ul><li>Rather than taking a &lsquo;big bang&rsquo; approach of decoupling and back-porting all your features into YMCA Website Services, it is a better practice to take a bite-size approach, doing one feature at a time . This is because it can be cost and time intensive and expensive to decouple and backport your code into the distribution if you do it all at once.</li><li>As a guide, YMCA Website Services uses the following prioritization method: Demand for feature (1 to 3 with 1 being high), Impact/Benefit to Ys and visitors (1 to 3 with 1 being high), Effort to build/maintain (1 to 5 with 1 being extra low and 5 being extra high). The sum of these gives us a &lsquo;score&rsquo; for each feature which helps us prioritize.</li><li>This will also help you decide how much, or little, of your back-porting you want to fund as you&rsquo;ll be able to get a clear feature-by-feature time estimate for the work required.</li><li>The end deliverable will be a prioritized list of the features that you want to contribute.</li></ul><ol start=3><li>Share your prioritized list with YMCA Website Services, and align roadmaps before spending money and time on decoupling</li></ol><ul><li>There might be things the YMCA Website Services core team is already working on that are similar and would be finished before your decoupling would be complete, thus it would not be the best use of your funds to decouple/backport that feature</li><li>There may be information the YMCA Website Services team has based on talks with other Ys that influence your demand/impact scores and thus your prioritization</li><li>We might have technical knowledge that influences your effort scores as well</li><li><em>This is when timelines will start to emerge on when your code would be available in the distribution.</em></li></ul><ol start=4><li>Decoupling</li></ol><ul><li>Your developers and the YMCA Website Services team should align on best practices for code. At a high level, our best practices can be reviewed here:
<a href=../development-faq>Development FAQ</a> and
<a href=../how-we-release-openy-distribution-from-code-perspective>How we release code</a></li><li>When you are ready to begin the decoupling work let us know and we can either talk to you here, on Slack, or even set up a conference call if it would be helpful for you.</li><li>You would then start the technical/dev work of decoupling the features you wish to contribute back into YMCA Website Services</li><li>You would test all of your decoupled code to ensure that these features work when no longer reliant on any paid or non-secure technology or partners</li><li>Deliverable from this step is code that works in a your own dev environment independent of any other Y association specific code/technology</li></ul><ol start=5><li>Contributing your code: Pull Requests (PRs)</li></ol><ul><li>Code gets submitted to YMCA Website Services for review via a process called a Pull Request</li><li>The YMCA Website Services lead technical architect sees the code, runs it through automated test cases, and provides feedback on any issues detected that may cause problems for other portions of YMCA Website Services code</li><li>Sometimes the feedback from the YMCA Website Services lead technical architect requires re-work from the original developer making the PR before the code is accepted into the distribution</li></ul><ol start=6><li>Release</li></ol><ul><li>The features contributed from you get scheduled into one of the YMCA Website Services quarterly releases, and we make sure you get ample credit for your contribution.</li><li>The movement then benefits from your contribution!</li></ul><ol start=7><li>Ongoing improvements, maintenance, etc.</li></ol><ul><li>Over time, you might want to make enhancements to your site due to analytics, or other data inputs from customers and team-members</li><li>It would be great if you made those same enhancements to the now-decoupled version of your code that exists in YMCA Website Services if you feel it makes sense</li><li>If you identify any bugs or issues over time on your site that involve code that was contributed to YMCA Website Services, it would be awesome if you fixed that code and contributed the fix via a Pull request (step 5 above)</li></ul><p>To be clear, all of the above is only required if you want to get your code into the core YMCA Website Services distribution. You could always take your code as is, ensure any PII or secure information is scrubbed, and post it to your own GitHub repository &ndash; however it would be difficult for others to use this code as is if it hasn&rsquo;t at least been decoupled. If you take this approach please be sure to remove references to OpenY from the code so that the GitHub search engine does not confuse it with core YMCA Website Services. Further, please review the YMCA Website Services license agreement to make sure you are in alignment with GPL and Open Source sharing best practices.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-08b6528e0a5921b4742caeb5a3590d80>24 - How to develop themes in YMCA Website Services</h1><h1 id=working-with-themes>Working with Themes<a class=td-heading-self-link href=#working-with-themes aria-label="Heading self-link"></a></h1><p>Each YMCA Website Services theme was developed independently, either by the YMCA Website Services Core Team or by a partner for one specific Y and then contributed back. You can see demos of each theme on the
<a href=/docs/development/sandboxes/>Sandboxes</a>.</p><p>Each theme has its own dependencies and build processes. Please read the steps in each <code>README</code> for details.</p><h2 id=inventory-of-themes>Inventory of themes<a class=td-heading-self-link href=#inventory-of-themes aria-label="Heading self-link"></a></h2><p>As of December 2021, themes
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/2595 target=_blank>have been decoupled</a> from the YMCA Website Services profile to independent projects on Drupal.org.</p><h3 id=carnation>Carnation<a class=td-heading-self-link href=#carnation aria-label="Heading self-link"></a></h3><ul><li><a href=https://www.drupal.org/project/openy_carnation target=_blank>openy_carnation project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_carnation target=_blank>README</a> for getting started with development</li></ul><h3 id=lily>Lily<a class=td-heading-self-link href=#lily aria-label="Heading self-link"></a></h3><ul><li><a href=https://www.drupal.org/project/openy_lily target=_blank>openy_lily project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_lily target=_blank>README</a> for getting started with development</li></ul><h3 id=rose>Rose<a class=td-heading-self-link href=#rose aria-label="Heading self-link"></a></h3><ul><li><a href=https://www.drupal.org/project/openy_rose target=_blank>openy_rose project</a> on Drupal.org</li><li><a href=https://git.drupalcode.org/project/openy_rose target=_blank>README</a> for getting started with development</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-0370c16bd6bdb61a50279a5d0c3f59b2>25 - Important versions for upgrade path</h1><p>YMCA Website Services development moves quickly and in this document, we flag important versions that should not be skipped while you upgrade your sites.</p><h2 id=determining-your-upgrade-path>Determining your upgrade path<a class=td-heading-self-link href=#determining-your-upgrade-path aria-label="Heading self-link"></a></h2><p>For example: If you are on YMCA Website Services 8.1.2 and want to upgrade to YMCA Website Services 8.2.8.5 you should make it in a couple of steps</p><ol><li>Upgrade 8.1.2 to 8.1.13.1</li><li>Upgrade 8.1.13.1 to 8.2.2.1</li><li>Upgrade 8.2.2.1 to 8.2.7.3</li><li>Upgrade 8.2.7.3 &mldr;</li></ol><p>These supplemental documents elaborate on a few specific cases:</p><ul><li><a href=/docs/development/openy-upgrade-for-developers.-upgrade-to-old-openy-1.x-version/>Upgrade from YMCA Website Services &lt;8.1.3</a></li><li><a href=/docs/development/upgrade-openy-8.1.3-to-8.2.2.1/>Upgrade from 8.1.3 to 8.2.2.1</a></li><li><a href=/docs/development/upgrade-use-case-from-8.2.2.3-to-8.2.7.3/>Upgrade from 8.2.2.3 to 8.2.7.3</a></li></ul><h3 id=important-versions>Important versions<a class=td-heading-self-link href=#important-versions aria-label="Heading self-link"></a></h3><ul><li><p><code>8.1.13.1</code> - Optional, when you have a lot of customized code and 8.2.2.1 is failing in most places.</p></li><li><p><code>8.2.2.1</code> - This is a very important step everyone should have. After this version, <code>drush entup</code> stops working. In this version, we finally migrated to the core media subsystem, and before going further it is important to upgrade media by upgrading your site to this version first.</p></li><li><p><strong><code>8.2.7.3</code></strong> - This is a very stable Drupal 8 based YMCA Website Services with a bunch of contrib module updates. This is one of the last Drupal 8 based YMCA Website Services versions before the upgrade to Drupal 9 core. Also, in 8.2.7.0 and 8.2.7.1 we started to introduce multiple version constraints in <code>composer.json</code> to allow developers to choose between the minimum or latest dependency versions. This is for securing the upgrade path as well as adding flexibility for version selection if needed.</p></li><li><p><code>9.2.8.0</code> - Drupal 9 version which must be used in the upgrade path before going to 9.2.8.1+. This version added 9.0-9.1 Drupal Core and disabled deprecated components.</p></li><li><p><code>9.2.10.0</code> - Removed a bunch of unused modules from distribution.</p></li><li><p><strong><code>9.2.11.3</code></strong> - Last Open Y Drupal core 9.3.* release</p></li><li><p><code>9.2.11.4</code> - Technical release of YMCA Website Services ( no diff with 9.2.11.3 )</p></li><li><p><strong><code>9.2.13.0</code></strong> - Pre Drupal 10 release, latest Drupal 9 release. Before going into Layout Builder era it is recommended to uninstall <code>geysir</code>, <code>openy_inline_editing</code>, <code>quickedit</code>, <code>rdf</code> modules.</p></li><li><p><code>10.2.14</code> - Drupal 10|9 release, where you may follow the recommendations below:</p><ol><li>Upgrade to the latest Drupal 9 core (using
<a href=https://github.com/YCloudYUSA/yusaopeny/releases/tag/10.2.14 target=_blank>version 10.2.14</a> of the distribution, released in June 2023).</li><li>Upgrade all contrib modules and libraries to their latest Drupal 9-compatible versions (with <code>composer update</code>).</li><li>Use
<a href=https://github.com/palantirnet/drupal-rector target=_blank>drupal-rector</a>,
<a href=https://github.com/mglaman/drupal-check target=_blank>drupal-check</a>, and PHPCS to prepare custom modules and themes for Drupal 10.</li><li>Upgrade to Drupal 10 and run regression testing to search for hard-to-find bugs (update <code>drupal/core-*</code> projects in composer.json, then run <code>compuser update</code>).</li><li>Upgrade all contrib modules on the Drupal 10 site to their latest versions (<code>composer update</code>).</li></ol></li><li><p><code>10.3.0.1</code> - Drupal 10|9 release, before New Demo Content and Initial Replacement Paragraphs to Blocks for Native Layout Builder Experience</p></li><li><p><strong><code>10.3.1</code></strong> - Drupal 10|9 release, New Demo Content and Initial Replacement Paragraphs to Blocks for Native Layout Builder Experience. In this release we bumped a lot of dependencies to become up to date</p></li><li><p>10.3.2 - Introduced
<a href=https://www.drupal.org/project/ws_event/issues/3409162 target=_blank>recurring event support in the Event Content Type</a> which requires an automated migration between <code>date_range</code> and <code>smart_date</code> fields. If possible, update to this version during the upgrade process.</p></li><li><p>10.3.2.3 - Introduced before 10.1 and 10.2 Drupal core. Also upgraded openy_map.This version ensures we support removed modules pre 10.1 for contrib modules</p></li></ul><p>See
<a href=/docs/development/composer-version-constraints-for-open-y/>Version Constraints practices for YMCA Website Services</a></p><h2 id=known-issues>Known issues<a class=td-heading-self-link href=#known-issues aria-label="Heading self-link"></a></h2><p>If you are faced with an issue when <code>composer</code> installs an improper version of <code>drupal/core</code> for the chosen version of YMCA Website Services from the list above, please use this trick in order to downgrade:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer require drupal/core-recommended:9.5.9
</span></span></code></pre></div><p>Run the above command where your <code>docroot</code> is. Use the current core version instead of <code>9.5.9</code>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-17567d6693fe9a00b0a5bf3af2788b5a>26 - Install Solr site search</h1><p>YMCA Website Services leverages
<a href=https://solr.apache.org/ target=_blank>Apache Solr</a> for a few features:</p><ul><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder/wiki target=_blank>Activity Finder</a> requires Solr</li><li>Site search can <em>optionally</em> use Solr as per
<a href=https://github.com/ymcatwincities/openy/pull/1967 target=_blank>this Pull Request</a></li></ul><h2 id=quick-start--upgrade-path>Quick Start / Upgrade path<a class=td-heading-self-link href=#quick-start--upgrade-path aria-label="Heading self-link"></a></h2><ul><li><p>Log in as admin.</p></li><li><p>Go to <code>admin/modules</code> and enable the YMCA Website Services Search API module.</p><p><img src=https://user-images.githubusercontent.com/563412/142628630-b412aa4b-8f2b-42f6-ba06-c5bb6a78469c.png alt=image></p></li><li><p>Approve the next step for enabling Database Search.</p><p><img src=https://user-images.githubusercontent.com/563412/142628735-6aa409bd-5ff5-4305-a0f0-7f6bc96d0740.png alt=image></p></li><li><p>Go to the Search API configuration page <code>admin/config/search/search-api</code>.</p></li><li><p>Verify that the &ldquo;OpenY Database Search&rdquo; server is enabled.</p></li><li><p>Visit &ldquo;Search content&rdquo; index.</p><p><img src=https://user-images.githubusercontent.com/563412/142629065-e13c8bb4-cad8-436f-93c6-30fa6ac6fdf7.png alt=image></p></li></ul><blockquote><p>TIP: Admins can enable and the Solr search and switch the index between servers.</p></blockquote><ul><li><p>Index content by clicking &ldquo;Index now&rdquo;.</p><p><img src=https://user-images.githubusercontent.com/563412/142629227-8607eeca-4022-47c4-b5fd-6e38ccfb7bab.png alt=image></p></li><li><p>Go to the homepage and search for any keyword.</p><p><img src=https://user-images.githubusercontent.com/563412/142629467-e275b536-2505-4ddf-8d78-7c6f4ae0e716.png alt=image></p></li><li><p>Verify search results are displayed correctly.</p></li></ul><h2 id=starting-from-the-ymca-website-services-installer>Starting from the YMCA Website Services installer<a class=td-heading-self-link href=#starting-from-the-ymca-website-services-installer aria-label="Heading self-link"></a></h2><ul><li>Find the <code>Select search service</code> step displayed during the YMCA Website Services installation.</li><li>Choose from one of these options during installation:<ul><li><strong>None</strong><ul><li>Nothing happens if the user chooses this option, search modules are displayed after installation.</li></ul></li><li><strong>YMCA Website Services Google Custom Search</strong><ul><li>Google Custom Search configuration form is displayed if the user chooses this option.</li><li>The YMCA Website Services Google Search module is enabled after installation and ready to use.</li></ul></li><li><strong>YMCA Website Services Search API</strong><ul><li>Search API backend options are displayed in this case with the following options:<ul><li><em>Database</em><ul><li>The YMCA Website Services Search API module is enabled after installation. The database search API server is enabled. The search is ready to use after content indexation.</li></ul></li><li><em>Solr</em><ul><li>Additional installation step with Solr configuration form is displayed in this case and user can specify all params for Solr connection. The YMCA Website Services Search API module is enabled after installation, Solr search API server is enabled. The search is ready to use after content indexing (if the correct Solr settings were used).</li></ul></li></ul></li></ul></li></ul></li></ul><h2 id=switch-from-database-search-backend-to-solr-backend>Switch from database search backend to Solr backend<a class=td-heading-self-link href=#switch-from-database-search-backend-to-solr-backend aria-label="Heading self-link"></a></h2><p>Watch a
<a href=https://youtu.be/-Sq3uZb5K_U target=_blank>video tutorial</a> on how to switch an existing site from the database backend to a Solr server. This requires a Solr server to be configured in your environment.</p><ul><li>Edit the &ldquo;Solr search&rdquo; server from the Search API configuration <code>admin/config/search/search-api</code>.</li><li>Add the configuration information for your Solr server. Refer to Drupal&rsquo;s
<a href=https://www.drupal.org/project/search_api_solr target=_blank>Search API Solr project</a> for troubleshooting connection information.</li><li>Save the server and observe that Search API has successfully connected to your server.</li><li>Edit the &ldquo;Search content&rdquo; index and change the &ldquo;Server&rdquo; field to the newly configured &ldquo;Solr Search&rdquo; index.</li><li>Visit the &ldquo;Search content&rdquo; index and click &ldquo;Index now&rdquo; to re-index the content.</li></ul><h2 id=layout-builder-and-solr-search>Layout Builder and Solr search<a class=td-heading-self-link href=#layout-builder-and-solr-search aria-label="Heading self-link"></a></h2><p>Solr search can be used with
<a href=../../user-documentation/layout-builder>Layout Builder</a>, and requires a few extra steps.</p><h3 id=configure-solr-to-index-the-new-content-types>Configure Solr to index the new content types<a class=td-heading-self-link href=#configure-solr-to-index-the-new-content-types aria-label="Heading self-link"></a></h3><p>In order for Solr to index the new content types, they need to be added to the index.</p><ol><li>Enable the YMCA Website Services Search API (<code>openy_search_api</code>) module if not already enabled.</li><li>Go to <strong>Admin</strong> > <strong>Configuration</strong> > <strong>Search and metadata</strong> > <strong>Search API</strong>, then <strong>Edit</strong> the <strong>Search content</strong> index. (<code>/admin/config/search/search-api/index/search_content/edit</code>)</li><li>Configure Solr to index the Layout Builder content types:<ul><li>Scroll down, expand <strong>Configure the <em>Content</em> datasource</strong>, and check the content types that should be indexed for search.<figure class=image-caption><a href=/docs/development/install-solr-site-search-for-open-y/solr--choose-content-types.png title="View original image"><img alt="&ldquo;Configure the content datasource&rdquo; options" srcset="/docs/development/install-solr-site-search-for-open-y/solr--choose-content-types_hu5745243590710534565.png 458w,
/docs/development/install-solr-site-search-for-open-y/solr--choose-content-types_hu2712724585230971879.png 726w,
/docs/development/install-solr-site-search-for-open-y/solr--choose-content-types_hu1646455992505109331.png 1200w" sizes=50vw src=/docs/development/install-solr-site-search-for-open-y/solr--choose-content-types_hu5745243590710534565.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></li><li>Save the form.</li></ul></li><li>Configure how Solr indexes the Layout Builder content types:<ul><li>From the <strong>Search API</strong> configuration, open the dropdown for the <strong>Search content</strong> index and choose <strong>Fields</strong>.<figure class=image-caption><a href=/docs/development/install-solr-site-search-for-open-y/solr--edit-fields.png title="View original image"><img alt="The &ldquo;fields&rdquo; option in the options dropdown of the Search API configuration" srcset="/docs/development/install-solr-site-search-for-open-y/solr--edit-fields_hu18383519323759116880.png 458w,
/docs/development/install-solr-site-search-for-open-y/solr--edit-fields_hu10173764027521777783.png 726w,
/docs/development/install-solr-site-search-for-open-y/solr--edit-fields_hu5640242121830256003.png 1200w" sizes=50vw src=/docs/development/install-solr-site-search-for-open-y/solr--edit-fields_hu18383519323759116880.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure></li><li>To the right of the <strong>Rendered HTML output</strong> field options, choose <strong>Edit</strong>.</li><li>For each newly added content type, switch &ldquo;Don&rsquo;t include the rendered item&rdquo; to the right view mode.<figure class=image-caption><a href=/docs/development/install-solr-site-search-for-open-y/solr--view-modes.png title="View original image"><img alt="Choose the view mode for each content type." srcset="/docs/development/install-solr-site-search-for-open-y/solr--view-modes_hu11083845509540880345.png 458w,
/docs/development/install-solr-site-search-for-open-y/solr--view-modes_hu3549067583671810454.png 726w,
/docs/development/install-solr-site-search-for-open-y/solr--view-modes_hu15139029952722777456.png 1200w" sizes=50vw src=/docs/development/install-solr-site-search-for-open-y/solr--view-modes_hu11083845509540880345.png><figcaption><i class="fa-solid fa-external-link fa-fw"></i></figcaption></a></figure><ul><li><p>In general, new Layout Builder specific content types will use the &ldquo;Default&rdquo; view mode, while older Layout Builder-compatible content types should use the &ldquo;Full content&rdquo; view mode.</p><table><thead><tr><th>Content type</th><th>View mode</th></tr></thead><tbody><tr><td>Article (LB)</td><td>Default</td></tr><tr><td>Branch</td><td>Full</td></tr><tr><td>Event (LB)</td><td>Default</td></tr><tr><td>Camp</td><td>Full</td></tr><tr><td>Camp Subpage</td><td>Full</td></tr><tr><td>Facility</td><td>Full</td></tr><tr><td>Landing Page (LB)</td><td>Default</td></tr><tr><td>Program</td><td>Full</td></tr><tr><td>Program Subcategory</td><td>Full</td></tr></tbody></table></li><li><p>Save the page.</p></li></ul></li></ul></li><li>Once your changes have been saved, re-index the content to see the changes reflected in search results.</li></ol><h3 id=set-up-a-layout-builder-search-page>Set up a Layout Builder search page<a class=td-heading-self-link href=#set-up-a-layout-builder-search-page aria-label="Heading self-link"></a></h3><ol><li>If you have an existing site, disable the old search page:<ul><li>Go to <code>/search</code>.</li><li>Remove the URL alias by unchecking <strong>Generate automatic URL alias</strong> in the sidebar then deleting <code>/search</code>.</li><li>Uncheck <strong>Published</strong> and <strong>Save</strong> to un-publish the page.</li></ul></li><li>Create a new <strong>Landing Page (Layout Builder)</strong> (<code>node/add/landing_page_lb</code>):<ul><li>Set the <strong>Title</strong> to &ldquo;Search&rdquo;.</li><li>Ensure <strong>Generate automatic URL alias</strong> is unchecked in the sidebar and set the alias to <code>/search</code>.<ul><li>If that alias results in an error, you can remove the old one at <strong>Admin</strong> > <strong>Configuration</strong> > <strong>Search and metadata</strong> > <strong>URL aliases</strong></li></ul></li><li>Check <strong>Published</strong> then <strong>Save and edit layout</strong>.</li></ul></li><li>Add a
<a href=../../user-documentation/layout-builder/banner>Small Banner</a> to the header with a title for the page, like &ldquo;Search&rdquo;.</li><li>Add the search results block to the page:<ul><li>In the <strong>Body</strong> section, <strong>Add block</strong>, then expand <strong>All system block</strong> and choose <strong>Content search block</strong> from the Paragraph Blocks section.</li><li>Optionally, choose to hide the title or change the number of items to display.</li><li><strong>Save layout</strong> and check your page.</li></ul></li><li>Change the Search API config to use your new page:<ul><li>Go to <strong>Admin</strong> > <strong>YMCA Website Services</strong> > <strong>Settings</strong> > <strong>Search API settings</strong> (<code>/admin/openy/settings/search-api</code>) and set the <strong>Search page id</strong> to the node id of your new page.</li><li>Or, change the config with drush:<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>drush cset openy_search_api.settings search_page_id &lt;nid&gt;
</span></span></code></pre></div></li></ul></li><li>Test the search box in the Layout Builder page header to ensure the new configuration works as expected.</li></ol><h2 id=legacy-solr-support>Legacy Solr Support<a class=td-heading-self-link href=#legacy-solr-support aria-label="Heading self-link"></a></h2><p>The contrib
<a href=https://www.drupal.org/project/search_api_solr target=_blank>Search API Solr</a> module supports a broad swath of Solr versions, but occasionally old versions are dropped from support in the main module. If, when enabling YMCA Website Services Search API, you encounter errors that your version of Solr is out of date, you may need to enable the
<a href=https://git.drupalcode.org/project/search_api_solr/-/blob/4.x/modules/search_api_solr_legacy/README.md target=_blank>Search API Solr Legacy module</a>. As of January 2022, Search API Solr Legacy supports Solr 3.6 through 6.4.</p><p>The error message when using an old version of Solr may look something like this:</p><blockquote><p>Notice: Undefined index: 4.x in Drupal\search_api_solr\Controller\SolrConfigSetController->getConfigFiles()</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-f0f2cd2b401cae86c91fe6759f168e26>27 - Install SSL certificate</h1><h2 id=web-security-and-ymca-website-services>Web Security and YMCA Website Services<a class=td-heading-self-link href=#web-security-and-ymca-website-services aria-label="Heading self-link"></a></h2><p>As many parties have moved to
<a href=https://www.eff.org/encrypt-the-web target=_blank>Encrypt the Web</a>, <code>https</code> sites and SSL certificates have shifted from &ldquo;nice to have&rdquo; to necessities.</p><p>If you&rsquo;re running YMCA Website Services on a managed platform you most likely have SSL already configured. If you choose to manage YMCA Website Services on your own, you&rsquo;ll have to install a certificate.</p><p><a href=https://letsencrypt.org/ target=_blank>Let&rsquo;s Encrypt</a> is &ldquo;a free, automated, and open certificate authority (CA), run for the public’s benefit. It is a service provided by the
<a href=https://www.abetterinternet.org/ target=_blank>Internet Security Research Group (ISRG)</a>.&rdquo;
<a href=https://certbot.eff.org/ target=_blank>Certbot</a> is &ldquo;a free, open source software tool for automatically using Let’s Encrypt certificates on manually-administrated websites to enable HTTPS.&rdquo;</p><p>Certbot maintains detailed documentation for installing SSL certificates on a variety of systems. Simply
<a href=https://certbot.eff.org/instructions target=_blank>visit Certbot&rsquo;s instructions wizard</a> and follow the instructions to configure your server.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-febf06c2a321ab3f2bd52b94caddd713>28 - Installation With Drush</h1><p>Use
<a href=https://drushcommands.com/drush-8x/core/site-install/ target=_blank>drush site-install</a> command.</p><p>Basically you use something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>drush</span> <span class=n>site</span><span class=o>-</span><span class=n>install</span> <span class=n>openy</span> <span class=o>--</span><span class=n>account</span><span class=o>-</span><span class=k>pass</span><span class=o>=</span><span class=n>password</span> <span class=o>--</span><span class=n>db</span><span class=o>-</span><span class=n>url</span><span class=o>=</span><span class=s2>&#34;mysql://user:pass@host:3306/db&#34;</span> <span class=o>--</span><span class=n>root</span><span class=o>=/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>docroot</span>
</span></span></code></pre></div><p>Complete YMCA Website Services profile preset and YMCA Website Services Rose theme is used in this case.</p><p>You can set which preset must be installed by specifying it with <code>openy_configure_profile.preset</code> variable, and theme with
<code>openy_theme_select.theme</code>variable e.g.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>drush</span> <span class=n>site</span><span class=o>-</span><span class=n>install</span> <span class=n>openy</span> <span class=o>--</span><span class=n>account</span><span class=o>-</span><span class=k>pass</span><span class=o>=</span><span class=n>password</span> <span class=o>--</span><span class=n>db</span><span class=o>-</span><span class=n>url</span><span class=o>=</span><span class=s2>&#34;mysql://user:pass@host:3306/db&#34;</span> <span class=o>--</span><span class=n>root</span><span class=o>=/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>docroot</span> <span class=n>openy_configure_profile</span><span class=o>.</span><span class=n>preset</span><span class=o>=</span><span class=n>extended</span> <span class=n>openy_theme_select</span><span class=o>.</span><span class=n>theme</span><span class=o>=</span><span class=n>openy_rose</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b3449da639923af81005cfe31af51cac>29 - Module Development</h1><h2 id=module-content-removal>Module content removal<a class=td-heading-self-link href=#module-content-removal aria-label="Heading self-link"></a></h2><p>When deleting an entity, where plugins or services of removing module are used,
then content removal should be done in the hook_uninstall() of that module.
See openy_prgf_camp_menu.install as example.</p><h2 id=creating-a-new-module>Creating a new module<a class=td-heading-self-link href=#creating-a-new-module aria-label="Heading self-link"></a></h2><p>When creating a module on Drupal.org, be sure to check the following:</p><ol><li>Add all current maintainers.</li><li>Edit and add this module template:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>table</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;views-view-grid&#34;</span> <span class=na>bgcolor</span><span class=o>=</span><span class=s>&#34;#d4efcc&#34;</span><span class=p>&gt;&lt;</span><span class=nt>tr</span><span class=p>&gt;&lt;</span><span class=nt>td</span><span class=p>&gt;&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>🇺🇦<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;&lt;</span><span class=nt>td</span><span class=p>&gt;</span>This module is maintained by Ukrainian developers. Please consider <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://supportukrainenow.org&#34;</span><span class=p>&gt;</span>supporting Ukraine<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> in a fight for their freedom and the safety of Europe.<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;&lt;/</span><span class=nt>tr</span><span class=p>&gt;&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Edit this section with a short intro to the module --&gt;</span>
</span></span><span class=line><span class=cl>This component/module allows you to ... when using the <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://github.com/YCloudYUSA/y_lb&#34;</span><span class=p>&gt;</span>YMCA Layout Builder<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> package.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Leave this section as is --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;</span>Read our <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://github.com/YCloudYUSA/yusaopeny#installation&#34;</span><span class=p>&gt;</span>instructions for getting started<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>.<span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://ds-docs.y.org/docs/&#34;</span><span class=p>&gt;</span>Search our documentation<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> for assistance.<span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://ds-docs.y.org/community/&#34;</span><span class=p>&gt;</span>Review our Community Resources<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> for more information.<span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h3</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;project-requirements&#34;</span><span class=p>&gt;</span>Requirements<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This project is meant to be used with the <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://www.drupal.org/project/openy&#34;</span><span class=p>&gt;</span>YMCA&#39;s Website Service distribution<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>.
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-1300e8e5aebb2d73df94f2f6c04962af>30 - one-click install how-to</h1><p>This walk-through is outdated and is in the process of being updated. Instead, try:</p><ul><li>A
<a href="https://www.youtube.com/watch?v=nGyMJCwMsqM" target=_blank>video walk-through of installing YMCA Website Services for tech novices</a></li><li>An overview of the
<a href=/docs/development/sandboxes/>YMCA Website Services Sandboxes</a></li></ul><h3 id=installing-ymca-website-services-on-digitalocean-droplet>Installing YMCA Website Services on DigitalOcean droplet<a class=td-heading-self-link href=#installing-ymca-website-services-on-digitalocean-droplet aria-label="Heading self-link"></a></h3><ol><li>Create Ubuntu 16.04 LTS x64 droplet in area close to your location
<img src=https://user-images.githubusercontent.com/563412/44273919-6ffd8c80-a249-11e8-958b-3d7fbee6108d.png alt=image></li></ol><p>Use 2Gb droplet or more powerful if you need. Do not use 1Gb option - YMCA Website Services will fail on it.</p><ol start=2><li>Login to the SSH console of the droplet</li><li>Follow the comment from
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/openyonclickinstall.sh target=_blank>https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/openyonclickinstall.sh</a>
Basically - run a command under root</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -Ls http://bit.ly/initopeny <span class=p>|</span> bash -s
</span></span></code></pre></div><p>The command above will run approximately 10 minutes.
4. In the end you should see a message similar to</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Open http://127.0.0.1/core/install.php to proceed with OpenY installation.
</span></span></code></pre></div><ol start=5><li>Open the link from the above message(from your console, not from this document) with your browser and proceed with YMCA Website Services installation.</li></ol><p>Enjoy.</p><hr><p>In order to install the latest beta release of YMCA Website Services 2.0 change the command on step 3:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -Ls http://bit.ly/initopeny <span class=p>|</span> bash -s beta
</span></span></code></pre></div><hr><p>If you find any issues please post a message to the issue queue
<a href=https://github.com/YCloudYUSA/yusaopeny/issues target=_blank>https://github.com/YCloudYUSA/yusaopeny/issues</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-81195635ad423ad343082fdc4ecab652>31 - Open Y analytics sunset</h1><h2 id=preamble>Preamble<a class=td-heading-self-link href=#preamble aria-label="Heading self-link"></a></h2><p>Back on 28 Jan 2020 Open Y decided to add an anonymous analytics module
<a href=https://github.com/YCloudYUSA/yusaopeny/tree/9.x-2.x/modules/custom/openy_analytics target=_blank><code>openy_analytics</code></a> which was a free opt-in/opt-out solution for the Core team to gather stats from Open Y sites about the frequency of components used.</p><p>The idea behind this was to gather data in order to understand the demand for the components in Open Y and use the data to make better decisions.</p><p>Recently, the Open Y Core Team decided to sunset this functionality and remove <code>openy_analytics</code> as well as <code>openy_update</code> modules from the Open Y Distribution, as this feature was rarely used. By sunsetting this functionality, we reduced server load from Open Y instances and archive the analytics server.</p><h2 id=how-to-opt-out-from-analytics-subsystem>How to opt-out from analytics subsystem<a class=td-heading-self-link href=#how-to-opt-out-from-analytics-subsystem aria-label="Heading self-link"></a></h2><p>Visit YMCA Website Services -> Terms and Conditions in your YMCA Website Services site instance and uncheck the Optional Permissions checkbox</p><p><img src=https://user-images.githubusercontent.com/563412/130236284-5979a4fe-289c-4ccc-9c18-059d17d143e8.png alt=image></p><p>After submitting this form your site will stop sending anonymous data.</p><p>If the checkbox was not enabled just disregard it, you didn&rsquo;t opt-in earlier.</p><h2 id=deprecation-action>Deprecation action<a class=td-heading-self-link href=#deprecation-action aria-label="Heading self-link"></a></h2><p>Uninstall and deprecation was done in
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/2537 target=_blank>#2537</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-a97c11c973243b9fd7fa8284b4f9070b>32 - Participant Agreement</h1><p><strong>YMCA Website Services PARTICIPATION AGREEMENT</strong></p><p>This YMCA Website Services Participation Agreement (this “<strong>Agreement</strong>”) is between YUSA, and participating YMCA member associations in the United States (“<strong>Member Associations</strong>”). YUSA has received license rights from the National Council of Young Men’s Christian Associations of the United States of America, an Illinois not-for-profit corporation (“<strong>YUSA</strong>”) to provide the Platform (as defined below) to you.</p><p>The purpose of the YMCA Website Services community is to collectively advance YMCA web and online experiences to better serve the YMCA mission. The terms of this Agreement govern your use of YMCA Website Services’s open-source digital content management system, which facilitates the sharing of YUSA brand-compliant website templates, tools, applications, and related digital assets (“<strong>Platform</strong>”). The community provides a collaborative environment for individuals to positively interact and participate in the Platform. These guidelines address the standards and expectations of those contributing to and participating in the YMCA Website Services community and are meant to help our YMCA community grow and thrive. Your participation in YMCA Website Services means that you agree to the following guidelines and to the YMCA Website Services Terms of Use.</p><p><strong>YMCA BRAND ASSETS</strong></p><p>No right is granted by this Agreement to use or license the YUSA brand assets. YMCA brand assets, which include, but are not limited to YMCA trademarks, trade dress, logos and other indicia of origin, are owned and controlled by YUSA. <em>YUSA provides the Platform to you under license from YUSA. Accordingly, neither YUSA nor any Member Association shall, either directly or indirectly, at any time do any act or thing contesting the validity of YUSA’s trademarks or its rights thereto.</em></p><p>Only Member Associations in the United States will have access to use any YUSA brand assets included in YMCA Website Services. All use by Member Associations must be in compliance with YUSA brand standards and guidelines as established by the National Board. YUSA is a third party beneficiary to this Agreement, with the right to enforce each of the terms of this Agreement with respect to YMCA Website Services and you. YMCA Website Services shall send copies of all notices due to you under this Agreement to each of you and YUSA.</p><p><strong>BEING A MEMBER OF OUR COMMUNITY</strong></p><p><em>Participation</em>: YMCA Website Services will be at its best if each member participates in the community. There are many different ways you can participate, including through using the platform, presentations, forums, summits, emails, calls, etc. We encourage your active participation to the extent you feel you are able and willing. YUSA may publicly disclose your participation in the project.</p><p><em>Contribution</em>: YMCA Website Services encourages Members to contribute to the enhancement, editing, and building of YMCA Website Services. To ensure valuable contributions to the community, YMCA Website Services encourages Members to stay familiar and up-to-date with the YMCA Website Services roadmap, as well as new features in active development. When you make changes that improve YMCA Website Services features, please contribute those back to the community by ensuring they are re-useable and decoupled.</p><p><em>Collaboration</em>: YMCA Website Services encourages Members to collaborate across the YMCA community to share costs and efforts on building new capabilities.</p><p><em>Transparency</em>: Customizations of code provided by YMCA Website Services for your website will likely increase the initial fees, support, and upgrade costs for your website. When modifying or redistributing code, you must include a notice giving credit to YMCA Website Services for the portion of the YMCA Website Services code you use.</p><p><em>Promotion</em>: YMCA Website Services encourages Members to share their expertise and YMCA Website Services experience to expand its reach and accessibility to experienced and new members alike. There will be many opportunities for members to support YMCA Website Services and its marketing and messaging initiatives.</p><p><strong>Reporting Problems</strong></p><p>If you believe someone has violated the YMCA Website Services Community Guidelines, or have any questions or concerns, please contact YUSA at
<a href=https://ymca.org target=_blank>https://ymca.org</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b12f79c60869676dba1be99d0244ac4c>33 - Patch YMCA Website Services</h1><p>Here you can find instructions how you can patch YMCA Website Services distribution used on
your project.</p><h2 id=when-you-need-to-patch-ymca-website-services>When you need to patch YMCA Website Services<a class=td-heading-self-link href=#when-you-need-to-patch-ymca-website-services aria-label="Heading self-link"></a></h2><ul><li>In case you found a bug and prepared a patch for YMCA Website Services on github.</li><li>In case you developed a new feature that will be good to have in YMCA Website Services and
created Pull Request to YMCA Website Services repository</li><li>In case you want to add a feature that added to YMCA Website Services but not included yet to
YMCA Website Services release.</li></ul><h3 id=how-to-patch-ymca-website-services-via-composer>How to patch YMCA Website Services via composer?<a class=td-heading-self-link href=#how-to-patch-ymca-website-services-via-composer aria-label="Heading self-link"></a></h3><p>If you followed instructions
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-1.x/docs/Development/Start%20new%20OpenY%20project.md target=_blank>docs/Development/Start new YMCA Website Services project</a>
and you have configured <code>composer.json</code> you need just to do a few simple steps:</p><ol><li><p>Build a link to a patch using pull request ID</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>https://patch-diff.githubusercontent.com/raw/YCloudYUSA/yusaopeny/pull/XXX.patch
</span></span></code></pre></div></li></ol><p>Where XXX is a number of pull request you want to use.</p><ol start=2><li><p>Add a new section <code>patches</code> to the section <code>extra</code> and add a patch to YMCA Website Services
repository, as on this example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;extra&#34;: {
</span></span><span class=line><span class=cl>    &#34;installer-paths&#34;: {
</span></span><span class=line><span class=cl>      ...
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    &#34;enable-patching&#34;: true,
</span></span><span class=line><span class=cl>    &#34;patches&#34;: {
</span></span><span class=line><span class=cl>        &#34;YCloudYUSA/yusaopeny&#34;: {
</span></span><span class=line><span class=cl>            &#34;Patch description&#34;: &#34;https://patch-diff.githubusercontent.com/raw/YCloudYUSA/yusaopeny/pull/XXX.patch&#34;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div></li><li><p>After adding a patch execute command <code>composer update</code></p></li><li><p>Verify you can see added changes in YMCA Website Services</p></li><li><p>Enjoy!</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-d215f669ae63afefbf5a776f222b4243>34 - Profile custom configuration</h1><div class=lead>The distribution supplements the Drupal install process with a number of custom additions.</div><p>There are plenty of
<a href=http://en.wikipedia.org/wiki/YAML target=_blank>YAML</a> configuration files at the root of the profile. Some of them are standard Drupal configuration and others are YMCA Website Services specific.</p><h2 id=basic-yml-files>Basic .yml files<a class=td-heading-self-link href=#basic-yml-files aria-label="Heading self-link"></a></h2><p>The following ones are very common and can be found in many Drupal modules:</p><ul><li><code>openy.info.yml</code> (
<a href=https://www.drupal.org/docs/8/creating-custom-modules/let-drupal-8-know-about-your-module-with-an-infoyml-file target=_blank>documentation</a>) - defines YMCA Website Services as a profile and defines its name and dependencies</li><li><code>openy.libraries.yml</code> (
<a href=https://www.drupal.org/docs/8/creating-custom-modules/adding-stylesheets-css-and-javascript-js-to-a-drupal-8-module target=_blank>documentation</a>) - defines global YMCA Website Services drupal asset libraries</li><li><code>openy.permissions.yml</code> - defines global YMCA Website Services permissions</li><li><code>openy.services.yml</code> (
<a href=https://www.drupal.org/docs/8/api/services-and-dependency-injection/structure-of-a-service-file target=_blank>documentation</a>) - if you are introducing a service that is needed by all (or the majority of) YMCA Website Services modules add it here and store the service class file in the <code>openy/src</code> directory</li></ul><h2 id=ymca-website-services-specific-yml-files>YMCA Website Services specific .yml files<a class=td-heading-self-link href=#ymca-website-services-specific-yml-files aria-label="Heading self-link"></a></h2><p>There are also a few configurations related to the YMCA Website Services installation process and the YMCA Website Services package system:</p><ul><li><code>openy.installation_types.yml</code></li><li><code>openy.themes.yml</code></li><li><code>openy.packages.yml</code></li></ul><h3 id=ymca-website-services-packages>YMCA Website Services packages<a class=td-heading-self-link href=#ymca-website-services-packages aria-label="Heading self-link"></a></h3><p>The YMCA Website Services package system introduces a new level of abstraction, shifting from the Drupal standard module level to packages. Packages represent complete YMCA Website Services features, which could include multiple modules. A package is a declaration of a group of several modules. You can enable and disable a package, which means the whole set of the associated Drupal modules are enabled or disabled.</p><p>This approach provides a convenient way of managing YMCA Website Services features.</p><p>The YMCA Website Services system module provides a page where the enabled and available packages are listed and can be installed/uninstalled. See the YMCA Website Services Extend page (at <code>/admin/openy/extend</code>).</p><h3 id=ymca-website-services-installation-types>YMCA Website Services Installation types<a class=td-heading-self-link href=#ymca-website-services-installation-types aria-label="Heading self-link"></a></h3><p>When an YMCA Website Services site is installed there is also another abstraction level - the installation type - which groups packages.</p><p>The hierarchy is as follows:</p><ul><li>installation type<ul><li>package<ul><li>module</li><li>module</li></ul></li><li>package<ul><li>module</li><li>module</li><li>module</li></ul></li><li>package<ul><li>module</li></ul></li></ul></li><li>installation type<ul><li>package<ul><li>module</li></ul></li></ul></li></ul><h3 id=openyinstallation_typesyml>openy.installation_types.yml<a class=td-heading-self-link href=#openyinstallation_typesyml aria-label="Heading self-link"></a></h3><p><code>openy.installation_types.yml</code> defines the high-level presets available during website installation.</p><p>File structure:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>standard:
</span></span><span class=line><span class=cl>  name: Standard
</span></span><span class=line><span class=cl>  packages:
</span></span><span class=line><span class=cl>    - alerts
</span></span><span class=line><span class=cl>    - editorial
</span></span><span class=line><span class=cl>    - news
</span></span><span class=line><span class=cl>    - seo
</span></span><span class=line><span class=cl>    - webform
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>extended:
</span></span><span class=line><span class=cl>  name: Extended
</span></span><span class=line><span class=cl>  packages:
</span></span><span class=line><span class=cl>    - alerts
</span></span><span class=line><span class=cl>    - analytics
</span></span><span class=line><span class=cl>    - ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>complete:
</span></span><span class=line><span class=cl>  name: Complete/Developer
</span></span><span class=line><span class=cl>  hidden: true
</span></span><span class=line><span class=cl>  packages:
</span></span><span class=line><span class=cl>    - activenet
</span></span><span class=line><span class=cl>    - ...
</span></span></code></pre></div><p>Each installation type has a machine name which is a key of the top-level items.</p><h4 id=properties-of-installation-types>Properties of installation types:<a class=td-heading-self-link href=#properties-of-installation-types aria-label="Heading self-link"></a></h4><ul><li><strong>name</strong> (required) - a human-friendly name of the installation type</li><li><strong>packages</strong> (required) - a list of YMCA Website Services packages that are associated with the installation type. The packages are listed when a website is installed via the web-interface</li><li><strong>hidden</strong> (optional) - if the installation type must be hidden when a website is installed via the web interface</li></ul><p>If an YMCA Website Services site is installed using the web interface there is a step where the installation type can be selected.</p><p>If an YMCA Website Services site is installed using Drush then the installation type can be specified by an optional argument for the <code>drush site-install</code> command (
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/docs/Development/InstallationWithDrush.md target=_blank>Installation with Drush</a>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  drush site-install openy \
</span></span><span class=line><span class=cl>     --db-url=&#34;mysql://user:pass@host:3306/db&#34; \
</span></span><span class=line><span class=cl>     --root=/docroot \
</span></span><span class=line><span class=cl>     openy_configure_profile.preset=extended
</span></span></code></pre></div><h3 id=openypackagesyml>openy.packages.yml<a class=td-heading-self-link href=#openypackagesyml aria-label="Heading self-link"></a></h3><p>Packages are defined in <code>openy.packages.yml</code>. This file is placed in the root of the profile, it&rsquo;s automatically detected and used by the YMCA Website Services installation process.</p><p>File structure</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>blog</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=p>:</span> <span class=err>&#39;</span><span class=nx>Blog</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>description</span><span class=p>:</span> <span class=s>&#34;Blog package provides a set of modules to maintain and create different blog post listings.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nx>help</span><span class=p>:</span> <span class=err>&#39;</span><span class=p>&lt;</span><span class=nx>p</span><span class=p>&gt;</span><span class=nx>Using</span> <span class=nx>Blog</span> <span class=kn>package</span> <span class=nx>you</span> <span class=nx>can</span> <span class=nx>create</span> <span class=nx>and</span> <span class=nx>maintain</span> <span class=nx>blog</span> <span class=nx>posts</span> <span class=nx>and</span> <span class=nx>create</span> <span class=nx>flexible</span> <span class=nx>listings</span> <span class=nx>of</span> <span class=nx>blog</span> <span class=nx>posts</span><span class=p>.</span> <span class=nx>Watch</span> <span class=nx>a</span> <span class=nx>video</span> <span class=nx>below</span> <span class=nx>to</span> <span class=nx>learn</span> <span class=nx>more</span> <span class=nx>about</span> <span class=nx>blog</span> <span class=nx>anatomy</span><span class=p>.&lt;</span><span class=o>/</span><span class=nx>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nx>iframe</span> <span class=nx>width</span><span class=p>=</span><span class=s>&#34;560&#34;</span> <span class=nx>height</span><span class=p>=</span><span class=s>&#34;315&#34;</span>
</span></span><span class=line><span class=cl>               <span class=nx>src</span><span class=p>=</span><span class=s>&#34;https://www.youtube.com/embed/Vg1fy29DhdQ&#34;</span>
</span></span><span class=line><span class=cl>               <span class=nx>frameborder</span><span class=p>=</span><span class=s>&#34;0&#34;</span> <span class=nx>allow</span><span class=p>=</span><span class=s>&#34;autoplay; encrypted-media&#34;</span>
</span></span><span class=line><span class=cl>               <span class=nx>allowfullscreen</span><span class=p>&gt;&lt;</span><span class=o>/</span><span class=nx>iframe</span><span class=p>&gt;</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>modules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_node_blog</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_blog_listing</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_featured_blogs</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_blog_branch</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_blog_camp</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_blog_latest</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_txnm_blog_category</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>camps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=p>:</span> <span class=err>&#39;</span><span class=nx>Camps</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>description</span><span class=p>:</span> <span class=s>&#34;Camps package provides a set of modules to maintain camps and add them to the location finder page.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nx>help</span><span class=p>:</span> <span class=err>&#39;</span><span class=p>&lt;</span><span class=nx>p</span><span class=p>&gt;</span><span class=nx>Using</span> <span class=nx>Camps</span> <span class=kn>package</span> <span class=nx>you</span> <span class=nx>can</span> <span class=nx>create</span> <span class=nx>and</span> <span class=nx>maintain</span> <span class=nx>Camps</span> <span class=nx>and</span> <span class=nx>extend</span> <span class=nx>location</span> <span class=nx>finder</span> <span class=nx>page</span> <span class=nx>to</span> <span class=nx>include</span> <span class=nx>them</span><span class=p>.&lt;</span><span class=o>/</span><span class=nx>p</span><span class=p>&gt;</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>modules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_prgf_camp_menu</span>
</span></span><span class=line><span class=cl>    <span class=o>-</span> <span class=nx>openy_loc_camp</span>
</span></span></code></pre></div><p>Each package has a machine name which is a key of the top-level items.</p><h4 id=properties-of-packages>Properties of packages:<a class=td-heading-self-link href=#properties-of-packages aria-label="Heading self-link"></a></h4><ul><li><strong>name</strong> (required) - a human-friendly name of the package.</li><li><strong>description</strong> (required) - a short description of the package features to show up on the YMCA Website Services Extend page.</li><li><strong>help</strong> (required) - an HTML markup for the installation via web interface. It contains a help message that pops up when the package name is clicked on the <code>Select installation type</code> step.</li><li><strong>modules</strong> (required) - a list of Drupal modules that are associated with the package. When the package is installed/uninstalled the associated modules are installed/uninstalled respectively. When a website is installed via web interface all the available packages are listed there but split into two groups - the ones that are to be installed (associated with the selected package) and all the rest.</li></ul><h3 id=openythemeyml>openy.theme.yml<a class=td-heading-self-link href=#openythemeyml aria-label="Heading self-link"></a></h3><p>The file defines which YMCA Website Services themes are available for installation when a website is being installed.</p><p>If an YMCA Website Services site is installed using Drush then the theme can be specified by an optional argument for the <code>drush site-install</code> command (
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/docs/Development/InstallationWithDrush.md target=_blank>Installation with Drush</a>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  drush site-install openy \
</span></span><span class=line><span class=cl>    --db-url=&#34;mysql://user:pass@host:3306/db&#34; \
</span></span><span class=line><span class=cl>    --root=/docroot \
</span></span><span class=line><span class=cl>    openy_configure_profile.preset=extended \
</span></span><span class=line><span class=cl>    openy_theme_select.theme=openy_rose
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-e55df29deb8e9db26c29eaed2c619fb0>35 - Program Event Framework</h1><div class=lead>A robust set of content types and syncer modules that build interactive tools to help members find and book activities.</div><p>&ldquo;Program Event Framework&rdquo; refers to the entire ecosystem of content and modules in YMCA Website Services that work together to build Activity Finder, Group Schedules, and more.</p><h2 id=content-types>Content Types<a class=td-heading-self-link href=#content-types aria-label="Heading self-link"></a></h2><p>These provide the containers for PEF content in Drupal:</p><ul><li><a href=../../user-documentation/content-types/program>Program</a></li><li><a href=../../user-documentation/content-types/program-subcategory>Program Subcategory</a></li><li><a href=../../user-documentation/content-types/activity-class-session>Activity, Class, Session</a></li></ul><h2 id=syncers>Syncers<a class=td-heading-self-link href=#syncers aria-label="Heading self-link"></a></h2><p>These provide integrations to pull content from external systems into the content types:</p><ul><li><a href=https://www.drupal.org/project/openy_daxko2 target=_blank>Extended Daxko API Integration (<code>drupal/openy_daxko2</code>)</a></li><li><a href=https://www.drupal.org/project/daxko target=_blank>Simple Daxko Integration (deprecated) (<code>drupal/daxko</code>)</a></li><li><a href=https://www.drupal.org/project/activenet target=_blank>ActiveNet Integration (<code>drupal/activenet</code>)</a></li><li><a href=https://www.drupal.org/project/personify target=_blank>Personify Integration (<code>drupal/personify</code>)</a></li><li><a href=https://www.drupal.org/project/groupexpro target=_blank>GroupEx Pro (Daxko) Integration (<code>drupal/groupexpro</code>)</a></li><li><a href=https://github.com/ynorth-projects/openy_pef_gxp_sync target=_blank>PEF (Program Event Framework) GXP (GroupEx Pro) Sync (<code>ynorth-projects/openy_pef_gxp_sync</code>)</a></li><li><a href=https://www.drupal.org/project/yusaopeny_ymca360 target=_blank>YMCA 360 (Y360) Integration (<code>drupal/yusaopeny_ymca360</code>)</a></li><li><a href=https://github.com/YCloudYUSA/openy_traction_rec target=_blank>Traction Rec Integration (<code>ycloudyusa/openy_traction_rec</code>)</a><ul><li><a href="https://github.com/YCloudYUSA/openy_traction_rec?tab=readme-ov-file#ymca-website-services-traction-rec-integration" target=_blank>How to configure the Traction Rec integration</a></li><li><a href=https://github.com/YCloudYUSA/openy_traction_rec/blob/main/modules/openy_traction_rec_import/README.md#ymca-website-services-traction-rec-pef-integration target=_blank>How to import data from Traction Rec</a></li></ul></li></ul><h2 id=displays>Displays<a class=td-heading-self-link href=#displays aria-label="Heading self-link"></a></h2><p>These display the content for users to discover:</p><ul><li>Activity Finder<ul><li><a href=../../user-documentation/schedules/activity-finder>Activity Finder (User Docs)</a><ul><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>Activity Finder (<code>ycloudyusa/yusaopeny_activity_finder</code>)</a> - this repo contains in-depth developer documentation.</li></ul></li></ul></li><li>Group Schedules<ul><li><a href=../../user-documentation/schedules/group-schedules>Group Schedules (User Docs)</a></li><li><a href=https://github.com/ynorth-projects/openy_repeat target=_blank>Repeat Schedules (<code>ynorth-projects/openy_repeat</code>)</a> - contains the &ldquo;Repeat Schedules&rdquo; block which is the basis for Group Schedules.</li></ul></li></ul><h2 id=data-model>Data model<a class=td-heading-self-link href=#data-model aria-label="Heading self-link"></a></h2><p>The network of data structures in PEF can be confusing. Here&rsquo;s how it all works</p><pre class=mermaid>---
title: PEF Relationships
---
erDiagram
    program {
        entityRefTerm field_program_color
        paragraph field_content
        paragraph field_header_content
        paragraph field_sidebar_content
        textFormattedLong field_program_description
        entityRefMedia field_program_icon
        entityRefMedia field_program_image
        layout layout_builder__layout
        meta field_meta_tags
        bool field_use_layout_builder
    }
    program_subcategory {
        paragraph field_bottom_content
        entityRefTerm field_category_color
        paragraph field_content
        paragraph field_sidebar_content
        textFormattedLong field_category_description
        paragraph field_header_content
        entityRefMedia field_category_image
        layout layout_builder__layout
        meta field_meta_tags
        entityRefProgram field_category_program
        bool field_use_layout_builder
    }
    program_subcategory }|--|| program : field_category_program
    activity {
        textFormattedLong field_activity_description
        entityRefProgSub field_activity_category
    }
    activity }o--|| program_subcategory : field_activity_category
    class {
        entityRefActivity field_class_activity
        paragraph field_bottom_content
        paragraph field_content
        textFormattedLong field_class_description
        paragraph field_header_content
        meta field_meta_tags
        paragraph field_sidebar_content
    }
    class }o--|| activity : field_class_activity
    session {
        listText field_activity_type
        entityRefClass field_session_class
        textFormattedLong field_session_description
        dateRange field_session_exclusions
        listText field_session_gender
        numberInt field_availability
        bool field_session_in_mbrsh
        textPlain field_session_instructor
        entityRefLoc field_session_location
        numberInt field_session_max_age
        listText field_session_max_grade
        numberDec field_session_mbr_price
        numberInt field_session_min_age
        listText field_session_min_grade
        numberDec field_session_nmbr_price
        bool field_session_online
        entityRef field_session_plocation
        numberInt field_productid
        link field_session_reg_link
        textPlain field_session_room
        paragraph field_session_time
        numberInt field_wait_list_availability
    }
    session }|--|| class : field_session_class
    session ||--o{ session_time_paragraph : field_session_type
    session_time_paragraph {
        dateRange field_session_time_date
        listText field_session_time_days
        textPlain field_session_time_override
    }
    branch {

    }
    camp {

    }
    facility {

    }
    session }o--|| branch : field_session_location
    session }o--|| camp : field_session_location
    session }o--|| facility : field_session_location
    session }o--|| facility : field_session_plocation</pre><p>More information on how this data gets out into each display will be coming soon.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6b6cd6f32e13540ecf39f3e05cf11aa0>35.1 - Activity Finder</h1><div class=lead>Provides an interactive tool to help members find and book activities.</div><p><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder target=_blank>YCloudYUSA/yusaopeny_activity_finder</a> is bundled as a &ldquo;decoupled application&rdquo; that ships with the YMCA Website Services distribution.</p><h2 id=requirements>Requirements<a class=td-heading-self-link href=#requirements aria-label="Heading self-link"></a></h2><p>This module requires the following modules:</p><ul><li><a href=https://github.com/open-y-subprojects/openy_map target=_blank>openy_map</a> (For pulling the list of location-related content types.)</li></ul><p>This module also requires one of the following to store data:</p><ul><li>A Solr server (preferably a server or index per-environment).</li><li>A subscription with access to the
<a href=https://api.daxko.com/v3/docs target=_blank>Daxko API</a>.</li></ul><h2 id=recommended-modules>Recommended modules<a class=td-heading-self-link href=#recommended-modules aria-label="Heading self-link"></a></h2><p>Activity Finder is most often used with a
<a href=https://ds-docs.y.org/docs/development/program-event-framework/#syncers target=_blank>syncer</a> to pull data from an external source.</p><h2 id=installation>Installation<a class=td-heading-self-link href=#installation aria-label="Heading self-link"></a></h2><p>Activity Finder version 4 is the current major version. Prior to <code>9.2.10.0</code>, the distribution required <code>^3.1 || ^4.0</code>, allowing you to choose which version you want to use depending on the project requirements.</p><h3 id=deprecations>Deprecations<a class=td-heading-self-link href=#deprecations aria-label="Heading self-link"></a></h3><p>Outdated implementations are not removed immediately, allowing you to update your projects and migrate to new components without breaking your site. They are marked with <code>[deprecated]</code> notices in the next version and are planned to be removed in the future releases.</p><h3 id=new-projects>New Projects<a class=td-heading-self-link href=#new-projects aria-label="Heading self-link"></a></h3><p>Install as you would normally install a contributed Drupal module. For further
information, see
<a href=https://www.drupal.org/docs/extending-drupal/installing-drupal-modules target=_blank>Installing Drupal Modules</a>.</p><p>New projects should enable:</p><ul><li>Activity Finder (<code>openy_activity_finder</code>)</li></ul><p>then choose one or both of the front ends:</p><ul><li>LB (Layout Builder) Activity Finder (<code>lb_activity_finder</code>)</li><li>Open Y Paragraph Activity Finder (<code>openy_prgf_activity_finder_4</code>)</li></ul><p>and finally enable one of these data stores:</p><ul><li>Search API Solr (<code>search_api_solr</code>)</li><li>Daxko API v2 integration (<code>openy_daxko2</code>)</li></ul><h3 id=existing-projects>Existing Projects<a class=td-heading-self-link href=#existing-projects aria-label="Heading self-link"></a></h3><p>You have a choice of either staying on the same version you use or to update to the next version. It depends on your project requirements and customizations. We recommend updating to the latest release if you have resources for it.</p><h3 id=update-from-version-3x-to-version-4x>Update from version 3.x to version 4.x<a class=td-heading-self-link href=#update-from-version-3x-to-version-4x aria-label="Heading self-link"></a></h3><p>Activity Finder is a complex functionality, it connects together many different
pieces and might require additional steps to make it working. The list of
actions below outlines the major steps to get Activity Finder updated to
version 4.</p><ul><li>Update the codebase using the composer command:
<code>composer require ycloudyusa/yusaopeny_activity_finder:&amp;#34;^4.0&amp;#34;</code></li><li>Run database updates <code>drush -y updb</code>.<ul><li>Verify there were no errors and updates went fine.</li></ul></li><li>Install the new "Open Y Paragraph Activity Finder" (<code>openy_prgf_activity_finder_4</code>):
<code>drush en openy_prgf_activity_finder_4</code></li><li>Create or update a existing Landing Page with Activity Finder.</li><li>Add Activity Finder paragraph (replace the deprecated paragraph), configure
it and save the page.<ul><li>Verify the page and Activity Finder functionality is working fine</li></ul></li><li>The previous version of Activity Finder used 2 landing pages with 2 paragraph
types - one for wizard and another one for results. Find and remove these
pages.</li><li>Uninstall "OpenY Paragraph Activity Finder" (<code>openy_prgf_activity_finder</code>).</li><li>Uninstall "OpenY Paragraph Activity Finder Search" (<code>openy_paragraph_activity_finder_search</code>).</li></ul><h2 id=configuration>Configuration<a class=td-heading-self-link href=#configuration aria-label="Heading self-link"></a></h2><h3 id=set-up-solr>Set up Solr<a class=td-heading-self-link href=#set-up-solr aria-label="Heading self-link"></a></h3><p>In order to install Solr -
<a href=https://www.drupal.org/node/2502203 target=_blank>check the documentation on Drupal.org</a>.</p><p>After enabling the above modules you should visit <code>/admin/config/search/search-api</code> and obtain config.zip from preconfigured by Open Y Solr Server setup
<img src=https://user-images.githubusercontent.com/563412/105169707-90ba2280-5b24-11eb-9c0c-fab09b336723.png alt=image></p><p>This configuration should be installed on your Solr server as an independent core. it should be extracted to the conf directory of a solr core</p><p><img src=https://user-images.githubusercontent.com/563412/105169758-ad565a80-5b24-11eb-81c3-b29c8b513a7a.png alt=image></p><p>Once it is done - ensure the name of your core from core.properties file added to Solr Server config in Open Y
<img src=https://user-images.githubusercontent.com/563412/105169816-c0692a80-5b24-11eb-9254-6abc32a0583d.png alt=image></p><p>Solr server configuration could be found in Dropdown at /admin/config/search/search-api
<img src=https://user-images.githubusercontent.com/563412/105169887-d4149100-5b24-11eb-8a7c-d5186b8005bb.png alt=image>
<img src=https://user-images.githubusercontent.com/563412/105169954-eb537e80-5b24-11eb-8e21-3df8f01a8c14.png alt=image></p><p>If you prefer drush configuration you may use commands below, just replace SOLR_CORE_IS_HERE with real core name</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.host 127.0.0.1 -y
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.core <span class=si>${</span><span class=nv>SOLR_CORE_IS_HERE</span><span class=si>}</span> -y
</span></span><span class=line><span class=cl>drush search-api:reset-tracker
</span></span><span class=line><span class=cl>drush search-api:index
</span></span></code></pre></div><p>Once this is done you should see Solr Server as Index as Enabled on a <code>/admin/config/search/search-api</code></p><p>If you installed Open Y with Demo content now it is time to create a Landing Page with the Activity Finder v4 component on it.</p><p>In Open Y we have a specially created module which can this for you</p><p>Enable openy_prgf_af4_demo by drush command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>drush en openy_prgf_af4_demo
</span></span></code></pre></div><p>and you’d get /activity-finder-v4 Landing Page created automatically which should look like
<img src=https://user-images.githubusercontent.com/563412/105170014-04f4c600-5b25-11eb-8a4a-b2952d86e7d3.png alt=image></p><p>when you visited it.
By visiting /activity-finder-v4?step=results or clicking on suggested buttons you should see results, activities with filters and all other functionality, shipped with Activity Finder v4
For the Demo content from OpenY, it should look like
<img src=https://user-images.githubusercontent.com/563412/105170087-1dfd7700-5b25-11eb-9e57-5db48e41af5e.png alt=image></p><h3 id=set-trusted-redirect-host-patterns>Set Trusted Redirect Host patterns<a class=td-heading-self-link href=#set-trusted-redirect-host-patterns aria-label="Heading self-link"></a></h3><p>Activity Finder has a feature to track redirects to 3rd party systems. In order
to control the URLs to redirect to you should use the trusted host patterns.
This feature works similar to Drupal core trusted_host_patterns setting.</p><p>Example - add this section to the settings.php:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// Trusted hosts to redirect to for Activity Finder.
</span></span><span class=line><span class=cl>$settings[&amp;#39;activity_finder_trusted_redirect_host_patterns&amp;#39;] = [
</span></span><span class=line><span class=cl>  &amp;#39;^apm\.activecommunities\.com$&amp;#39;,
</span></span><span class=line><span class=cl>];
</span></span></code></pre></div><p>It is also recommended to disallow these paths in robots.txt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Activity Finder redirects
</span></span><span class=line><span class=cl>Disallow: /af/register-redirect/
</span></span><span class=line><span class=cl>Disallow: /index.php/af/register-redirect/
</span></span></code></pre></div><h3 id=add-the-activity-finder-block>Add the Activity Finder block<a class=td-heading-self-link href=#add-the-activity-finder-block aria-label="Heading self-link"></a></h3><p>See
<a href=https://ds-docs.y.org/docs/user-documentation/schedules/activity-finder/ target=_blank>the full documentation on Activity Finder</a> for information on how to add the block to your page and block options.</p><h2 id=troubleshooting-amp-faq>Troubleshooting & FAQ<a class=td-heading-self-link href=#troubleshooting-amp-faq aria-label="Heading self-link"></a></h2><p>To demo Activity Finder, see these sandboxes:</p><ul><li>Activity Finder v4<ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.y.org/activity-finder-v4</a></li><li>Lily
<a href=https://sandbox-lily-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-lily-cus-d9.y.org/activity-finder-v4</a></li><li>Rose
<a href=https://sandbox-rose-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-rose-cus-d9.y.org/activity-finder-v4</a></li></ul></li><li>Activity Finder v3<ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.y.org/activity-finder target=_blank>https://sandbox-carnation-cus-d9.y.org/activity-finder</a></li><li>Lily
<a href=https://sandbox-lily-cus-d9.y.org/activity-finder target=_blank>https://sandbox-lily-cus-d9.y.org/activity-finder</a></li><li>Rose
<a href=https://sandbox-rose-cus-d9.y.org/activity-finder target=_blank>https://sandbox-rose-cus-d9.y.org/activity-finder</a></li></ul></li></ul><h3 id=limitations-with-using-daxko-backend>Limitations with using Daxko backend<a class=td-heading-self-link href=#limitations-with-using-daxko-backend aria-label="Heading self-link"></a></h3><p>When using the Daxko backend. Developers should be aware of these limitations:</p><ul><li>We can't use home branch functionality on start screen.</li><li>We have to use Legacy mode.</li><li>We can't display count of result for each age on the age's wizard step.</li><li>We can't display count of available spots for each activity, before user click by activity details.</li><li>Limited pager on results page. We can display only previous and next page link and can't display count of pages.</li></ul><h3 id=how-to-override-processresults-in-activity-finder>How to override processResults in Activity Finder<a class=td-heading-self-link href=#how-to-override-processresults-in-activity-finder aria-label="Heading self-link"></a></h3><p>See <code>openy_activity_finder.api.php</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> * Implements hook_activity_finder_program_process_results_alter().
</span></span></span><span class=line><span class=cl><span class=sd> */</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>custom_module_activity_finder_program_process_results_alter</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>amp</span><span class=p>;</span><span class=nv>$data</span><span class=p>,</span> <span class=nx>NodeInterface</span> <span class=nv>$entity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Get formatted session data from some custom service.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nv>$formatted_session</span> <span class=o>=</span> <span class=nx>\Drupal</span><span class=o>::</span><span class=na>service</span><span class=p>(</span><span class=o>&amp;</span><span class=c1>#39;ymca_class_page.data_provider&amp;#39;)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>-&amp;</span><span class=nx>gt</span><span class=p>;</span><span class=nx>formatSessions</span><span class=p>([</span><span class=nv>$entity</span><span class=p>],</span> <span class=k>FALSE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nv>$formatted_session</span> <span class=o>=</span> <span class=nx>reset</span><span class=p>(</span><span class=nv>$formatted_session</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Fix pricing according to YMCA price customization.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nv>$data</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;price&amp;#39;] = &amp;#39;&amp;#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$formatted_session</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;prices&amp;#39;])) {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$formatted_session</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;prices&amp;#39;] as $price) {
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nv>$data</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;price&amp;#39;] .= implode(&amp;#39; &amp;#39;, $price) . &amp;#39;&amp;lt;br&amp;gt;&amp;#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Fix availability and registration according to YMCA customization.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nv>$messages</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=o>&amp;</span><span class=c1>#39;begun&amp;#39; =&amp;gt; t(&amp;#39;This class has begun.&amp;#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>&amp;</span><span class=c1>#39;will_open&amp;#39; =&amp;gt; t(&amp;#39;Registration for this class opens shortly. Please check back.&amp;#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>&amp;</span><span class=c1>#39;inperson&amp;#39; =&amp;gt; t(&amp;#39;Online registration is closed. Visit a YMCA branch to register.&amp;#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>&amp;</span><span class=c1>#39;included_in_membership&amp;#39; =&amp;gt; t(&amp;#39;Included in Membership&amp;#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$messages</span><span class=p>[</span><span class=nv>$formatted_session</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;reg_state&amp;#39;]])) {
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nv>$data</span><span class=p>[</span><span class=o>&amp;</span><span class=c1>#39;availability_note&amp;#39;] = $messages[$formatted_session[&amp;#39;reg_state&amp;#39;]];
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=how-to-add-external-functionality-to-analytics-event>How to add external functionality to analytics event<a class=td-heading-self-link href=#how-to-add-external-functionality-to-analytics-event aria-label="Heading self-link"></a></h3><p>See <code>openy_af4_vue_app/main.js</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Listen to a custom event to pass events in Google Analytics.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nx>openy_activity_finder_event</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=o>=&amp;</span><span class=nx>gt</span><span class=p>;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>action</span><span class=p>,</span> <span class=nx>label</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>category</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>gtag</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>gtag</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nx>event</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=nx>action</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>event_category</span><span class=o>:</span> <span class=nx>category</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>event_label</span><span class=o>:</span> <span class=nx>label</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>value</span><span class=o>:</span> <span class=nx>value</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>ga</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>ga</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nx>send</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nx>event</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=nx>category</span><span class=p>,</span> <span class=nx>action</span><span class=p>,</span> <span class=nx>label</span><span class=p>,</span> <span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h4 id=example-of-custom-event>Example of custom event<a class=td-heading-self-link href=#example-of-custom-event aria-label="Heading self-link"></a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nx>openy_activity_finder_event</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=o>=&amp;</span><span class=nx>gt</span><span class=p>;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>action</span><span class=p>,</span> <span class=nx>label</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>category</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span> <span class=c1>// Properties you can use for analitics.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>your_functionality</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h3 id=add-custom-component-in-between-of-results>Add custom component in between of results<a class=td-heading-self-link href=#add-custom-component-in-between-of-results aria-label="Heading self-link"></a></h3><p>it allows flexibility in terms of results rendering for the developer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>          &amp;lt;ResultsList
</span></span><span class=line><span class=cl>            :results=&amp;#34;data.table&amp;#34;
</span></span><span class=line><span class=cl>            :ages=&amp;#34;ages&amp;#34;
</span></span><span class=line><span class=cl>            :selected-ages=&amp;#34;selectedAges&amp;#34;
</span></span><span class=line><span class=cl>            :legacy-mode=&amp;#34;legacyMode&amp;#34;
</span></span><span class=line><span class=cl>            :disable-spots-available=&amp;#34;disableSpotsAvailable&amp;#34;
</span></span><span class=line><span class=cl>            @showActivityDetailsModal=&amp;#34;showActivityDetailsModal($event)&amp;#34;
</span></span><span class=line><span class=cl>          /&amp;gt;
</span></span></code></pre></div><p>can be changed to this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>          &amp;lt;ResultsList
</span></span><span class=line><span class=cl>            :results=&amp;#34;data.table.slice(0, 2)&amp;#34;
</span></span><span class=line><span class=cl>            :ages=&amp;#34;ages&amp;#34;
</span></span><span class=line><span class=cl>            :selected-ages=&amp;#34;selectedAges&amp;#34;
</span></span><span class=line><span class=cl>            :legacy-mode=&amp;#34;legacyMode&amp;#34;
</span></span><span class=line><span class=cl>            :disable-spots-available=&amp;#34;disableSpotsAvailable&amp;#34;
</span></span><span class=line><span class=cl>            @showActivityDetailsModal=&amp;#34;showActivityDetailsModal($event)&amp;#34;
</span></span><span class=line><span class=cl>          /&amp;gt;
</span></span><span class=line><span class=cl>          &amp;lt;YGBWAds /&amp;gt;
</span></span><span class=line><span class=cl>          &amp;lt;ResultsList
</span></span><span class=line><span class=cl>            :results=&amp;#34;data.table.slice(2)&amp;#34;
</span></span><span class=line><span class=cl>            :ages=&amp;#34;ages&amp;#34;
</span></span><span class=line><span class=cl>            :selected-ages=&amp;#34;selectedAges&amp;#34;
</span></span><span class=line><span class=cl>            :legacy-mode=&amp;#34;legacyMode&amp;#34;
</span></span><span class=line><span class=cl>            :disable-spots-available=&amp;#34;disableSpotsAvailable&amp;#34;
</span></span><span class=line><span class=cl>            @showActivityDetailsModal=&amp;#34;showActivityDetailsModal($event)&amp;#34;
</span></span><span class=line><span class=cl>          /&amp;gt;
</span></span></code></pre></div><p>where YGBWAds is custom component to render custom content in between the results.
See
<a href=https://github.com/ymcatwincities/openy_activity_finder/pull/148 target=_blank>https://github.com/ymcatwincities/openy_activity_finder/pull/148</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-6baf5f590747c78e0e74a2ef64afd201>35.1.1 - Adding Activity Finder to your site</h1><p>Both v4 and v3 could live together as independent programs on your site, and they will show the same data from the Program Event Framework of Open Y
<img src=https://user-images.githubusercontent.com/563412/105326548-88222480-5bd6-11eb-8943-bd0b7c82db63.png alt=image></p><p>On the screenshot above you can see Open Y components in a list for both Activity Finder v3 and v4</p><p>In order to create v3 Activity Finder application you need to create 2 landing pages, referencing each other, one with Activity Finder [deprecated], another one with Activity Finder Search [deprecated]
<img src=https://user-images.githubusercontent.com/563412/105327229-5067ac80-5bd7-11eb-9546-d53a1956f976.png alt=image>
See</p><ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder</a></li><li>Lily
<a href=https://sandbox-lily-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-lily-cus-d9.openy.org/activity-finder</a></li><li>Rose
<a href=https://sandbox-rose-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-rose-cus-d9.openy.org/activity-finder</a></li></ul><p><img src=https://user-images.githubusercontent.com/563412/105327376-7f7e1e00-5bd7-11eb-9bcc-5e3735018977.png alt=image>
See</p><ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.openy.org/program-search target=_blank>https://sandbox-carnation-cus-d9.openy.org/program-search</a></li><li>Lily
<a href=https://sandbox-lily-cus-d9.openy.org/program-search target=_blank>https://sandbox-lily-cus-d9.openy.org/program-search</a></li><li>Rose
<a href=https://sandbox-rose-cus-d9.openy.org/program-search target=_blank>https://sandbox-rose-cus-d9.openy.org/program-search</a></li></ul><p>In order to create v4 Activity Finder application, you need to create 1 landing page, with the Activity Finder component on it
<img src=https://user-images.githubusercontent.com/563412/105327534-a76d8180-5bd7-11eb-9f6b-bc88d325047e.png alt=image>
See sandbox</p><ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4</a></li><li>Lily
<a href=https://sandbox-lily-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-lily-cus-d9.openy.org/activity-finder-v4</a></li><li>Rose
<a href=https://sandbox-rose-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-rose-cus-d9.openy.org/activity-finder-v4</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b2056fc5cab10f929a44c332b8102fc8>35.1.2 - Bootstrap version support for Activity Finder</h1><p>In the Carnation theme we use bootstrap v 4.6 and for this case we have a special option Bootstrap version in settings form for Activity Finder v4
(/admin/openy/settings/activity-finder)</p><p><img src=https://user-images.githubusercontent.com/563412/130978526-fd949acf-1b00-4d20-93f0-cb339a23cb65.png alt=image></p><p>Rose and Lily themes are using Bootstrap v3, Carnation theme is on Bootstrap v4
And when we set it to 4 then the AF4 result page looks good for the tablet screen on Carnation
<img src=https://user-images.githubusercontent.com/563412/130978729-45954c96-2190-46c1-aa20-66cf596ab52d.png alt=image>
<img src=https://user-images.githubusercontent.com/563412/130978794-6d99e3cb-8794-4e13-bc9d-c181458b237f.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-64bd222410c78abcfc9f90c814006a69>35.1.3 - Configuring Solr for Activity Finder</h1><p>In order to install Open Y and Activity Finder v4 you need to run command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer create-project ymcatwincities/openy-project build --no-interaction --prefer-dist
</span></span></code></pre></div><p>Which will pull Open Y on Drupal stable version with Activity Finder v4 latest stable version
Then you should proceed with a regular installation with Demo content enabled as described in our tutorials. It’s better to setup Extended or Custom( only via drush ) in order to skip a bunch of manual steps</p><p>When you have YMCA Website Services (former Open Y) installed, list of the command you need to run in order to enable Activity Finder v4</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Solr 8.8.1, Activity Finder v4</span>
</span></span><span class=line><span class=cl>drush en -y search_api_solr_legacy openy_prgf_activity_finder_4 <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush en -dvy openy_prgf_af4_demo <span class=o>||</span> <span class=nb>true</span>
</span></span></code></pre></div><p>After enabling the above modules you should visit /admin/config/search/search-api and obtain config.zip from preconfigured by Open Y Solr Server setup
<img src=https://user-images.githubusercontent.com/563412/105169707-90ba2280-5b24-11eb-9c0c-fab09b336723.png alt=image></p><blockquote><p>Hint: Open Y module&rsquo;s infrastructure supports SOLR versions 8 up to the latest 8.8.1 as well. Activity Finder is tested against Solr 8.8.1. In order to install Solr -
<a href=https://www.drupal.org/node/2502203 target=_blank>check the documentation on Drupal.org</a>.
Solr versions prior 7.7 are End of Life, Open Y team is working on upgrading support for decent versions of Solr.</p></blockquote><p>This configuration should be installed on your Solr 8.8.1 server as a independent core. it should be extracted to conf directory of a solr core</p><p><img src=https://user-images.githubusercontent.com/563412/105169758-ad565a80-5b24-11eb-81c3-b29c8b513a7a.png alt=image></p><p>Once it is done - ensure the name of your core from core.properties file added to Solr Server config in Open Y
<img src=https://user-images.githubusercontent.com/563412/105169816-c0692a80-5b24-11eb-9254-6abc32a0583d.png alt=image></p><p>Solr server configuration could be found in Dropdown at /admin/config/search/search-api
<img src=https://user-images.githubusercontent.com/563412/105169887-d4149100-5b24-11eb-8a7c-d5186b8005bb.png alt=image>
<img src=https://user-images.githubusercontent.com/563412/105169954-eb537e80-5b24-11eb-8e21-3df8f01a8c14.png alt=image></p><p>If you prefer drush configuration you may use commands below, just replace SOLR_CORE_IS_HERE with real core name</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Solr 8.8.1, Activity Finder v4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.host 127.0.0.1 -y <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.core <span class=si>${</span><span class=nv>SOLR_CORE_IS_HERE</span><span class=si>}</span> -y
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.solr_version <span class=m>8</span> -y
</span></span><span class=line><span class=cl>drush search-api-mark-all <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush sapi-i <span class=o>||</span> <span class=nb>true</span>
</span></span></code></pre></div><p>Once you done this you should see Solr Server as Index as Enabled on a /admin/config/search/search-api</p><p>If you installed Open Y with Demo content now it is time to create a Landing Page with the Activity Finder v4 component on it.
In Open Y we have a specially created module which can this for you
Enable openy_prgf_af4_demo by drush command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Solr 8.8.1, Activity Finder v4</span>
</span></span><span class=line><span class=cl>drush en -dvy openy_prgf_af4_demo <span class=o>||</span> <span class=nb>true</span>
</span></span></code></pre></div><p>and you’d get /activity-finder-v4 Landing Page created automatically which should look like
<img src=https://user-images.githubusercontent.com/563412/105170014-04f4c600-5b25-11eb-8a4a-b2952d86e7d3.png alt=image></p><p>when you visited it.
By visiting /activity-finder-v4?step=results or clicking on suggested buttons you should see results, activities with filters and all other functionality, shipped with Activity Finder v4
For the Demo content from OpenY, it should look like
<img src=https://user-images.githubusercontent.com/563412/105170087-1dfd7700-5b25-11eb-9e57-5db48e41af5e.png alt=image>
See sandboxes</p><ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4</a></li><li>Lily
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4</a></li><li>Rose
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder-v4</a></li></ul><p>Activity Finder v3 also installed when you chose Custom Installation with Demo content and is part of demo content.
Could be accessed via /activity-finder url
See sandboxes</p><ul><li>Carnation
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder</a></li><li>Lily
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder</a></li><li>Rose
<a href=https://sandbox-carnation-cus-d9.openy.org/activity-finder target=_blank>https://sandbox-carnation-cus-d9.openy.org/activity-finder</a></li></ul><h3 id=development-solr-8-installation>Development SOLR 8 installation<a class=td-heading-self-link href=#development-solr-8-installation aria-label="Heading self-link"></a></h3><p>Solr Docker readme
<a href=https://github.com/docker-solr/docker-solr/blob/master/README.md target=_blank>https://github.com/docker-solr/docker-solr/blob/master/README.md</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>mkdir solr8
</span></span><span class=line><span class=cl>sudo chown 8983:8983 solr8
</span></span><span class=line><span class=cl>docker run -v <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/solr8:/var/solr&#34;</span> -p 8984:8983 --name d9_sandbox_rose_custom solr solr-precreate d9_sandbox_rose_custom
</span></span><span class=line><span class=cl><span class=c1># stop docker and remove created container</span>
</span></span><span class=line><span class=cl><span class=c1># unpack solr_8.x_config.zip into data/d9_sandbox_rose_custom/conf/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker run -v <span class=s2>&#34;</span><span class=nv>$PWD</span><span class=s2>/solr8:/var/solr&#34;</span> -p 8984:8983 --name d9_sandbox_rose_custom solr solr-precreate d9_sandbox_rose_custom
</span></span></code></pre></div><p>Configure Open Y to change Solr version to 8.x
Change address port to 8984</p><p>Rebuild index information
Reindex
Check Activity Finder v4 is working now</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d548bf68496eaba7c365614751b91cc6>35.2 - PEF Schedules</h1><div class=lead>The &ldquo;PEF Schedules&rdquo; module allows Ys to create and manage schedules with a simple, calendar-based view.</div><p><a href=https://github.com/YCloudYUSA/y_pef_schedule target=_blank>YCloudYUSA/y_pef_schedule</a></p><p>The Y PEF Schedule module provides a calendar functionality for scheduling events.
It includes a Vue.js component, <code>fullcalendar-app</code>, to display and interact with the calendar.</p><h3 id=requirements>Requirements<a class=td-heading-self-link href=#requirements aria-label="Heading self-link"></a></h3><ul><li><a href=https://www.drupal.org/project/drupal target=_blank>Drupal</a></li><li><a href=https://github.com/ynorth-projects/openy_repeat target=_blank>Open Y Repeat</a></li><li><a href=https://vuejs.org/ target=_blank>Vue.js 3</a></li><li><a href=https://axios-http.com/ target=_blank>Axios-HTTP</a></li><li><a href=https://fullcalendar.io/ target=_blank>FullCalendar</a></li></ul><h2 id=installation>Installation<a class=td-heading-self-link href=#installation aria-label="Heading self-link"></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>composer require ycloudyusa/y_pef_schedule
</span></span><span class=line><span class=cl>drush en y_pef_schedule lb_simple_schedule
</span></span></code></pre></div><ol><li>Install as you would normally install a contributed Drupal module. For further information, see
<a href=https://www.drupal.org/docs/extending-drupal/installing-drupal-modules target=_blank>Installing Drupal Modules</a>.</li><li>Enable the module by navigating to <strong>Admin</strong> > <strong>Extend</strong> (<code>/admin/modules</code>) in your Drupal admin interface, then enabling "Y PEF Schedules Admin tool" and "LB Simple Schedule".</li></ol><h2 id=configuration>Configuration<a class=td-heading-self-link href=#configuration aria-label="Heading self-link"></a></h2><ol><li>Configure the calendar settings at <strong>Admin</strong> > <strong>YMCA Website Services</strong> > <strong>Settings</strong> > <strong>Schedules calendar settings</strong> (<code>/admin/openy/settings/schedules-calendar</code>)</li><li>Go to <strong>Admin</strong> > <strong>Content</strong> > <strong>Schedules Calendar</strong> (<code>/admin/openy/branch-schedules</code>) and select a branch.</li></ol><p>After choosing a branch, you can view the calendar. The calendar features include:</p><ol><li>Viewing events in weekly or daily format.</li><li>Viewing the main information of the event (by clicking on the event).</li><li>Creating a new event (using the Session Content Type).</li><li>Updating existing events.</li><li>Downloading the schedule in PDF format.</li><li>Filtering results by categories.</li></ol><h3 id=showing-the-calendar-on-a-page>Showing the calendar on a page<a class=td-heading-self-link href=#showing-the-calendar-on-a-page aria-label="Heading self-link"></a></h3><p>Once you have added sessions to a calendar, you can add the calendar block to a Layout Builder page to display on the site. Ensure the "LB Simple Schedule" is enabled first.</p><ol><li>Edit the Layout of a Layout Builder page (Branch, Landing Page, etc).</li><li>Create or find a section, then <strong>Add Block</strong>.</li><li>Choose <strong>Add custom/content block</strong> then <strong>Simple Schedule</strong>.</li><li>Add a Title and choose a Branch to populate the calendar.</li><li>Save the block and the page.</li></ol><h3 id=customization>Customization<a class=td-heading-self-link href=#customization aria-label="Heading self-link"></a></h3><p>A few options are available for advanced customization of the calendar.</p><h4 id=retrieving-events>Retrieving Events<a class=td-heading-self-link href=#retrieving-events aria-label="Heading self-link"></a></h4><p>The module provides controllers to handle AJAX requests for fetching events. To create a custom request, use the following route in your JavaScript code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=err>/fullcalendar-api/get-event-data-date-range/{location}/{start}/{end}/{category}&amp;#39;)</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=o>=&amp;</span><span class=nx>gt</span><span class=p>;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>events</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Process the received events as needed
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=o>=&amp;</span><span class=nx>gt</span><span class=p>;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=o>&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;</span><span class=nb>Error</span> <span class=nx>fetching</span> <span class=nx>events</span><span class=o>:&amp;</span><span class=err>#</span><span class=mi>39</span><span class=p>;,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span></code></pre></div><p>Replace <code>{location}</code>, <code>{start}</code>, <code>{end}</code>, and <code>{category}</code> with the appropriate values.</p><h4 id=creating-events>Creating Events<a class=td-heading-self-link href=#creating-events aria-label="Heading self-link"></a></h4><p>The <code>fullcalendar-app</code> component allows users to create events interactively. When a date is clicked, a modal form is displayed for users to enter event details such as title, category, time, and date.</p><p>To customize the form or extend the functionality, refer to the
<a href=https://fullcalendar.io/docs/vue target=_blank>Vue.js component documentation</a> and customize the handleDateClick and createEvent methods in the fullcalendar-app component.</p><h2 id=troubleshooting>Troubleshooting<a class=td-heading-self-link href=#troubleshooting aria-label="Heading self-link"></a></h2><h3 id=known-issues>Known issues<a class=td-heading-self-link href=#known-issues aria-label="Heading self-link"></a></h3><ol><li>After creating a series of events, it is created, but only one event is displayed in the calendar, the page must be refreshed to see the correct data</li><li>The color is fixed to the session and not to the category</li><li>PDF format is A3</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-8789c12d3402c271167ebb2ef622955a>35.3 - Traction Rec Integration</h1><div class=lead>Instructions for configuring and importing data from Traction Rec into the Program Event Framework</div><p>Via
<a href=https://github.com/YCloudYUSA/openy_traction_rec target=_blank>Traction Rec Integration (<code>ycloudyusa/openy_traction_rec</code>)</a></p><ul><li><a href="https://github.com/YCloudYUSA/openy_traction_rec?tab=readme-ov-file#ymca-website-services-traction-rec-integration" target=_blank>How to configure the Traction Rec integration</a></li><li><a href=https://github.com/YCloudYUSA/openy_traction_rec/blob/main/modules/openy_traction_rec_import/README.md#ymca-website-services-traction-rec-pef-integration target=_blank>How to import data from Traction Rec</a></li></ul><p>This module provides YMCA Website Services integration with the
<a href=https://www.tractionrec.com target=_blank>Traction Rec CRM</a>.</p><ul><li>JWT OAuth flow is used for the integration:
<a href="https://help.salesforce.com/articleView?id=remoteaccess_oauth_jwt_flow.htm&amp;amp;type=5" target=_blank>OAuth 2.0 JWT Bearer Flow for Server-to-Server Integration</a></li><li>The
<a href=https://www.drupal.org/project/key target=_blank>Drupal Key module</a> assists with key management for authentication.</li></ul><h2 id=installation>Installation<a class=td-heading-self-link href=#installation aria-label="Heading self-link"></a></h2><p>Require this module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>composer require ycloudyusa/openy_traction_rec
</span></span></code></pre></div><p>Then enable the necessary modules and submodules:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>drush en openy_traction_rec openy_traction_rec_import openy_tr_activity_finder
</span></span></code></pre></div><h2 id=usage>Usage<a class=td-heading-self-link href=#usage aria-label="Heading self-link"></a></h2><p>The main module itself provides only API that helps fetch data from TractionRec. More specific functionality is provided in submodules:</p><ul><li><code>YMCA Website Services Traction Rec: PEF import</code> provides PEF migrations.</li><li><code>YMCA Website Services Traction Rec: Activity Finder</code> extends YMCA Website Services Activity Finder with the new fields and logic.</li></ul><p>See
<a href=modules/openy_traction_rec_import/README.md>modules/openy_traction_rec_import/README.md</a> for details on how to import content once configuration is complete.</p><h2 id=configuration>Configuration<a class=td-heading-self-link href=#configuration aria-label="Heading self-link"></a></h2><h3 id=create-a-connected-app-in-salesforce>Create a Connected App in Salesforce<a class=td-heading-self-link href=#create-a-connected-app-in-salesforce aria-label="Heading self-link"></a></h3><ol><li>Create a new private key and X509 certificate, customizing the <code>subj</code> options in the command to suit your organization. (See
<a href=https://www.openssl.org/docs/manmaster/man1/openssl-req.html target=_blank>the manual for openssl-req</a> to understand the options here.)<div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>openssl req -x509 -noenc -sha256 -days <span class=m>365</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -keyout traction_rec.key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -out traction_rec.crt <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -subj <span class=p>&amp;</span><span class=c1>#34;/C=US/ST=Illinois/L=Chicago/O=My YMCA/OU=Org/emailAddress=youremail@example.com&amp;#34;</span>
</span></span></code></pre></div><ul><li>The email address in the certificate does not need to match the email on the Connected App.</li><li>The certificate <strong>must be renewed yearly</strong> (or after the set number of <code>--days</code>). We recommend you set a reminder in order to prevent unwanted failures.</li></ul></li><li>In <strong>Salesforce</strong> > <strong>Setup</strong> > <strong>App Manager</strong>, create a <strong>New Connected App</strong>.<ul><li>Set a <strong>Name</strong> and <strong>Email</strong>.<ul><li>The <strong>Contact Email</strong> is not used for authentication.</li></ul></li><li>Check <strong>Enable OAuth Settings</strong><ul><li>Set the callback url as the base URL of your site</li><li>Check <strong>Use digital signatures</strong> and upload the X509 certificate (<code>.crt</code>) created above.</li><li>Ensure the app has the following <strong>Selected OAuth Scopes</strong><ul><li>Full access (full)</li><li>Manage user data via APIs (api)</li><li>Manage user data via Web browsers (web)</li><li>Perform requests at any time (refresh_token, offline_access)</li></ul></li><li>Check these options:<ul><li><strong>Require Proof Key for Code Exchange (PKCE) Extension for Supported Authorization Flows</strong></li><li><strong>Issue JSON Web Token (JWT)-based access tokens for named users</strong></li></ul></li><li>Uncheck all other options in the <strong>OAuth</strong> section.</li></ul></li><li><strong>Save</strong> the Connected App</li></ul></li><li>Once the app is saved, you will need to get the <strong>Consumer Details</strong>:<ul><li>In the "My Connected App" screen that appears once you save (or via <strong>Setup</strong> > <strong>App Manager</strong>), click <strong>Manage Consumer Details</strong>.</li><li>Save the <strong>Consumer Key</strong> and <strong>Consumer Secret</strong> for the next step.</li></ul></li><li>Create a <strong>Profile</strong> OR <strong>Permission Set</strong> to assign permissions to your app. We recommend using a <strong>Permission Set</strong> as those are the option recommended by Salesforce.<ol><li>Your Traction Rec support team should be able to deploy the <code>Traction Rec Activity Finder Permission Set</code> from their <code>dev1</code> instance. If this Permission Set is deployed, proceed straight to the <strong>User</strong> creation step. To create a <strong>Permission Set</strong> from scratch:</li></ol><ul><li><strong>Setup</strong> > <strong>Users</strong> > <strong>Permission Sets</strong> > <strong>New</strong></li><li>Fill in the <strong>Label</strong> as you wish, and leave <strong>License</strong> as <code>--None--</code></li><li>In the new <strong>Permission Set</strong>, open <strong>Object Settings</strong>.</li><li>In the very long list of <strong>Object Settings</strong>, do the following for each of the 10
<a href=#salesforce-permissions>Objects listed below</a>:<ul><li>Find the object and click to open it. In the configuration screen for each Object:<ul><li>Under <strong>Object Permissions</strong>, mark <strong>Read</strong> as <strong>Enabled</strong>.</li><li>Under <strong>Field Permissions</strong>, mark <strong>Read Access</strong> on the header field to provide access to all fields.</li></ul></li><li>Save the <strong>Object Settings</strong> and search for the next one.</li></ul></li><li>Finally, review the summary of access permissions and ensure <strong>Read</strong> access is provided for each of the necessary objects.</li></ul><ol start=2><li>Create a <strong>Profile</strong>:<ul><li>You <strong>must</strong> do this <strong>before</strong> creating a user.</li><li><strong>Setup</strong> > <strong>Users</strong> > <strong>Profiles</strong> > <strong>New</strong></li><li>When asked what <strong>Existing Profile</strong> to clone from, select <strong>Standard User</strong> or <strong>Standard Platform User</strong>. Be sure to note the <strong>User License</strong> connected to the target profile.</li><li>In the <em>very large</em> configuration screen, click <strong>Edit</strong>, then:<ul><li>Under <strong>Connected App Access</strong>, add access to the Connected App you created above.</li><li>Search for and enable the
<a href=#salesforce-permissions>System permissions listed below</a>.</li><li>Under <strong>Custom Object Permissions</strong>, add <strong>Read</strong> access to the
<a href=#salesforce-permissions>Objects listed below</a>.</li></ul></li><li>Save those changes.</li></ul></li></ol></li><li>Create a new <strong>User</strong> with the new Profile or Permission Set:</li></ol><ul><li><strong>Setup</strong> > <strong>Users</strong> > <strong>New User</strong><ul><li><strong>User License</strong> - The option under which you created the Profile in the previous step, or <strong>Salesforce</strong>.</li><li><strong>Email</strong> - A working email that you will use to receive login verifications.</li><li><strong>Username</strong> - This is <em>not</em> your email and <em>must</em> be unique across <em>all Salesforce Organizations</em>. <strong>This is the name that will be used in the Drupal connection below.</strong> If you enter a preexisting username, you will receive this error:
> Error: Duplicate Username.
> The username already exists in this or another Salesforce organization. Usernames must be unique across all Salesforce organizations. To resolve, use a different username (it doesn't need to match the user's email address).</li><li>Assign the User to the <strong>Profile</strong> you created above, or a <strong>Permission Set</strong> that has the
<a href=#salesforce-permissions>necessary permissions</a>.<ul><li>Under <strong>Permission Set Assignments</strong>, click <strong>Edit Assignments</strong></li><li>Find the <strong>Permission Set</strong> you created in the prior step, select it, click <strong>Add</strong>, then <strong>Save</strong>.</li></ul></li></ul></li></ul><ol start=5><li>Confirm your <strong>Connected App</strong>, <strong>Profile</strong>, and <strong>User</strong> are connected:<ul><li>Go to <strong>Setup</strong> > <strong>Apps</strong> > <strong>Connected Apps</strong> > <strong>Manage Connected Apps</strong> and choose your new app. Assign the <strong>Profile</strong> or <strong>Permission Set</strong> that contains your new user if it does not already show under the relevant section.<ul><li>Click <strong>Manage Profiles</strong> or <strong>Manage Permission Sets</strong></li><li>Search for your Profile or Permission Set and Save.</li></ul></li><li>In the Connect App Detail, click <strong>Edit Policies</strong>:<ul><li>Under <strong>OAuth Policies</strong> > <strong>Permitted Users</strong> choose <strong>Admin approved users are pre-authorized</strong>.</li><li>Check <strong>Issue JSON Web Token (JWT)-based access tokens</strong>.</li><li><strong>Save</strong> the Connected App details.</li></ul></li></ul></li></ol><p>> When the process is complete, you should have the following relationships between the <strong>User</strong>, <strong>Permission Set</strong> OR <strong>Profile</strong>, and <strong>Connected App</strong>:
> - the API <strong>User</strong> should be assigned the <strong>Permission Set</strong> OR <strong>Profile</strong>.
> - the <strong>Connected App</strong> should be assigned the same <strong>Permission Set</strong> OR <strong>Profile</strong>.</p><p>Review all of these steps carefully. Missing any of them can result in an inability to query the API.</p><h4 id=salesforce-permissions>Salesforce permissions<a class=td-heading-self-link href=#salesforce-permissions aria-label="Heading self-link"></a></h4><p>The Salesforce integration <strong>Permission Set</strong> OR <strong>Profile</strong> should have read access to all fields in the following objects:</p><ul><li>Course Options</li><li>Courses</li><li>Course Session Options</li><li>Course Sessions</li><li>Locations</li><li>Products and Discounts</li><li>Program Categories</li><li>Program Category Tags</li><li>Programs</li><li>Sessions</li></ul><p>If using a <strong>Profile</strong>, it should also have the following Systems Permissions:</p><ul><li>Apex REST Services</li><li>View Restriction and Scoping Rules</li><li>Update Consent Preferences Using REST API</li></ul><h3 id=configure-the-connection-in-drupal>Configure the connection in Drupal<a class=td-heading-self-link href=#configure-the-connection-in-drupal aria-label="Heading self-link"></a></h3><ol><li>Go to <strong>Admin</strong> > <strong>Configuration</strong> > <strong>System</strong> > <strong>Keys</strong> (<code>/admin/config/system/keys</code>) and create a new key to store the private key created above.<ul><li><strong>Add key</strong></li><li>Add a <strong>Key name</strong> and <strong>Description</strong></li><li>Choose <strong>Key Type</strong>: "TractionRec JWT Private Key"</li><li>Choose the <strong>Key provider</strong> depending on your configuration. See
<a href="https://www.drupal.org/project/key#:~:text=the%20encrypt%20module-,Managing%20keys,-Key%20provides%20an" target=_blank>Managing Keys</a> for details.</li><li>Configure the chosen provider then <strong>Save</strong> the key.</li></ul></li><li>Go to <strong>Admin</strong> > <strong>YMCA Website Services</strong> > <strong>Integrations</strong> > <strong>Traction Rec</strong> > <strong>Traction Rec auth settings</strong> (<code>/admin/openy/integrations/traction-rec/auth</code>) to configure the keys & secrets provided by Traction Rec.<ul><li>Add the <strong>Consumer key</strong> and <strong>Consumer Secret</strong> from <strong>Manage Consumer Details</strong> in Salesforce.</li><li>Add the <strong>User</strong> connected to the Connected App.<ul><li>This is the <strong>Username</strong> of the <strong>User</strong>, not the <strong>Contact email</strong>.</li></ul></li><li>Enter a <strong>Login URL</strong>.<ul><li>This will most likely be <code>https://login.salesforce.com</code></li></ul></li><li>Set the <strong>Services base URL</strong> and <strong>REST API Base URL</strong> as per their descriptions.<ul><li><strong>Ensure the REST API Base URL responds to <code>curl -I</code> with a <code>200</code> response</strong>. Replace URLs like <code>*.lightning.force.com</code> with <code>*.my.salesforce.com</code> because the <code>lightning</code> url may result in a redirect, which will cause an authentication error, like (<code>[@&amp;#34;message&amp;#34;:&amp;#34;Session expired or invalid&amp;#34;,&amp;#34;errorCode&amp;#34;:&amp;#34;INVALID_SESSION_ID&amp;#34;]</code>).</li></ul></li><li>Set the <strong>Community URL</strong> based on the publicly accessible registration links.<ul><li>This may be something like <code>https://my-ymca.my.site.com</code></li><li>The URL can be found in Salesforce under <strong>Setup</strong> > <strong>Digital Experiences</strong> > <strong>All Sites</strong>.</li></ul></li><li>Choose the key as configured above.</li></ul></li></ol><h2 id=mapping>Mapping<a class=td-heading-self-link href=#mapping aria-label="Heading self-link"></a></h2><p>The TractionRec importer pulls data from
<a href=#salesforce-permissions>many Traction Rec Objects</a> (see
<a href=https://github.com/YCloudYUSA/openy_traction_rec/blob/main/src/TractionRec.php target=_blank>TractionRec.php for the full queries</a>):</p><h3 id=object-mapping>Object Mapping<a class=td-heading-self-link href=#object-mapping aria-label="Heading self-link"></a></h3><p>The fetcher outputs these files:</p><ul><li><code>classes.json</code> - from Courses<ul><li>Maps to both Activities and Classes. Since TREC does not have this distinction, information in the resulting Activities and Classes in Drupal is duplicated.</li></ul></li><li><code>locations.json</code> - from Locations<ul><li>This file is unused, but Locations map to Location via the Session import.</li></ul></li><li><code>program_categories.json</code> - from Program Category Tags<ul><li>Maps to Program.</li></ul></li><li><code>programs.json</code> - from Programs<ul><li>Maps to Program Subcategory.</li></ul></li><li><code>sessions.json</code> - from Course Options<ul><li>Maps to Session.</li></ul></li></ul><p><strong>Note:</strong> Traction Rec's labels for "Programs" and their child groupings are different:</p><ul><li>Traction Rec: "Program Category" is the parent of "Program".</li><li>Drupal: "Program" is the parent of "Program Subcategory".</li></ul><h3 id=mapping-to-drupal-fields>Mapping to Drupal fields<a class=td-heading-self-link href=#mapping-to-drupal-fields aria-label="Heading self-link"></a></h3><p>Those files are then imported into Drupal content via
<a href=https://github.com/YCloudYUSA/openy_traction_rec/tree/main/modules/openy_traction_rec_import/config/install target=_blank>importers</a> (in config items that start with <code>migrate_plus.</code>). The import goes as follows:</p><p>> - Drupal Content Type (bundle)
> - <code>Salesforce/TractionRec source field</code> → <code>Drupal destination field</code></p><ul><li><strong>Program</strong> - from <code>programs.json</code> / TREC Program Categories<ul><li>Id → id</li><li>Name → Title</li><li>Available → Published (<code>status</code>)</li></ul></li><li><strong>Program Subcategory</strong> - from <code>program_categories.json</code>/ TREC Programs<ul><li>Id → id</li><li>Name → Title</li><li>Program → Program (<code>field_category_program</code>) via a lookup to the Programs import</li><li>Available → Published (<code>status</code>)</li></ul></li><li><strong>Activity</strong> - from <code>classes.json</code> / TREC Courses<ul><li>Id → id</li><li>Name → Title</li><li>Program/Id → Program Subcategory (<code>field_activity_category</code>) via a lookup to the Program Subcategory import</li><li>Available → Published (<code>status</code>)</li></ul></li><li><strong>Class</strong> - from <code>classes.json</code> / TREC Courses<ul><li>Id → id<ul><li>The Class Id will also be used to set the Activity (<code>field_class_activity</code>)</li></ul></li><li>Name → Title</li><li>Program/Id → <em>ignored</em></li><li>Description/Rich Description → Description (<code>field_class_description</code>)<ul><li>If a Rich Description is set, it will be used, otherwise the Description field will be used.</li></ul></li><li>Available → Published (<code>status</code>)</li></ul></li><li><strong>Session</strong> - from <code>sessions.json</code> / TREC Sessions<ul><li>Course_Option/Name → Title</li><li>Course_Option/ID → id<ul><li>Also used to generate the Registration link URL using the Community URL set in Traction Rec auth settings (<code>/admin/openy/integrations/traction-rec/auth</code>).</li></ul></li><li>Course_Session/Course/Id → Class</li><li>Course_Session/Course/Name → Course</li><li>Course_Session/Course/Description & Rich_Description → Description (<code>field_class_description</code>)<ul><li>If a Rich Description is set, it will be used, otherwise the Description field will be used.</li></ul></li><li>Course_Option/Start_Date → Session Time > Start date</li><li>Course_Option/Start_Time → Session Time > Start time</li><li>Course_Option/End_Date → Session Time > End date</li><li>Course_Option/End_Time → Session Time > End time</li><li>Course_Option/Day_of_Week → Session Time > Days</li><li>Course_Option/Age_Min → Min Age (<code>field_session_min_age</code>) converted to months</li><li>Course_Option/Age_Max → Max Age (<code>field_session_max_age</code>) converted to months</li><li>Course_Option/Location/Name → Location (<code>field_session_location</code>)<ul><li>Location Name is used as a backup in case the Location Mapping does not match.</li></ul></li><li>Course_Option/Location/Id → Location (<code>field_session_location</code>)<ul><li>Location ID is used to attempt to match a location in the Location mapping in the Traction Rec importer settings (<code>/admin/openy/integrations/traction-rec/importer</code>)</li></ul></li><li>Course_Option/Instructor → Instructor (<code>field_session_instructor</code>) trimmed to 255 characters</li><li>Course_Option/Available_Online → Online registration (<code>field_session_online</code>)</li><li>Course_Option/Available → Published (<code>status</code>)</li><li>Course_Option/Register_Online_From_Date → not used</li><li>Course_Option/Register_Online_To_Date → not used</li><li>Course_Option/Capacity → Initial Availability (<code>field_availability</code>)</li><li>Course_Option/Total_Capacity_Available → Initial Availability (<code>field_availability</code>)</li><li>Course_Option/Unlimited_Capacity → if set, overrides Capacity and sets Initial Availability (<code>field_availability</code>) to 100</li><li>Course_Option/Unlimited_Waitlist_Capacity → Wait list Unlimited Capacity (<code>waitlist_unlimited_capacity</code>)</li><li>Course_Option/Waitlist_Total → Wait list capacity (<code>waitlist_capacity</code>)</li><li>Course_Option/Product/Price_Description → Price description (<code>field_price_description</code>)</li><li>Course_Session/Id → Class (<code>field_session_class</code>) via a lookup to the Class import</li></ul></li></ul><h2 id=data-model>Data Model<a class=td-heading-self-link href=#data-model aria-label="Heading self-link"></a></h2><p>This module assumes a Traction Rec "standard" data model in its queries. Any deviations from this model will require overriding the queries in <code>src/TractionRec.php</code>.</p><p>This model contains a subset of the fields in Traction Rec that are relevant to our usage. All entities have more fields than listed.</p><p>Field types are taken from Salesforce's <strong>Setup</strong> > <strong>Object Manager</strong> > <strong>{Entity}</strong> > <strong>Fields & Relationships</strong>.</p><ul><li>Number field options are: <code>number(length_decimal places)</code></li></ul><pre class=mermaid>erDiagram
  Program_Category__c {
    id Id
    text(80) Name
  }
  Program__c {
    id Id
    text(80) Name
    checkbox Available__c
    textArea(255) Description__c
  }
  Program_Category_Tag__c {
    id Id
    autoNumber Name
    lookup(Program) Program__c
    lookup(Program_Category) Program_Category_c
  }
  Course__c {
    id Id
    text(80) Name
    checkbox Available__c
    text(128) Code__c
    longTextArea(640) Description__c
    lookup(Program) Program__c
    richTextArea Rich_Description__c
  }
  Course_Session__c {
    id Id
    text(80) Name
    checkbox Available__C
    text(128) Code__c
    lookup(Course) Course__c
    longTextArea(640) Description__c
    number(18_0) Num_Option_Entitlements__c
    lookup(ProductAndDiscount) Product__C
    richTextArea Rich_Description__c
    sum Total_Option_Capacity__c
    formula(number) Total_Option_Capacity_Remaining__C
    sum Total_Option_Registrants__c
    count Total_Options_Available__c
  }
  Course_Option__c {
    id Id
    text(80) Name
    number(3_1) Age_Max__c
    number(3_1) Age_Min__c
    checkbox Available__c
    number(18_0) Capacity__c
    picklist(multiSelect) Day_of_Week__c
    date End_Date__c
    text(8) End_Time__c
    text(128) Instructor__c
    lookup(ProductAndDiscount) Product__c
    number(18_0) Registration_Total_c
    longTextArea(3500) Setup_Notes__c
    number(3_0) Setup_Time_Required___c
    date Start_Date__c
    text(8) Start_Time__c
    longTextArea(3500) Tear_Down_Notes__c
    number(3_0) Tear_Down_Time_Required__C
  }
  Course_Session_Option__c {
    id Id
    autoNumber Name
    lookup(CourseOption) Course_Option__c
    masterDetail(CourseSession) Course_Session__c
    checkbox Option_Available__c
    number(18_0) Option_Capacity__c
    number(18_0) Option_Registration_Total__c
  }
  Program_Category__c ||--|{ Program_Category_Tag__c : &amp;#34;&amp;#34;
  Program__c ||--|{ Program_Category_Tag__c : &amp;#34;&amp;#34;
  Program__c ||--|{ Course__c : &amp;#34;&amp;#34;
  Course__c ||--|{ Course_Session__c : &amp;#34;&amp;#34;
  Course_Session__c ||--|{ Course_Session_Option__c : &amp;#34;&amp;#34;
  Course_Option__c ||--|{ Course_Session_Option__c : &amp;#34;&amp;#34;</pre><h2 id=import>Import<a class=td-heading-self-link href=#import aria-label="Heading self-link"></a></h2><p>The module allows you to synchronize classes and programs from the
<a href=https://www.tractionrec.com target=_blank>Traction Rec CRM</a> to the YMCA Website Services Program Event Framework (PEF).</p><p>It uses Migrate API to import data fetched from Traction Rec and provides Drush commands and a configuration UI.</p><p>The import process consists of 2 <code>drush</code> commands:</p><ol><li><p><code>openy-tr:fetch-all</code> this command fetches required data from Traction Rec and saves it to JSON files.</p><ul><li>Alias: <code>tr:fetch</code></li></ul></li><li><p><code>openy-tr:import</code> the command migrates fetched JSON files to YMCA Website Services and creates sessions, classes, activities, categories and programs.</p><ul><li>Alias: <code>tr:import</code></li></ul></li></ol><p>You can run the commands manually for one-time import or add both to cron jobs.</p><p>Other available <code>drush</code> commands:</p><ul><li><p><code>openy-tr:rollback</code> - Rolls back all imported nodes.</p><ul><li>Alias: <code>tr:rollback</code></li></ul></li><li><p><code>openy-tr:reset-lock</code> - Resets import lock.</p><ul><li>Alias: <code>tr:reset-lock</code></li></ul></li><li><p><code>openy-tr:clean-up</code> - Removes imported JSON files from the filesystem.</p><ul><li>Alias: <code>tr:clean-up</code></li></ul></li><li><p><code>openy-tr:quick-availability-sync</code> - Sync total availability data for sessions.</p><ul><li>Alias: <code>tr:qas</code></li></ul></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-541617a506b4363b56c7bcf59ec9f30a>36 - Pull Requests review standard</h1><p>Check more
<a href=/docs/development/code-review-quality-best-practices/>technical guidelines about our best practices for code quality</a>.</p><h1 id=adherence-to-standards>Adherence to Standards<a class=td-heading-self-link href=#adherence-to-standards aria-label="Heading self-link"></a></h1><p>The YMCA Website Services Core Team will adhere to the same standards we set for the community for all areas of development and technologies as per the YMCA Website Services documentation.</p><p>The YMCA Website Services Core Team reserves the right to break these standards only in the following scenarios:</p><ul><li>Emergency - a major defect or security risk has been discovered that requires extreme measures to resolve.</li><li>When the standards are broken, it is the responsibility of the YMCA Website Services Core Team to explain why the standards needed to be broken, and what the new standards will be moving forward.</li><li>This communication will be posted to the YMCA Website Services message board, Slack, and the documentation on GitHub will be updated to reflect the new standards.</li></ul><h2 id=requirements-for-pull-requests>Requirements for Pull Requests<a class=td-heading-self-link href=#requirements-for-pull-requests aria-label="Heading self-link"></a></h2><ul><li>Code in Pull Requests should follow our established
<a href=/docs/development/code-review-quality-best-practices/>best practices</a></li><li>Submitters&rsquo; profiles on GitHub or Drupal.org should be up to date and contain at least a name and organization.</li></ul><h2 id=template-for-the-pr>Template for the PR<a class=td-heading-self-link href=#template-for-the-pr aria-label="Heading self-link"></a></h2><p>In order to create a good quality Pull Request, we prepared a
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/.github/PULL_REQUEST_TEMPLATE.md target=_blank>PR template</a> which is automatically added to new Pull Requests on GitHub.</p><p>List of requirements from the template:</p><ul><li>Provide a link to the original issue, which is going to be fixed by the PR you are creating.</li><li>All coding styles are fulfilled and there are no issues reported by CodeSniffer. See
<a href=/docs/development/open-y-code-of-conduct-and-best-practices/>Code of Conduct</a>.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny/tree/9.x-2.x/docs target=_blank>Documentation</a> have been updated according to PR changes.</li><li><a href=https://github.com/YCloudYUSA/yusaopeny/pull/94#issue-204580200 target=_blank>Steps for review</a> have been provided according to PR changes.<br><img src=https://raw.githubusercontent.com/YCloudYUSA/yusaopeny/8.x-1.x/.github/assets/steps-for-review.png width=200 alt="Steps for review"></li><li>Make sure you&rsquo;ve provided all necessary hook_update_N to
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/docs/Development/Upgrade%20path.md target=_blank>support upgrade path</a>.</li><li>Make sure your git email is associated with an account on drupal.org, otherwise you won&rsquo;t get commits there.<br><img src=https://raw.githubusercontent.com/YCloudYUSA/yusaopeny/8.x-1.x/.github/assets/drupalorg-email.png width=200 alt="drupal.org email"></li><li>If you would like to get credits on drupal.org,
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/docs/Development/Contributing.md#drupalorg-credits target=_blank>check documentation</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4fec31bc5d3f3949a48b79b2c5d0264a>37 - Release processes</h1><h3 id=repos-involved-in-releases>Repos involved in releases<a class=td-heading-self-link href=#repos-involved-in-releases aria-label="Heading self-link"></a></h3><ol><li>YMCA Website Services Drupal Profile Distribution
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a></li><li>YMCA Website Services Project for initiating an YMCA Website Services instance -
<a href=https://github.com/YCloudYUSA/yusaopeny-project target=_blank>YCloudYUSA/yusaopeny-project</a></li><li>Continuous Integration/DevOps for rebuilding/installing YMCA Website Services -
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-build target=_blank>YCloudYUSA/yusaopeny-cibox-build</a></li><li>CIBox development environment (Virtualbox, Docker, Vagrant)
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>YCloudYUSA/yusaopeny-cibox-vm</a></li><li>Docksal development environment (Docker, VirtualBox) -
<a href=https://github.com/YCloudYUSA/yusaopeny-docksal target=_blank>YCloudYUSA/yusaopeny-docksal</a></li></ol><h3 id=release-management>Release Management<a class=td-heading-self-link href=#release-management aria-label="Heading self-link"></a></h3><p>When tagging a new release of YMCA Website Services, the Lead Architect takes the following steps:</p><ol><li>Review/Merge/Update
<a href=https://github.com/YCloudYUSA/yusaopeny-project target=_blank>YCloudYUSA/yusaopeny-project</a> (usually composer.json or/and oneline script install) and tag a new release there.</li><li>Review/Merge all Pull Requests in
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YCloudYUSA/yusaopeny</a> that were planned for release.</li><li>Change the YMCA Website Services version in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/openy.info.yml#L5 target=_blank><code>openy.info.yml</code></a>.</li><li>Change the YMCA Website Services version in major modules if there were changes to them (Activity Finder, PEF, etc).</li><li>Create Changelog release notes as a draft and include Contributors as well as major issues fixed/introduced.</li><li>Spin up a copy of an YMCA Website Services site and check top priority functionality for regressions.</li><li>Send for review to Core Team (Craig Paulnock, Paige Kiecker), get approval.</li><li>Change the YMCA Website Services version to next with -dev suffix for developers in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/8.x-2.x/openy.info.yml#L5 target=_blank><code>openy.info.yml</code></a>.</li><li>Refresh the YMCA Website Services private mirror on the <code>openy.cibox.tools</code> CI server.</li><li>Check that the
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.2.x/scripts/openyonclickinstall.sh target=_blank>one-click install</a> is working on a fresh DigitalOcean instance ($10: 1CPU 2Gb RAM). Ensure the version of YMCA Website Services is the proper one in site info (<code>admin/reports/status</code>).</li><li>Publish announcement in #developers YMCA Website Services Slack channel.</li><li>Publish announcement in #general YMCA Website Services Slack channel.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-d2ae48703454e5a7b7a33f10fe06c223>38 - Release Schedule and Guidelines</h1><h2 id=ymca-website-services-release-guidelines>YMCA Website Services Release Guidelines<a class=td-heading-self-link href=#ymca-website-services-release-guidelines aria-label="Heading self-link"></a></h2><p>YMCA Website Services releases major releases of the base project
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>YMCA Website Services</a> and
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content target=_blank>Virtual Y</a> quarterly. Minor releases and sub-project releases occur as needed.</p><h3 id=major-releases-quarterly>Major releases (Quarterly)<a class=td-heading-self-link href=#major-releases-quarterly aria-label="Heading self-link"></a></h3><p>Major releases are scheduled for the second Tuesday of the second month of each quarter (February, May, August, November). They are numbered <code>2.x</code> and consist of:</p><ul><li>New Features</li><li>New Enhancements</li><li>New Bugfixes</li></ul><h3 id=minor-releases>Minor Releases<a class=td-heading-self-link href=#minor-releases aria-label="Heading self-link"></a></h3><p>Minor releases are numbered <code>2.x.x</code> and consist of</p><ul><li>Only bugfixes</li><li>Never have new features or major enhancements</li></ul><h3 id=release-schedule>Release schedule<a class=td-heading-self-link href=#release-schedule aria-label="Heading self-link"></a></h3><h4 id=2021>2021<a class=td-heading-self-link href=#2021 aria-label="Heading self-link"></a></h4><p><img src=https://user-images.githubusercontent.com/563412/104428684-6fd65800-558d-11eb-93b3-5c63e92ccd56.png alt="OpenY/VirtualY Releases for 2021"></p><h4 id=prior-years>Prior years<a class=td-heading-self-link href=#prior-years aria-label="Heading self-link"></a></h4><ul><li><a href=https://user-images.githubusercontent.com/238201/146017405-10f28823-5af7-4498-9384-5502cbf5adaf.png target=_blank>YMCA Website Services releases for 2018-2019</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-18ec7b7f0e48493342dfc92282bc850f>39 - SA-CORE-2018-002 security update</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/development/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>To update your OpenY site with security fix from Drupal core
<a href=https://www.drupal.org/sa-core-2018-002 target=_blank>https://www.drupal.org/sa-core-2018-002</a>
OpenY team is suggesting 2 options- via patch and via Drupal core upgrade(or OpenY upgrade).
Drupal core upgrade or OpenY upgrade is not always possible, but security issue should be fixed asap.
So consider to apply patch and plan OpenY upgrade later.</p><h3 id=how-to-apply-patch>How to apply patch<a class=td-heading-self-link href=#how-to-apply-patch aria-label="Heading self-link"></a></h3><h3 id=patching-openy-releases-801---810-drupal-core-82x>Patching OpenY releases 8.0.1 - 8.1.0 (Drupal core 8.2.x)<a class=td-heading-self-link href=#patching-openy-releases-801---810-drupal-core-82x aria-label="Heading self-link"></a></h3><p>For patching your very old OpenY release it is highly recommended to upgrade OpenY to latest version or at least to one of the 8.1.1-8.1.6 (Drupal core 8.3.x) with Drupal core upgrade to 8.3.9
<a href=https://www.drupal.org/project/drupal/releases/8.3.9 target=_blank>https://www.drupal.org/project/drupal/releases/8.3.9</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial - you should:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/html
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.2.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 --dry-run &lt; 8.2.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># patch -p1 --dry-run &lt; 8.2.x.patch</span>
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 &lt; 8.2.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span class=o>&amp;&amp;</span> git commit -m <span class=s2>&#34;Patching OpenY core&#34;</span> <span class=o>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><h3 id=patching-openy-releases-811---816-drupal-core-83x>Patching OpenY releases 8.1.1 - 8.1.6 (Drupal core 8.3.x)<a class=td-heading-self-link href=#patching-openy-releases-811---816-drupal-core-83x aria-label="Heading self-link"></a></h3><p>For patching your relatively old OpenY release it is highly recommended to upgrade OpenY to latest version or at least to one of the 8.1.7-8.1.10 (Drupal core 8.4.x) with Drupal core upgrade to 8.4.6
<a href=https://www.drupal.org/project/drupal/releases/8.4.6 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.6</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial - you should:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/html
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.3.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 --dry-run &lt; 8.3.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># patch -p1 --dry-run &lt; 8.3.x.patch</span>
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 &lt; 8.3.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span class=o>&amp;&amp;</span> git commit -m <span class=s2>&#34;Patching OpenY core&#34;</span> <span class=o>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><h3 id=patching-openy-releases-817---819-drupal-core-84x>Patching OpenY releases 8.1.7 - 8.1.9 (Drupal core 8.4.x)<a class=td-heading-self-link href=#patching-openy-releases-817---819-drupal-core-84x aria-label="Heading self-link"></a></h3><p>For patching your OpenY release it is highly recommended to upgrade OpenY to latest version (8.1.10 or never) or at least to one of the 8.1.10 (Drupal core 8.4.x) with Drupal core upgrade to 8.4.6
<a href=https://www.drupal.org/project/drupal/releases/8.4.6 target=_blank>https://www.drupal.org/project/drupal/releases/8.4.6</a> . In case if it is not possible right now, follow steps below:</p><ul><li>Login to your production server environment via SSH and find <code>docroot</code> folder of your site codebase. If you installed OpenY by following a tutorial - you should:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>ssh -l root YOUR_SERVER_DOMAIN_NAME
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/html
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/8.4.x.patch
</span></span></code></pre></div><p>Now you are ready to patch your site. But before patching - make a backup of the file which is about to be patched</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cp docroot/core/lib/Drupal/Core/DrupalKernel.php /var/backups/DrupalKernel.php
</span></span></code></pre></div><p>To patch your site run the command to test if the patch can be applied:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 --dry-run &lt; 8.4.x.patch
</span></span></code></pre></div><p>You should see a result</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># patch -p1 --dry-run &lt; 8.4.x.patch</span>
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/DrupalKernel.php
</span></span><span class=line><span class=cl>checking file docroot/core/lib/Drupal/Core/Security/RequestSanitizer.php
</span></span></code></pre></div><p>In case if result different - stop on this step and let us know you have issue.
In case if all good proceed with a command below, which will patch your site:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>patch -p1 &lt; 8.4.x.patch
</span></span></code></pre></div><p>You should see the same output as previously, but now your site is patched.</p><p>TIP: In case if you are using git repository for your site run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git add docroot/core/lib/Drupal/Core/DrupalKernel.php docroot/core/lib/Drupal/Core/Security <span class=o>&amp;&amp;</span> git commit -m <span class=s2>&#34;Patching OpenY core&#34;</span> <span class=o>&amp;&amp;</span> git push
</span></span></code></pre></div><p>to store your patched core into your own repository.</p><p>==========================</p><h3 id=how-to-patch-your-digitalocean-openy-install>How to patch your Digitalocean OpenY install<a class=td-heading-self-link href=#how-to-patch-your-digitalocean-openy-install aria-label="Heading self-link"></a></h3><p>In case if you have followed tutorial you should have your OPenY installed on you DigitalOcean server(droplet) in a predictable for current document folder. That&rsquo;s why we prepared a short how to patch your OpenY site in a most simple way if you are not a Tech Guru, but just a user</p><ol><li>Log in as an admin user to your site admin UI by visiting <code>/user/login</code> URI page.</li><li>Go to <code>/admin/reports/status</code> after login and search for Drupal Version string. It should be something like 8.2.x, 8.3.x or 8.4.x (x - some number too, like 8.4.2, for example). Based on your finding follow the steps below to your version</li><li>Login to your ВigitalOcean cloud console at digitalocean.com and find Access Console in the dropdown for the droplet you are using for the OpenY
<img src=https://user-images.githubusercontent.com/563412/38104705-b2ebf8fe-3392-11e8-8c27-55db3ed032ff.png alt=image></li><li>You should see a popup window with a black screen where console asks you for the login. Use <code>root</code> user and a password generated for you upon droplet creation.</li><li>After login to a console run the command below, respectively to the version of your Drupal core.</li></ol><h3 id=one-line-script-to-patch-82x-drupal-core-for-openy>One line script to patch 8.2.x Drupal core for OpenY<a class=td-heading-self-link href=#one-line-script-to-patch-82x-drupal-core-for-openy aria-label="Heading self-link"></a></h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bash &lt; &lt;<span class=o>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.2.x.sh<span class=o>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p><h3 id=one-line-script-to-patch-83x-drupal-core-for-openy>One line script to patch 8.3.x Drupal core for OpenY<a class=td-heading-self-link href=#one-line-script-to-patch-83x-drupal-core-for-openy aria-label="Heading self-link"></a></h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bash &lt; &lt;<span class=o>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.3.x.sh<span class=o>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p><h3 id=one-line-script-to-patch-84x-drupal-core-for-openy>One line script to patch 8.4.x Drupal core for OpenY<a class=td-heading-self-link href=#one-line-script-to-patch-84x-drupal-core-for-openy aria-label="Heading self-link"></a></h3><p>Type manually exact line</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bash &lt; &lt;<span class=o>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/patches/run8.2.x.sh<span class=o>)</span>
</span></span></code></pre></div><p>and hit Enter.
You should see <code>OpenY was patched</code> message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3e458c8850b84d0f6330b82b6e574591>40 - Sandboxes</h1><div class=lead>YMCA Website Services Sandboxes for Evaluation and QA</div><p>The YMCA Website Services core team manages sandboxes for various configurations of the distribution to facilitate evaluation, to help with QA, and enable investigation of issues.</p><h2 id=getting-started>Getting started<a class=td-heading-self-link href=#getting-started aria-label="Heading self-link"></a></h2><p>Anyone can browse the sandboxes. Get started at
<a href=https://sandboxes.y.org/ target=_blank>sandboxes.y.org</a>.</p><h3 id=get-access-to-the-sandboxes>Get access to the sandboxes<a class=td-heading-self-link href=#get-access-to-the-sandboxes aria-label="Heading self-link"></a></h3><p>To test the content editor experience or dig into the Drupal configuration you need to request login access by
<a href="mailto:ycloud@ymca.net?subject=Sandbox%20Access%20Request">emailing us</a> or asking anyone on the project team in the Y-USA Slack.</p><h3 id=behind-the-scenes>Behind the scenes<a class=td-heading-self-link href=#behind-the-scenes aria-label="Heading self-link"></a></h3><p>To learn more:</p><ul><li>Watch a
<a href="https://www.youtube.com/watch?v=dS-8-t0WJgo" target=_blank>detailed video about the process of building the sandboxes</a></li><li>Read a
<a href=https://www.drupal.org/case-study/open-y-sandboxes target=_blank>case study on Drupal.org</a></li></ul><h2 id=whats-in-the-sandboxes>What&rsquo;s in the sandboxes?<a class=td-heading-self-link href=#whats-in-the-sandboxes aria-label="Heading self-link"></a></h2><p>Each set of sandboxes contains 3 profile variations:</p><ul><li>Standard</li><li>Extended</li><li>Custom</li></ul><p>And three themes:</p><ul><li>Carnation</li><li>Lily</li><li>Rose</li></ul><p>And there are multiple sandbox environments:</p><h3 id=stable-sandboxes>Stable Sandboxes<a class=td-heading-self-link href=#stable-sandboxes aria-label="Heading self-link"></a></h3><p><a href=https://sandboxes.y.org/ target=_blank>sandboxes.y.org</a></p><p>These sandboxes are based on the latest
<a href=https://github.com/YCloudYUSA/yusaopeny/releases target=_blank>stable release</a> of YMCA Website Services. They are set to rebuild completely overnight and clear their database and files every 2 hours.</p><details><summary>These sandboxes are built on CI by running:</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project buildnew --no-interaction --prefer-dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ansible-playbook docroot/reinstall.yml -i /tmp/inventory5068801741271597001.ini -f <span class=m>5</span> -e <span class=nv>php_env_vars</span><span class=o>=</span><span class=nv>APP_ENV</span><span class=o>=</span>dev -e <span class=nv>mysql_user</span><span class=o>=</span>*** -e <span class=nv>mysql_password</span><span class=o>=</span>*** -e <span class=nv>mysql_db</span><span class=o>=</span>sandbox_carnation_custom -e <span class=nv>drupal_folder</span><span class=o>=</span>/var/www/sandbox_carnation_custom -e <span class=nv>site_url</span><span class=o>=</span>https://sandbox-carnation-cus.y.org -e <span class=nv>pp_environment</span><span class=o>=</span>demo -e <span class=nv>run_reinstall</span><span class=o>=</span><span class=nb>true</span> -e <span class=s2>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -e <span class=nv>use_solr</span><span class=o>=</span><span class=nb>false</span> -i localhost, --connection<span class=o>=</span><span class=nb>local</span> -vvvv
</span></span></code></pre></div></details><h3 id=development-sandboxes>Development Sandboxes<a class=td-heading-self-link href=#development-sandboxes aria-label="Heading self-link"></a></h3><ul><li><a href=https://sandboxes-dev.y.org/ target=_blank>sandboxes-dev.y.org</a></li><li><a href=https://sandboxes-d9.y.org/ target=_blank>sandboxes-d9.y.org</a></li><li><a href=https://sandboxes-dev-php8.y.org/ target=_blank>sandboxes-dev-php8.y.org</a></li></ul><p>These sandboxes are based on the
<a href=https://github.com/YCloudYUSA/yusaopeny target=_blank>latest development version</a> of YMCA Website Services or other branches as necessary. They are set to rebuild daily. Development sandboxes are rebuilt at the needs of the team and are not guaranteed. If one is not working, try another.</p><details><summary>These sandboxes are built on CI by running:</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development buildnew --no-interaction --prefer-dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ansible-playbook docroot/reinstall.yml -i /tmp/inventory5068801741271597001.ini -f <span class=m>5</span> -e <span class=nv>php_env_vars</span><span class=o>=</span><span class=nv>APP_ENV</span><span class=o>=</span>dev -e <span class=nv>mysql_user</span><span class=o>=</span>*** -e <span class=nv>mysql_password</span><span class=o>=</span>*** -e <span class=nv>mysql_db</span><span class=o>=</span>sandbox_carnation_custom -e <span class=nv>drupal_folder</span><span class=o>=</span>/var/www/sandbox_carnation_custom -e <span class=nv>site_url</span><span class=o>=</span>https://sandbox-carnation-cus.y.org -e <span class=nv>pp_environment</span><span class=o>=</span>demo -e <span class=nv>run_reinstall</span><span class=o>=</span><span class=nb>true</span> -e <span class=s2>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -e <span class=nv>use_solr</span><span class=o>=</span><span class=nb>false</span> -i localhost, --connection<span class=o>=</span><span class=nb>local</span> -vvvv
</span></span></code></pre></div></details><h2 id=feature-based-sandboxes>Feature-based sandboxes<a class=td-heading-self-link href=#feature-based-sandboxes aria-label="Heading self-link"></a></h2><p>We also maintain sandboxes with specific features enabled. Each of these builds</p><h3 id=virtual-y-sandboxes>Virtual Y Sandboxes<a class=td-heading-self-link href=#virtual-y-sandboxes aria-label="Heading self-link"></a></h3><ul><li><a href=https://virtual-y-sandboxes.y.org/ target=_blank>virtual-y-sandboxes.y.org</a>: latest release</li><li><a href=https://virtual-y-sandboxes-d9.y.org/ target=_blank>virtual-y-sandboxes-d9.y.org</a>: development version</li></ul><p>These sandboxes are based on the YMCA Website Services stable Standard profile and the
<a href=https://github.com/YCloudYUSA/yusaopeny_gated_content target=_blank>Virtual Experience Platform</a> (aka &ldquo;Virtual Y&rdquo;, aka &ldquo;Open Y Gated Content&rdquo;) project.</p><h3 id=membership-framework-sandboxes>Membership Framework Sandboxes<a class=td-heading-self-link href=#membership-framework-sandboxes aria-label="Heading self-link"></a></h3><ul><li><a href=https://membership-framework-sandboxes-d9.y.org/ target=_blank>membership-framework-sandboxes.y.org</a>: latest release</li><li><a href=https://membership-framework-sandboxes-d9.y.org/ target=_blank>membership-framework-sandboxes-d9.y.org</a>: development version</li></ul><p>These are based on the YMCA Website Services stable Standard profile and the development version of the
<a href=https://github.com/YCloudYUSA/yusaopeny_memberships target=_blank>Membership Framework</a>.</p><details><summary>To rebuild the sandbox, CI is running:</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project buildnew --no-interaction --prefer-dist
</span></span><span class=line><span class=cl><span class=nb>cd</span> buildnew
</span></span><span class=line><span class=cl>composer config minimum-stability dev
</span></span><span class=line><span class=cl>composer require <span class=s2>&#34;openy/openy_memberships&#34;</span>:<span class=s2>&#34;dev-master as 1.0.0&#34;</span>
</span></span><span class=line><span class=cl>ansible-playbook docroot/reinstall.yml -i /tmp/inventory13097841656330601319.ini -f <span class=m>5</span> -e <span class=nv>php_env_vars</span><span class=o>=</span><span class=nv>APP_ENV</span><span class=o>=</span>dev -e <span class=nv>mysql_user</span><span class=o>=</span>*** -e <span class=nv>mysql_password</span><span class=o>=</span>*** -e <span class=nv>mysql_db</span><span class=o>=</span>d9_sandbox_carnation_std_membership_framework -e <span class=nv>drupal_folder</span><span class=o>=</span>/var/www/d9_sandbox_carnation_std_membership_framework -e <span class=nv>site_url</span><span class=o>=</span>https://sandbox-carnation-std-membership-framework-d9.y.org -e <span class=nv>pp_environment</span><span class=o>=</span>membership_framework -e <span class=nv>run_reinstall</span><span class=o>=</span><span class=nb>true</span> -e <span class=s2>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=standard openy_theme_select.theme=openy_carnation openy_select_content.content=0&#39;&#34;</span> -e <span class=nv>use_solr</span><span class=o>=</span><span class=nb>false</span> -i localhost, --connection<span class=o>=</span><span class=nb>local</span> -vvvv
</span></span></code></pre></div></details><h3 id=activity-finder-sandboxes>Activity Finder Sandboxes<a class=td-heading-self-link href=#activity-finder-sandboxes aria-label="Heading self-link"></a></h3><table><thead><tr><th>Theme</th><th>Link</th><th>WS Profile</th><th>Activity Finder</th><th>Theme</th><th>Bootstrap</th><th></th></tr></thead><tbody><tr><td>Carnation</td><td><a href=https://sandbox-carnation-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-carnation-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v4</td><td></td></tr><tr><td>Carnation (with TractionRec importer)</td><td><a href=https://traction-ws.y.org/ target=_blank>https://traction-ws.y.org/</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v4</td><td></td></tr><tr><td>Rose</td><td><a href=https://sandbox-rose-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-rose-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v3</td><td></td></tr><tr><td>Lily</td><td><a href=https://sandbox-lily-cus-d9.y.org/activity-finder-v4 target=_blank>https://sandbox-lily-cus-d9.y.org/activity-finder-v4</a></td><td>stable</td><td>Custom</td><td>v4 dev</td><td>v3</td><td></td></tr></tbody></table><details><summary>To rebuild the sandbox, CI is running:</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project:dev-9.2.x-development-af4 build --no-interaction --prefer-dist
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=si>${</span><span class=nv>WORKSPACE</span><span class=si>}</span>/build
</span></span><span class=line><span class=cl>composer require YCloudYUSA/yusaopeny_activity_finder:<span class=s2>&#34;4.x-dev as 4.0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ansible-playbook docroot/reinstall.yml -i /tmp/inventory4660848605526222353.ini -f <span class=m>5</span> -e <span class=nv>php_env_vars</span><span class=o>=</span><span class=nv>APP_ENV</span><span class=o>=</span>dev -e <span class=nv>mysql_user</span><span class=o>=</span>*** -e <span class=nv>mysql_password</span><span class=o>=</span>*** -e <span class=nv>mysql_db</span><span class=o>=</span>d9_sandbox_carnation_custom -e <span class=nv>drupal_folder</span><span class=o>=</span>/var/www/d9_sandbox_carnation_custom -e <span class=nv>site_url</span><span class=o>=</span>https://sandbox-carnation-cus-d9.y.org -e <span class=nv>pp_environment</span><span class=o>=</span>demo -e <span class=nv>run_reinstall</span><span class=o>=</span><span class=nb>true</span> -e <span class=s2>&#34;openy_profile_install_settings=&#39;openy_configure_profile.preset=complete openy_theme_select.theme=openy_carnation&#39;&#34;</span> -i localhost, --connection<span class=o>=</span><span class=nb>local</span> -vvvv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Solr 4.5-4.9, Activity Finder v4</span>
</span></span><span class=line><span class=cl>drush en -y search_api_solr_legacy openy_prgf_activity_finder_4 <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.host 127.0.0.1 -y <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.core <span class=si>${</span><span class=nv>VHOST_FOLDER</span><span class=si>}</span> -y
</span></span><span class=line><span class=cl>drush cset -y search_api.server.solr backend_config.connector_config.solr_version 4.5 -y
</span></span><span class=line><span class=cl>drush search-api-mark-all <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush sapi-i <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush en -dvy openy_prgf_af4_demo <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Solr 4.5-4.9, Activity Finder v4, Carnation theme, bootstrap v4</span>
</span></span><span class=line><span class=cl>drush cset -y openy_activity_finder.settings bs_version <span class=m>4</span> <span class=o>||</span> <span class=nb>true</span>
</span></span></code></pre></div></details></div><div class=td-content style=page-break-before:always><h1 id=pg-634b272db567df243c17992d22637c3e>41 - Secure devops for composer 2 release</h1><p>This article only applies to long-term users of YMCA Website Services. YMCA Website Services supports Composer 2
<a href=https://github.com/YCloudYUSA/yusaopeny/releases/tag/8.2.7 target=_blank>as of version 8.2.7 in November 2020</a> and new installs use Composer 2 by default.</p><hr><p>Composer was upgraded to <code>2.x</code> on October 30, 2020. This could cause instability when your older composer <code>1.x</code> accidentally auto-updates to the <code>2.x</code> version. Issues could include: composer fails to run any commands and blocks OpenY upgrade/maintenance. The instability would be in the developer environment, not YMCA Website Services/Drupal.</p><p>The YMCA Website Services team prepared an avoidance plan for the community to take action steps before the release while YMCA Website Services will be verifying Composer <code>2.x</code> causes no issues or regressions.</p><p>If you use Docksal or Vagrant local environments your composer version will not update automatically, so you&rsquo;re currently safe from inadvertent updates. Instructions for updating those environments will be included with any necessary YMCA Website Services updates at a later date.</p><h3 id=case-before-october-30-2020-when-you-are-on-composer-1x>Case before October 30, 2020, when you are on composer 1.x<a class=td-heading-self-link href=#case-before-october-30-2020-when-you-are-on-composer-1x aria-label="Heading self-link"></a></h3><p>Composer 2 is coming and older versions of composer <code>1.x</code> show the message below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Composer 2.0 is about to be released and the older 1.x releases will self-update directly to it once it is released. To avoid surprises update now to the latest 1.x version
</span></span></code></pre></div><p>If you see the message above, ensure your environments have updated composer to the latest <code>1.x</code> version by running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer selfupdate --1
</span></span></code></pre></div><p>To ensure the above command shows your version <code>1.x</code> after an upgrade, check the version of composer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer --version
</span></span></code></pre></div><p>You should see something like</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>MacBook-Pro-Andrii:www podarok$ composer --version
</span></span><span class=line><span class=cl>Composer version 1.10.15 2020-10-13 15:59:09
</span></span></code></pre></div><p>as an output of the command.</p><h3 id=if-you-do-not-upgrade-to-the-latest-1x-version-before-october-30-2020-ie-if-you-accidentally-upgrade-to-composer-2x>If you do not upgrade to the latest 1.x version before October 30, 2020. i.e. if you accidentally upgrade to Composer 2.x<a class=td-heading-self-link href=#if-you-do-not-upgrade-to-the-latest-1x-version-before-october-30-2020-ie-if-you-accidentally-upgrade-to-composer-2x aria-label="Heading self-link"></a></h3><p>If your composer updated to version 2 and you have issues with this upgrade, the solution is to downgrade Composer to the latest <code>1.x</code> version by running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer selfupdate --1
</span></span></code></pre></div><p>If you are faced with any issues connect with the YMCA Website Services team on GitHub (
<a href=https://github.com/YCloudYUSA/yusaopeny/issues/new target=_blank>create issue</a>) and the #developers channel
<a href="mailto:ycloud@ymca.net?subject=Slack%20Access%20Request">on Slack</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8d4cd1fe848b513772e1d10d2af1b2d2>42 - Server Requirements</h1><p>If you need to prepare server for the YMCA Website Services instance, here below you should find all needed software to meet its requirements.</p><h3 id=list-of-requirements>List of requirements<a class=td-heading-self-link href=#list-of-requirements aria-label="Heading self-link"></a></h3><ol><li><p>Ubuntu LTS (14 or 16) is preferred. CentOS is ok as well. Or even any other Linux distribution, but was not tested by YMCA Website Services team so far.</p></li><li><p>(Drupal 8 server requirements should be met)[https://www.drupal.org/docs/system-requirements/php-requirements].</p></li><li><p>PHP 5.6+ (PHP 7 is better in terms of performance)</p></li></ol><h3 id=list-of-php-modules-server-should-have>List of PHP modules server should have:<a class=td-heading-self-link href=#list-of-php-modules-server-should-have aria-label="Heading self-link"></a></h3><ul><li>php{{ php_version }}</li><li>php{{ php_version }}-mcrypt</li><li>php{{ php_version }}-cli</li><li>php{{ php_version }}-common</li><li>php{{ php_version }}-curl</li><li>php{{ php_version }}-dev</li><li>php{{ php_version }}-fpm</li><li>php{{ php_version }}-gd</li><li>php{{ php_version }}-mysql</li><li>php{{ php_version }}-memcached</li><li>php{{ php_version }}-imagick</li><li>php{{ php_version }}-xml</li><li>php{{ php_version }}-xdebug</li><li>php{{ php_version }}-mbstring</li><li>php{{ php_version }}-soap</li><li>php{{ php_version }}-zip</li></ul><ol start=4><li>MySQL 5.5+ . Here are the best settings
<a href=https://github.com/cibox/cibox/blob/master/core/facade-mysql/defaults/main.yml target=_blank>https://github.com/cibox/cibox/blob/master/core/facade-mysql/defaults/main.yml</a> to get it fast and furious</li><li>Apache 2 with mod-php (preffered for stability) or nginx with php-fpm (better for speed and scalability)</li></ol><ul><li>libapache2-mod-php{{ php_version }}</li></ul><ol start=6><li><p>Memcache server (optional)</p></li><li><p>Server tools</p></li></ol><ul><li>Ansible (optional)</li><li>Docker (optional)</li><li>SOLR 4.x (if there will be requirement for SOLR search support)</li><li>Varnish (optional)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-927b4dc0cbf26cc50923ce4b32e9704a>43 - Smoke Tests Index</h1><h2 id=smoke-tests-in-core-and-dependencies>Smoke tests in core and dependencies<a class=td-heading-self-link href=#smoke-tests-in-core-and-dependencies aria-label="Heading self-link"></a></h2><ul><li><a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/SMOKE_TESTS.md target=_blank>YMCA Website Services core tests and dependencies</a></li><li><a href=https://github.com/open-y-subprojects/openy_node_alert/blob/main/SMOKE_TESTS.md target=_blank>Alert Application</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny_gated_content/blob/master/SMOKE_TESTS.md target=_blank>Virtual Y Application</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny_activity_finder/blob/4.x/openy_af_vue_app/SMOKE_TESTS.md target=_blank>Activity Finder v3</a></li></ul><h2 id=ymca-website-services-features>YMCA Website Services Features<a class=td-heading-self-link href=#ymca-website-services-features aria-label="Heading self-link"></a></h2><ul><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_loc_finder/SMOKE_TESTS.md target=_blank>Location Finder Application</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_small_banner/SMOKE_TESTS.md target=_blank>Small Banner</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_banner/SMOKE_TESTS.md target=_blank>Banner</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_simple_content/SMOKE_TESTS.md target=_blank>Simple Content</a></li><li><a href=https://github.com/open-y-subprojects/openy_features/blob/main/openy_prgf/modules/openy_prgf_grid_content/SMOKE_TESTS.md target=_blank>Grid Content</a></li><li><a href=https://git.drupalcode.org/project/groupexpro/-/blob/main/modules/embedded_groupexpro_schedule/SMOKE_TESTS.md target=_blank>Embedded GroupEx Pro Schedule</a></li><li><a href=https://github.com/YCloudYUSA/yusaopeny/blob/9.x-2.x/modules/custom/openy_search/SMOKE_TESTS.md target=_blank>YMCA Website Services Search</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-de155b22fcc9252bfab1ce44463bf1f3>44 - Start new YMCA Website Services project</h1><p>Here you can find instructions how you can start project based on YMCA Website Services distribution.</p><h2 id=new-project-from-scratch-based-on-ymca-website-services>New project from scratch based on YMCA Website Services<a class=td-heading-self-link href=#new-project-from-scratch-based-on-ymca-website-services aria-label="Heading self-link"></a></h2><p>In order to start new project from scratch, you can use
<a href=https://github.com/YCloudYUSA/yusaopeny-project#installation target=_blank>installation instructions</a> that will build your project and even add development environment.</p><h2 id=add-ymca-website-services-to-existing-drupal-8-project>Add YMCA Website Services to existing Drupal 8 project<a class=td-heading-self-link href=#add-ymca-website-services-to-existing-drupal-8-project aria-label="Heading self-link"></a></h2><p>Please take a look at the full <code>composer.json</code> file below that you should eventually get.</p><details> <summary><strong>Example composer.json (Drupal 8.3.2 + YMCA Website Services 1.2)</strong></summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal/drupal&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Drupal is an open source content management platform powering millions of websites and applications.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;project&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;license&#34;</span><span class=p>:</span> <span class=s2>&#34;GPL-2.0+&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;require&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;composer/installers&#34;</span><span class=p>:</span> <span class=s2>&#34;^1.0.24&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;wikimedia/composer-merge-plugin&#34;</span><span class=p>:</span> <span class=s2>&#34;~1.4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;YCloudYUSA/yusaopeny&#34;</span><span class=p>:</span> <span class=s2>&#34;8.*.*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;cweagans/composer-patches&#34;</span><span class=p>:</span> <span class=s2>&#34;~1.0&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;minimum-stability&#34;</span><span class=p>:</span> <span class=s2>&#34;dev&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;prefer-stable&#34;</span><span class=p>:</span> <span class=bp>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;preferred-install&#34;</span><span class=p>:</span> <span class=s2>&#34;dist&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;autoloader-suffix&#34;</span><span class=p>:</span> <span class=s2>&#34;Drupal8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;secure-http&#34;</span><span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;extra&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;_readme&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;By default Drupal loads the autoloader from ./vendor/autoload.php.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;To change the autoloader you can edit ./autoload.php.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;This file specifies the packages.drupal.org repository.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;You can read more about this composer repository at:&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;https://www.drupal.org/node/2718229&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;merge-plugin&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;include&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;core/composer.json&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;recurse&#34;</span><span class=p>:</span> <span class=bp>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;replace&#34;</span><span class=p>:</span> <span class=bp>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;merge-extra&#34;</span><span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;installer-paths&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;core&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-core&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;libraries/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-library&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;modules/contrib/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-module&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;profiles/contrib/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-profile&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;themes/contrib/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-theme&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;drush/contrib/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-drush&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;modules/custom/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-custom-module&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;themes/custom/{$name}&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;type:drupal-custom-theme&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;enable-patching&#34;</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;autoload&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;psr-4&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Drupal\Core\Composer</span><span class=se>\&#34;</span><span class=s2>: &#34;</span><span class=n>core</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>Drupal</span><span class=o>/</span><span class=n>Core</span><span class=o>/</span><span class=n>Composer</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;pre-autoload-dump&#34;</span><span class=p>:</span> <span class=s2>&#34;Drupal\Core\Composer\Composer::preAutoloadDump&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post-autoload-dump&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;Drupal\Core\Composer\Composer::ensureHtaccess&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post-package-install&#34;</span><span class=p>:</span> <span class=s2>&#34;Drupal\Core\Composer\Composer::vendorTestCodeCleanup&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post-package-update&#34;</span><span class=p>:</span> <span class=s2>&#34;Drupal\Core\Composer\Composer::vendorTestCodeCleanup&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post-install-cmd&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;bash scripts/remove_vendor_git_folders.sh || :&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post-update-cmd&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;bash scripts/remove_vendor_git_folders.sh || :&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;composer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://packages.drupal.org/8&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-kenwheeler/slick&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.6.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/kenwheeler/slick&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;git&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;reference&#34;</span><span class=p>:</span> <span class=s2>&#34;1.6.0&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-dinbror/blazy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.8.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/dinbror/blazy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;git&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;reference&#34;</span><span class=p>:</span> <span class=s2>&#34;1.8.2&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-gdsmith/jquery.easing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.4.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/gdsmith/jquery.easing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;git&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;reference&#34;</span><span class=p>:</span> <span class=s2>&#34;1.4.1&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-enyo/dropzone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;4.3.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/enyo/dropzone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;git&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;reference&#34;</span><span class=p>:</span> <span class=s2>&#34;v4.3.0&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-jaypan/jquery_colorpicker&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;source&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/jaypan/jquery_colorpicker&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;git&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;reference&#34;</span><span class=p>:</span> <span class=s2>&#34;da978ae124c57817021b3166a31881876882f5f9&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-ckeditor/panelbutton&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;4.7.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;dist&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://download.ckeditor.com/panelbutton/releases/panelbutton_4.7.0.zip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-ckeditor/colorbutton&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;4.7.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;dist&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://download.ckeditor.com/colorbutton/releases/colorbutton_4.7.0.zip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-ckeditor/colordialog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;4.7.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;dist&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://download.ckeditor.com/colordialog/releases/colordialog_4.7.0.zip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;library-ckeditor/glyphicons&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;2.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;drupal-library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;dist&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://download.ckeditor.com/glyphicons/releases/glyphicons_2.2.zip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></details><ol><li><p>Add <code>"YCloudYUSA/yusaopeny": "8.*.*"</code> to the <code>require</code> section in your <code>composer.json</code>, like
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L7 target=_blank>here</a></p></li><li><p>Add all required repositories that are
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L31 target=_blank>listed here</a> to your <code>composer.json</code></p></li><li><p>Add installer path as here to your <code>composer json</code>. See
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L165 target=_blank>example</a>.</p></li></ol><ul><li><p><code>composer.json</code> <strong>inside</strong> of docroot
Installer path will look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;installer-paths&#34;: {
</span></span><span class=line><span class=cl>    &#34;core&#34;: [&#34;type:drupal-core&#34;],
</span></span><span class=line><span class=cl>    &#34;libraries/{$name}&#34;: [&#34;type:drupal-library&#34;],
</span></span><span class=line><span class=cl>    &#34;modules/contrib/{$name}&#34;: [&#34;type:drupal-module&#34;],
</span></span><span class=line><span class=cl>    &#34;profiles/contrib/{$name}&#34;: [&#34;type:drupal-profile&#34;],
</span></span><span class=line><span class=cl>    &#34;themes/contrib/{$name}&#34;: [&#34;type:drupal-theme&#34;],
</span></span><span class=line><span class=cl>    &#34;drush/contrib/{$name}&#34;: [&#34;type:drupal-drush&#34;],
</span></span><span class=line><span class=cl>    &#34;modules/custom/{$name}&#34;: [&#34;type:drupal-custom-module&#34;],
</span></span><span class=line><span class=cl>    &#34;themes/custom/{$name}&#34;: [&#34;type:drupal-custom-theme&#34;]
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div></li><li><p><code>composer.json</code> <strong>outside</strong> of docroot
Installer path will look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;installer-paths&#34;: {
</span></span><span class=line><span class=cl>    &#34;docroot/core&#34;: [&#34;type:drupal-core&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/libraries/{$name}&#34;: [&#34;type:drupal-library&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/modules/contrib/{$name}&#34;: [&#34;type:drupal-module&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/profiles/contrib/{$name}&#34;: [&#34;type:drupal-profile&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/themes/contrib/{$name}&#34;: [&#34;type:drupal-theme&#34;],
</span></span><span class=line><span class=cl>    &#34;drush/contrib/{$name}&#34;: [&#34;type:drupal-drush&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/modules/custom/{$name}&#34;: [&#34;type:drupal-custom-module&#34;],
</span></span><span class=line><span class=cl>    &#34;docroot/themes/custom/{$name}&#34;: [&#34;type:drupal-custom-theme&#34;]
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div></li></ul><ol start=4><li><p>Add <code>"cweagans/composer-patches": "~1.0"</code> to the <code>require</code> section in you <code>composer.json</code>. See
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L10 target=_blank>example</a>.</p></li><li><p>Add <code>"enable-patching": true</code> to the <code>extra</code> section in your <code>composer.json</code> See
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L173 target=_blank>example</a>.</p></li><li><p>Add <code>"secure-http": false</code> to the <code>config</code> section in your <code>composer.json</code> See
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/composer.json#L177 target=_blank>example</a>.</p></li><li><p>Remove <code>composer.lock</code> and <code>vendor</code> folder from the project if they are exist in your folder.</p></li><li><p>Remove <code>"replace"</code> section from your <code>composer.json</code></p></li><li><p>(Optional) If you keep <code>vendor</code> folder in your git repository, we recommend to clean up project from <code>.git</code> folder inside modules and libraries. To do so</p></li></ol><ul><li><p>Add cleaner script to your project from
<a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/remove_vendor_git_folders.sh target=_blank>YMCA Website Services composer package</a>. You can just copy it and paste onto your project.</p></li><li><p><a href=https://github.com/YCloudYUSA/yusaopeny-project/blob/8.1.x/scripts/remove_vendor_git_folders.sh#L4 target=_blank>Adjust folders</a> that you would like to cleanup</p></li><li><p>Execute it in <code>post-install-cmd</code> and <code>post-update-cmd</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;post-install-cmd&#34;: [
</span></span><span class=line><span class=cl>    &#34;bash scripts/remove_vendor_git_folders.sh || :&#34;
</span></span><span class=line><span class=cl>],
</span></span><span class=line><span class=cl>&#34;post-update-cmd&#34;: [
</span></span><span class=line><span class=cl>    &#34;bash scripts/remove_vendor_git_folders.sh || :&#34;
</span></span><span class=line><span class=cl>]
</span></span></code></pre></div></li></ul><ol start=9><li>Run <code>composer install</code></li></ol><h1 id=ciboxhttpsgithubcomciboxcibox><a href=https://github.com/cibox/cibox target=_blank>CIBox</a><a class=td-heading-self-link href=#ciboxhttpsgithubcomciboxcibox aria-label="Heading self-link"></a></h1><p>In this section you can learn how to configure development environment and CI server using Open Source product
<a href=https://github.com/cibox/cibox target=_blank>CIBox</a>.</p><h3 id=create-project>Create project<a class=td-heading-self-link href=#create-project aria-label="Heading self-link"></a></h3><ol><li><p>Generate project based on
<a href=http://docs.cibox.tools/en/latest/Quickstart/#prepare-github-project target=_blank>this quickstart</a></p></li><li><p>Add YMCA Website Services to the project using (Add YMCA Website Services to already existing Drupal 8 project)</p></li><li><p>Init git and add initial commit</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> OPENY_PROJECT
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;Init YMCA Website Services project&#34;</span>
</span></span><span class=line><span class=cl>git remote add origin git@github.com:NAMESPACE/PROJECT.git
</span></span><span class=line><span class=cl>git push -u origin master
</span></span></code></pre></div><ol start=4><li>Spin up your local vagrant machine</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vagrant up --provision
</span></span></code></pre></div><ol start=5><li>Setup CI server for new project based on
<a href=https://github.com/cibox/cibox#provision-new-ci-server target=_blank>CIBox documentation</a>.</li></ol><ul><li>Follow quick start starting from Jenkins Provisioning Step
<a href=http://docs.cibox.tools/en/latest/Quickstart/#jenkins-provisioning target=_blank>http://docs.cibox.tools/en/latest/Quickstart/#jenkins-provisioning</a> (Here we will get PR builds and DEMO site (DEV environment) with credentials to it )</li><li>Setup hosting STAGE environment (it should be a 1:1 copy of existing or expected hosting account for ability to provide performance testing there)</li><li>Setup deployment plans for CI by reusing DEMO builder job</li></ul><h1 id=install-ymca-website-services-on-digitaloceanhttpbitlycibox-digitalocean>Install YMCA Website Services on
<a href=http://bit.ly/cibox-digitalocean target=_blank>DigitalOcean</a><a class=td-heading-self-link href=#install-ymca-website-services-on-digitaloceanhttpbitlycibox-digitalocean aria-label="Heading self-link"></a></h1><ol><li>Create new Droplet using &ldquo;One-click apps&rdquo; image <code>Drupal 8.*.* on 14.04</code></li><li>Login to server
<a href=https://www.digitalocean.com/community/tutorials/how-to-connect-to-your-droplet-with-ssh target=_blank>via SSH</a> or
<a href=https://www.digitalocean.com/community/tutorials/how-to-use-the-digitalocean-console-to-access-your-droplet target=_blank>web console</a></li><li>Run command</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -s https://raw.githubusercontent.com/YCloudYUSA/yusaopeny/8.x-1.x/build/openy-digital-ocean.sh<span class=o>)</span>
</span></span></code></pre></div><ol start=4><li>Open link(e.g. http://IP/core/install.php) from console output and finish YMCA Website Services installation</li></ol><h2 id=video-tutorial>Video tutorial<a class=td-heading-self-link href=#video-tutorial aria-label="Heading self-link"></a></h2><p><a href=https://youtu.be/RCvsLANsbm8 target=_blank><img src=https://img.youtube.com/vi/RCvsLANsbm8/0.jpg alt="YMCA Website Services v1.0b - Install Tutorial"></a></p><h2 id=end-to-end-installation>End to end installation<a class=td-heading-self-link href=#end-to-end-installation aria-label="Heading self-link"></a></h2><p><a href=https://youtu.be/RT6kC38zgvo target=_blank><img src=https://img.youtube.com/vi/RT6kC38zgvo/0.jpg alt="YMCA Website Services install - in 16 minutes end to end, no tutorial"></a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-51589e8d7642df820aa44605d589f220>45 - technology pipeline</h1><p>To deliver the best technologies for the YMCA movement, the YMCA Website Services development community maintains the following documents and best practices:</p><ol><li><a href=/docs/development/development-faq/>Development FAQ</a></li><li><a href=/docs/development/code-review-quality-best-practices/>YMCA Website Services Coding Standards</a></li><li><a href=./how-to-contribute-large-features-into-open-y-backporting-etc>How new technologies and features are added to YMCA Website Services</a></li><li><a href=/docs/development/sandboxes/>Sandboxes</a></li><li>Smoke Tests<ul><li><a href="https://www.youtube.com/watch?v=MH4BwMowlic&amp;list=PL_QVggMcFfKYfV1cnistny2L-Sp55SoMg" target=_blank>Smoke Tests YouTube Playlist</a></li><li><a href=/docs/development/open-y-smoke-tests-index/>Open-Y-Smoke-Tests-Index</a></li></ul></li><li>A Slack Team
<a href="mailto:ycloud@ymca.net?subject=Slack%20Access%20Request">by invite</a> with a #developers channel where we discuss technical issues with our partners and YUSA.</li><li>A
<a href="https://www.youtube.com/playlist?list=PL_QVggMcFfKZp05THV3dYlYOG3MsJ8xSf" target=_blank>YouTube playlist for Developers</a></li><li>A list of
<a href=/docs/development/open-y-3rd-party-dependencies/>3rd party dependencies</a> which are reviewed periodically for new features and deprecations.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-3551213e6f9ca5f228f4a74ba85ceae9>46 - Terms and Conditions</h1><div class=lead>These Terms & Conditions must be agreed to upon installing YMCA Website Services</div><p>These terms are maintained in
<a href=https://github.com/YCloudYUSA/yusaopeny/blob/main/src/Form/TermsOfUseForm.php target=_blank>the distribution codebase at TermsOfUseForm.php</a> and are subject to change at any time. Any change in the terms will require site owners to agree to the new terms and a record of the date of agreement is maintained in the site database. Terms can be viewed on your site at <strong>Admin</strong> > <strong>YMCA Website Services</strong> > <strong>Terms and Conditions</strong> (<code>/admin/openy/terms-and-conditions</code>).</p><hr><ul><li>We agree to the
<a href=../WS-Participant-Agreement>Participant Agreement</a> and
<a href=../WS-Terms-of-Use>Terms of Use</a></li><li>YMCA of the USA supports the Website Services platform with respect to use by its Member Associations but is not responsible for and does not control the services provided by 3rd party agencies, which are using and modifying YMCA Website Service distribution.</li><li>YMCA of the USA recommends that each participating YMCA association develop and implement its own cybersecurity policies and obtain cyber liability and data privacy insurance.</li><li>I acknowledge that YMCA Website Service is open source content and that all content is provided “as is” without any warranty of any kind. YMCA of the USA makes no warranty that its services will meet your requirements, be safe, secure, uninterrupted, timely, accurate, or error-free, or that your information will be secure. YMCA of the USA will not maintain and support YMCA Website Service templates indefinitely. The entire risk as to the quality and performance of the content is with you.</li><li>YMCA of the USA recommends obtaining a reputable agency to assist with the implementation of the YMCA Website Service platform and further development for your specific needs.</li><li>All demonstration content, including but not limited to text, images, graphics, videos, audio, and any other materials displayed on this website, is the exclusive property of YMCA of the USA. The demonstration content is provided solely for illustrative purposes and to showcase the capabilities of YMCA&rsquo;s Website Service. Nonetheless, YMCA member associations may use demonstration content for their websites, as applicable.<ul><li>By accessing and/or using this website, you agree to respect the ownership and intellectual property rights of YMCA of the USA over the demonstration content. Users and visitors are strictly prohibited from reproducing, distributing, modifying, or otherwise using the demonstration content without explicit written permission from YMCA of the USA.</li><li>Any unauthorized use or misuse of the demonstration content is a violation of these Terms and Conditions and may be subject to applicable laws and regulations, result in your access being revoked, and/or legal action taken, if applicable.</li><li>YMCA of the USA reserves the right to change, modify, or remove the demonstration content from the website at any time without prior notice. We are not responsible for any inaccuracies or errors in the demonstration content and make no guarantees about its accuracy or completeness.</li></ul></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ce698b250a98968edd46374b53279593>47 - Testing YMCA Website Services for PHP 7.4 version support</h1><h2 id=requirements>Requirements<a class=td-heading-self-link href=#requirements aria-label="Heading self-link"></a></h2><ul><li>php-cli 7.4 ( memory_limit value should be large ( 2000M ) or unlimiter ( -1 ) in order to not fail</li><li>composer 2</li></ul><h2 id=steps>Steps<a class=td-heading-self-link href=#steps aria-label="Heading self-link"></a></h2><ol><li>Obtain latest development code of YMCA Website Services</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>composer create-project YCloudYUSA/yusaopeny-project:9.2.x-development-dev openy7.4
</span></span></code></pre></div><ol start=2><li>Add phpcompatibility to require-dev section</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cd open7.4
</span></span><span class=line><span class=cl>composer require --dev phpcompatibility/php-compatibility
</span></span><span class=line><span class=cl>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --config-set installed_paths vendor/phpcompatibility/php-compatibility
</span></span></code></pre></div><ol start=3><li>Generate report</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --report-file=report.txt
</span></span></code></pre></div><p>or if you need to skip warnings</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>./vendor/bin/phpcs -p . --standard=PHPCompatibility --runtime-set testVersion 7.4 --report-file=report.txt -n
</span></span></code></pre></div><p>In report.txt you&rsquo;d find a full list of findings to be resolved in order to pass compatibility</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9c3ba0a566fd06ae070db6a9704be0f4>48 - Tests</h1><p>These instructions explain how you can run tests.</p><h2 id=behat>Behat<a class=td-heading-self-link href=#behat aria-label="Heading self-link"></a></h2><h3 id=requirements>Requirements<a class=td-heading-self-link href=#requirements aria-label="Heading self-link"></a></h3><ul><li>Ansible 1.9.4+
<a href=http://docs.ansible.com/ansible/intro_installation.html target=_blank>http://docs.ansible.com/ansible/intro_installation.html</a></li><li>Docker
<a href=https://docs.docker.com/engine/installation/ target=_blank>https://docs.docker.com/engine/installation/</a></li></ul><h3 id=run-full-test-suite>Run full test suite<a class=td-heading-self-link href=#run-full-test-suite aria-label="Heading self-link"></a></h3><ol><li><p>Execute command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd profiles/contrib/openy
</span></span><span class=line><span class=cl>$ sh runtests.sh
</span></span></code></pre></div></li><li><p>Open
<a href=http://site.com/profiles/contrib/openy/build/reports/behat target=_blank>http://site.com/profiles/contrib/openy/build/reports/behat</a> in browser.</p></li></ol><h3 id=run-selenium-container--behat-tests-in-usual-way>Run selenium container + Behat tests in usual way<a class=td-heading-self-link href=#run-selenium-container--behat-tests-in-usual-way aria-label="Heading self-link"></a></h3><p>In order to run only selenium container + behat in usual way:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd profiles/contrib/openy
</span></span><span class=line><span class=cl>$ sh runtests.sh --tags run_selenium
</span></span><span class=line><span class=cl>$ bin/behat
</span></span></code></pre></div><h3 id=stop-selenium-container>Stop selenium container<a class=td-heading-self-link href=#stop-selenium-container aria-label="Heading self-link"></a></h3><p>In order to stop selenium container:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd profiles/contrib/openy
</span></span><span class=line><span class=cl>$ sh runtests.sh --tags stop_selenium
</span></span></code></pre></div><p>If necessary, edit behat.local.yml to match your environment.</p><h3 id=visual-debugging---videohttpsyoutubeqytpia1clvc>Visual debugging -
<a href=https://youtu.be/qYtpiA1ClVc target=_blank>Video</a><a class=td-heading-self-link href=#visual-debugging---videohttpsyoutubeqytpia1clvc aria-label="Heading self-link"></a></h3><p>When you develop JS tests, it&rsquo;s important to see what&rsquo;s going on the Selenium screen. You can easily see this during development.</p><ol><li>Install
<a href=https://www.realvnc.com/download/viewer target=_blank>https://www.realvnc.com/download/viewer</a></li><li>Run selenium using command</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd profiles/contrib/openy
</span></span><span class=line><span class=cl>$ sh runtests.sh --tags run_selenium
</span></span></code></pre></div><ol start=3><li>Open installed VNC Viewer and connect to the server with IP <code>192.168.56.132:5901</code></li></ol><ul><li>Password = secret</li></ul><ol start=4><li>Run tests and you should see everything that is performed by behat tests in VNC client</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ bin/behat
</span></span></code></pre></div><p><a href=https://youtu.be/__ZJlWOK2JM target=_blank><img src=https://img.youtube.com/vi/__ZJlWOK2JM/0.jpg alt="Debugging JavaScript Behat tests"></a></p><h3 id=custom-behat-functionality>Custom Behat functionality<a class=td-heading-self-link href=#custom-behat-functionality aria-label="Heading self-link"></a></h3><ul><li>Create entities in table forms, with key to use in reference and reference entities by key.<ul><li>KEY is optional, and <strong>must be all CAPS</strong>.</li><li>Taxonomy<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create &#34;taxonomy_term&#34; of type &#34;color&#34; with key for reference:
</span></span><span class=line><span class=cl>  | KEY  | name  | field_color |
</span></span><span class=line><span class=cl>  | Blue | Blue  | 0000FF      |
</span></span><span class=line><span class=cl>  | Red  | Red   | FF0000      |
</span></span></code></pre></div></li><li>Paragraphs<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create &#34;paragraph&#34; of type &#34;small_banner&#34; with key for reference:
</span></span><span class=line><span class=cl>  | KEY     | field_prgf_headline | field_prgf_color |
</span></span><span class=line><span class=cl>  | banner1 | Headline 1          | Blue             |
</span></span><span class=line><span class=cl>  | banner2 | Headline 2          | Red              |
</span></span></code></pre></div></li><li>Media entities<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create &#34;media&#34; of type &#34;image&#34; with key for reference:
</span></span><span class=line><span class=cl>  | KEY       | name            | file         |
</span></span><span class=line><span class=cl>  | gallery_1 | Gallery image 1 | gallery.png  |
</span></span><span class=line><span class=cl>  | gallery_2 | Gallery image 2 | gallery2.png |
</span></span><span class=line><span class=cl>  | gallery_3 | Gallery image 3 | gallery3.png |
</span></span></code></pre></div></li></ul></li><li>Create nodes in table forms, with key to use in reference and reference entities by key.<ul><li>KEY is optional, and <strong>must be all CAPS</strong>.</li><li>Basic create<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create &#34;landing_page&#34; content:
</span></span><span class=line><span class=cl>  | KEY       | title           | field_lp_layout | field_content |
</span></span><span class=line><span class=cl>  | landing_1 | Test Landing 01 | one_column      | banner1       |
</span></span><span class=line><span class=cl>  | landing_2 | Test Landing 02 | one_column      | banner2       |
</span></span></code></pre></div></li><li>Vertical field table<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create large &#34;landing_page&#34; content:
</span></span><span class=line><span class=cl>  | KEY             | landing_3       | landing_4       |
</span></span><span class=line><span class=cl>  | title           | Test Landing 03 | Test Landing 04 |
</span></span><span class=line><span class=cl>  | field_lp_layout | one_column      | one_column      |
</span></span><span class=line><span class=cl>  | field_content   | banner1         | banner2         |
</span></span></code></pre></div></li><li>Create & view immediately<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I view a &#34;landing_page&#34; content:
</span></span><span class=line><span class=cl>  | KEY             | landing_5       |
</span></span><span class=line><span class=cl>  | title           | Test Landing 05 |
</span></span><span class=line><span class=cl>  | field_lp_layout | one_column      |
</span></span><span class=line><span class=cl>  | field_content   | banner1         |
</span></span></code></pre></div></li><li>Multiple referenced entities by key on a field.<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I create &#34;landing_page&#34; content:
</span></span><span class=line><span class=cl>  | KEY       | title           | field_lp_layout | field_content    |
</span></span><span class=line><span class=cl>  | landing_6 | Test Landing 06 | one_column      | banner1, banner2 |
</span></span></code></pre></div></li></ul></li></ul><h4 id=example-address-and-latitude--longitude>Example Address and Latitude + Longitude<a class=td-heading-self-link href=#example-address-and-latitude--longitude aria-label="Heading self-link"></a></h4><p>Fields with sub field/columns:
The machine name and columns can be found in the form markup in the field name property.
<img src=../../assets/complex_field_machine_names.png alt="Inspect form field name depicted">
The first portion, <code>field_location_address</code> represents the Drupal field machine name, while the second array key <code>address_line1</code> represents the column.</p><ul><li>Add Address<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I view a &#34;branch&#34; content:
</span></span><span class=line><span class=cl>    | title                                | Branch Example  |
</span></span><span class=line><span class=cl>    | field_location_address:country_code  | US             |
</span></span><span class=line><span class=cl>    | :address_line1                       | Main road 10   |
</span></span><span class=line><span class=cl>    | :locality                            | Seattle        |
</span></span><span class=line><span class=cl>    | :administrative_area                 | WA             |
</span></span><span class=line><span class=cl>    | :postal_code                         | 98101          |
</span></span></code></pre></div></li><li>Add Latitude and Longitude<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Given I view a &#34;branch&#34; content:
</span></span><span class=line><span class=cl>  | title                          | Branch Example 2 |
</span></span><span class=line><span class=cl>  | field_location_coordinates:lat | 47.293433        |
</span></span><span class=line><span class=cl>  | :lng                           | -122.238717      |
</span></span><span class=line><span class=cl>  | field_location_phone           | +1234567890      |
</span></span></code></pre></div></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-846d22eabec2b7a086b1319b7a0152f9>49 - Theming and Design</h1><p>Welcome to YMCA Website Services Theming and Design documentation.</p><h3 id=how-to-change-styles-on-content-type-level>How to change styles on content type level<a class=td-heading-self-link href=#how-to-change-styles-on-content-type-level aria-label="Heading self-link"></a></h3><p><strong>Given:</strong>
As an YMCA Website Services site developer, I want to be able to easily change the CSS for a Camp page
independently from a Location page, so I can better customize the site to meet the needs of my customers.</p><p><strong>How to:</strong></p><ul><li>If you need to change CSS on some pages independently, you should enable Custom CSS functionality on
the theme configuration page - Custom CSS - check &ldquo;Enable or disable custom CSS&rdquo;.</li><li>Input CSS code into the textarea.</li></ul><p>In order to change CSS on each particular page you should use the following selectors:</p><ul><li>.page-node-type-{node type};</li><li>.node-id-{node ID};</li><li>.path-frontpage.</li></ul><p>The existing node types are: <em>activity</em>, <em>alert</em>, <em>blog</em>, <em>branch</em>, <em>camp</em>, <em>class</em>, <em>facility</em>, <em>landing-page</em>, <em>membership</em>, <em>news</em>, <em>program</em>, <em>program-subcategory</em>, <em>session</em>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1e0608324e7cc6c56e78ac8c0c3cd375>50 - Tour</h1><h3 id=how-to-use-ymca-website-services-tour-token-with-tour>How to use YMCA Website Services Tour Token with Tour<a class=td-heading-self-link href=#how-to-use-ymca-website-services-tour-token-with-tour aria-label="Heading self-link"></a></h3><p>In someone modules have tour tips and for more interactivity, you can add a token with a click to any selector.</p><ol><li><p>In the module open tour yml file.
<img src=../../assets/openy_tour_place.png alt="Configuration project add/update form"></p></li><li><p>Select the tip for edit and in body add token like this [openy_tour:click:button_name:selector]
<img src=../../assets/openy_tour_add_to_tip.png alt="Configuration project add/update form"></p></li><li><p>Create hook update for you changes and in command line run drush updb -y</p></li></ol><h4 id=token-components>Token components:<a class=td-heading-self-link href=#token-components aria-label="Heading self-link"></a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[openy_tour:click:button_name:selector]*
</span></span></code></pre></div><p>openy_tour - token name;</p><p>click - command in the token;</p><p>button_name - name of button when show in a tip;</p><p>selector - selector to be clicked.</p><p>Please see and use
<a href=https://www.w3schools.com/jquery/jquery_ref_selectors.asp target=_blank>jQuery selectors</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f95cce86e97c20c8b981ca9d0ba2caad>51 - Upgrade OpenY 8.1.3 to 8.2.2.1</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/development/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><h3 id=video-tutorials>Video tutorials<a class=td-heading-self-link href=#video-tutorials aria-label="Heading self-link"></a></h3><p>Upgrade OpenY from 8.0.7 to 8.2.2.1 -
<a href="https://www.youtube.com/watch?v=U_mg0-yKGOI" target=_blank>https://www.youtube.com/watch?v=U_mg0-yKGOI</a></p><h3 id=document-is-work-in-progress>Document is work in progress<a class=td-heading-self-link href=#document-is-work-in-progress aria-label="Heading self-link"></a></h3><p>These are instructions for upgrading a very old version of YMCA Website Services to the latest version.
Given the fact
<a href=https://www.drupal.org/node/3034742 target=_blank>Drupal 8.7+ has no support for automatic entity updates</a> ( BaseFieldDefinitions ) we have to upgrade to 8.2.2.1 of OpenY, which is still on 8.6 Drupal Core, and then update to the latest YMCA Website Services version as usual.</p><h1 id=environment>Environment<a class=td-heading-self-link href=#environment aria-label="Heading self-link"></a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>vagrant@vagrant:/var/www/docroot$ uname -a
</span></span><span class=line><span class=cl>Linux vagrant 4.15.0-29-generic <span class=c1>#31-Ubuntu SMP Tue Jul 17 15:39:52 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl>vagrant@vagrant:/var/www/docroot$ lsb_release -a
</span></span><span class=line><span class=cl>No LSB modules are available.
</span></span><span class=line><span class=cl>Distributor ID:	Ubuntu
</span></span><span class=line><span class=cl>Description:	Ubuntu 18.04.1 LTS
</span></span><span class=line><span class=cl>Release:	18.04
</span></span><span class=line><span class=cl>Codename:	bionic
</span></span><span class=line><span class=cl>vagrant@vagrant:/var/www/docroot$ php -v
</span></span><span class=line><span class=cl>**PHP 7.1.31-1**+ubuntu18.04.1+deb.sury.org+1 <span class=o>(</span>cli<span class=o>)</span> <span class=o>(</span>built: Aug  <span class=m>7</span> <span class=m>2019</span> 10:23:12<span class=o>)</span> <span class=o>(</span> NTS <span class=o>)</span>
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> 1997-2018 The PHP Group
</span></span><span class=line><span class=cl>Zend Engine v3.1.0, Copyright <span class=o>(</span>c<span class=o>)</span> 1998-2018 Zend Technologies
</span></span><span class=line><span class=cl>    with Zend OPcache v7.1.31-1+ubuntu18.04.1+deb.sury.org+1, Copyright <span class=o>(</span>c<span class=o>)</span> 1999-2018, by Zend Technologies
</span></span><span class=line><span class=cl>    with Xdebug v2.7.2, Copyright <span class=o>(</span>c<span class=o>)</span> 2002-2019, by Derick Rethans
</span></span><span class=line><span class=cl>vagrant@vagrant:/var/www/docroot$ drush --version
</span></span><span class=line><span class=cl> **Drush Version   :  8.2.3**
</span></span><span class=line><span class=cl>vagrant@vagrant:/var/www/docroot$ composer --version
</span></span><span class=line><span class=cl>**Composer version 1.7.2** 2018-08-16 16:57:12
</span></span></code></pre></div><h1 id=step-by-step-guide-for-update>Step by step guide for update<a class=td-heading-self-link href=#step-by-step-guide-for-update aria-label="Heading self-link"></a></h1><ul><li>Use PHP7.1 for upgrade and install <code>php7.1-mysql php7.1-mcrypt php7.1-cli php7.1-common php7.1-curl php7.1-dev php7.1-fpm php7.1-gd php7.1-mysql php7.1-memcached php7.1-imagic php7.1-xml php7.1-xdebug php7.1-mbstring php7.1-soap php7.1-zip php7.1-xml</code></li><li>Go to the folder of OpenY code tree where <code>docroot</code> folder is contained</li><li><code>mv composer.json composer.json.orig</code></li><li><code>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.2.x/composer.json</code></li><li><code>mkdir -p scripts ; cd scripts && wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.2.x/scripts/remove_libraries_gitignore_files.sh && cd ..</code></li><li><code>composer require YCloudYUSA/yusaopeny:8.2.2.1 --no-suggest --no-update</code></li><li><code>composer install --ignore-platform-reqs --no-suggest</code></li><li><code>composer update --prefer-stable --no-suggest</code></li><li><code>cd docroot</code></li><li><code>drush dl -y plugin-8.x-2.5 contribute-8.x-1.0-beta7 scheduler-8.x-1.0 views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap-8.x-3.0 easy_breadcrumb-8.x-1.6</code></li><li><code>drush en openy_upgrade_tool openy_er openy_prgf_loc_finder openy_map openy_data_wrapper openy_loc_branch content_moderation focal_point</code></li><li><code>drush ev "Drupal::service('module_installer')->install(['openy']);"</code> &lt;- This steps fixes some hidden bug when <code>openy</code> profile removed from <code>core.extension</code> configuration for unknown reason.</li><li>Manual step (optional, if you have issues with <code>drush updatedb</code>): Edit all yml files in <code>profiles</code> folder to comment <code>media.type.image</code> , <code>field.field.node.program.field_header_content</code>, <code>field.field.node.branch.field_location_amenities</code> in dependencies sections.</li></ul><p><img src=https://user-images.githubusercontent.com/563412/64005803-bc94cc80-cb19-11e9-8137-702d141c48e5.png alt=image></p><p><img src=https://user-images.githubusercontent.com/563412/64005817-c1598080-cb19-11e9-8a04-9be0c7f3a15a.png alt=image></p><p><img src=https://user-images.githubusercontent.com/563412/64005820-c61e3480-cb19-11e9-9853-dbad3c17d851.png alt=image></p><ul><li>run <code>drush updatedb -y</code> &lt;- this will fail for the first time ( Media not installed yet ), disregard</li><li>run <code>drush updatedb -y</code> &lt;- this should run properly.</li><li>run <code>drush entup</code></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-67ca83e8e9fe6bc99856967b843bef43>52 - Upgrade path</h1><p>All changes in configurations should be added to appropriate hook_update_N in order to update already existing environments. We suggest to use
<a href=https://www.drupal.org/project/confi target=_blank>https://www.drupal.org/project/confi</a> for working with hook_update_N.</p><h3 id=openyinstall-in-profile><code>openy.install</code> in profile<a class=td-heading-self-link href=#openyinstall-in-profile aria-label="Heading self-link"></a></h3><p>In this file we should put updates that are related to the distribution in general and don&rsquo;t fit into any feature.</p><ul><li>Enable/Disable module</li><li>General configs</li></ul><h3 id=openy_install-in-modules><code>openy_*.install</code> in modules<a class=td-heading-self-link href=#openy_install-in-modules aria-label="Heading self-link"></a></h3><p>In case if you update some configuration for specific feature, make sure that you put updates into appropriate module.</p><h3 id=revert-only-specific-property-from-config>Revert only specific property from config<a class=td-heading-self-link href=#revert-only-specific-property-from-config aria-label="Heading self-link"></a></h3><p>With
<a href=https://www.drupal.org/project/confi target=_blank>config_import module</a> help we can update only part from full config.</p><p>For updating specific property in config (use service &lsquo;openy_upgrade_tool.param_updater&rsquo;):</p><ol><li><p>go to related to this config module</p></li><li><p>create new hook_update_N in openy_*.install file</p></li><li><p>in update add next code (this is example):</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span><span class=n>config</span> <span class=o>=</span> <span class=n>drupal_get_path</span><span class=p>(</span><span class=s1>&#39;module&#39;</span><span class=p>,</span> <span class=s1>&#39;openy_media_image&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/install/views.view.images_library.yml&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>config_importer</span> <span class=o>=</span> \<span class=n>Drupal</span><span class=p>::</span><span class=n>service</span><span class=p>(</span><span class=s1>&#39;openy_upgrade_tool.param_updater&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>config_importer</span><span class=o>-&gt;</span><span class=n>update</span><span class=p>(</span><span class=o>$</span><span class=n>config</span><span class=p>,</span> <span class=s1>&#39;views.view.images_library&#39;</span><span class=p>,</span> <span class=s1>&#39;display.default.display_options.pager&#39;</span><span class=p>);</span>
</span></span></code></pre></div><p>Where:</p><ul><li>$config variable contains path to config with config name</li><li>&ldquo;views.view.images_library&rdquo; - config name</li><li>&ldquo;display.default.display_options.pager&rdquo; - config specific property (you can set value from a nested array with variable depth)</li></ul><h3 id=revert-full-configs>Revert full configs<a class=td-heading-self-link href=#revert-full-configs aria-label="Heading self-link"></a></h3><p>For updating full config or several configs from directory use service &lsquo;openy_upgrade_tool.importer&rsquo;.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span><span class=n>config_dir</span> <span class=o>=</span> <span class=n>drupal_get_path</span><span class=p>(</span><span class=s1>&#39;module&#39;</span><span class=p>,</span> <span class=s1>&#39;openy_media_image&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/install&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>config_importer</span> <span class=o>=</span> \<span class=n>Drupal</span><span class=p>::</span><span class=n>service</span><span class=p>(</span><span class=s1>&#39;openy_upgrade_tool.importer&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>config_importer</span><span class=o>-&gt;</span><span class=n>setDirectory</span><span class=p>(</span><span class=o>$</span><span class=n>config_dir</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>config_importer</span><span class=o>-&gt;</span><span class=n>importConfigs</span><span class=p>([</span><span class=s1>&#39;views.view.images_library&#39;</span><span class=p>]);</span>
</span></span></code></pre></div><p>Where:</p><ul><li>$config_dir - path to directory with config</li><li>&ldquo;views.view.images_library&rdquo; - config name</li></ul><p>Also you can update several configs from directory:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$config_importer-&gt;importConfigs([
</span></span><span class=line><span class=cl>  &#39;views.view.images_library&#39;,
</span></span><span class=line><span class=cl>  &#39;views.view.example_view&#39;,
</span></span><span class=line><span class=cl>]);
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-d431a35b8f6dfca62f50b56faab041c0>53 - Upgrade to Open Y 1.x</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/development/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><h1 id=upgrade-to-old-open-y-1x-version--tested-on-upgrading-802-to-81114->Upgrade to old, Open Y 1.x version ( tested on upgrading 8.0.2 to 8.1.1.14 )<a class=td-heading-self-link href=#upgrade-to-old-open-y-1x-version--tested-on-upgrading-802-to-81114- aria-label="Heading self-link"></a></h1><p>See
<a href=/docs/development/upgrade-openy-8.1.3-to-8.2.2.1/>upgrade from 8.1.3 to 8.2.2.1</a></p><p>We found the oldest OpenY instance working on 8.0.2 version of OpenY so this document should cover all the way of updating it to the latest version.</p><h3 id=prepare-dedicated-environment-for-upgrade-testing>Prepare dedicated environment for upgrade testing<a class=td-heading-self-link href=#prepare-dedicated-environment-for-upgrade-testing aria-label="Heading self-link"></a></h3><p>Ensure you have working computer or virtual machine with</p><ul><li>Ubuntu 14.04(16.04 or any decent Ubuntu LTS versions) 64 bit</li><li>MySQL 5.5+</li><li>Apache 2.4</li><li>PHP 5.6-7.1 (7.2 is not supported yet)</li></ul><p>OpenY team maintains
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>Vagrant preconfigured Virtualbox based virtual machine with OpenY</a>. Feel free to use it to get working virtual environment.
Your own OpenY instance should have Virtual machine injected into your site codebase. Just find <code>Vagrantfile</code> and proceed with <code>vagrant up</code>
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm/blob/master/README.md target=_blank>accordingly to the documentation</a>.</p><h3 id=obtain-local-copy-of-your-production-site>Obtain local copy of your production site<a class=td-heading-self-link href=#obtain-local-copy-of-your-production-site aria-label="Heading self-link"></a></h3><p>You have to create local copy of your site locally to be able to proceed with the upgrade.
For that</p><ul><li>Make a backup of your production database and copy it to your local machine</li><li>Make a copy of your production site codebase and copy it to your local machine</li></ul><p>&mldr;</p><ol><li><h3 id=detect-version-of-your-openy>Detect version of your OpenY<a class=td-heading-self-link href=#detect-version-of-your-openy aria-label="Heading self-link"></a></h3></li></ol><p>Starting from OpenY 1.10 release you should see a version of OpenY in your site reports dashboard.
For previous versions the best way to check your version is to analyze creation date of index.php pr README.txt file in the docroot folder of your site and compare it to the release date from
<a href=https://github.com/YCloudYUSA/yusaopeny/releases target=_blank>https://github.com/YCloudYUSA/yusaopeny/releases</a> . Your OpenY version should be the one which is older than creation date of the files.</p><ol start=2><li><h3 id=run-command-with-next-never-version>Run command with next never version<a class=td-heading-self-link href=#run-command-with-next-never-version aria-label="Heading self-link"></a></h3></li></ol><p>In a same folder where is your <code>docroot</code> folder run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>mv composer.json composer.json.bak <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/composer.json
</span></span><span class=line><span class=cl><span class=nb>cd</span> docroot/profiles/contrib/openy/
</span></span><span class=line><span class=cl>rm -f yparse*
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/8.1.x/scripts/yparse.sh
</span></span><span class=line><span class=cl>drush cr
</span></span><span class=line><span class=cl>sh yparse.sh <span class=p>|</span> xargs drush en -y
</span></span><span class=line><span class=cl><span class=nb>cd</span> ../../../../
</span></span><span class=line><span class=cl>composer require YCloudYUSA/yusaopeny:NEW_VERSION_HERE --no-update
</span></span><span class=line><span class=cl>composer update --prefer-dist --with-dependencies --prefer-stable --update-with-all-dependencies --no-suggest
</span></span></code></pre></div><ol start=3><li><h3 id=update-the-site>Update the site<a class=td-heading-self-link href=#update-the-site aria-label="Heading self-link"></a></h3></li></ol><p>Go to docroot folder of your codebase and run</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>drush updatedb
</span></span><span class=line><span class=cl>drush entup
</span></span></code></pre></div><p>Sometimes, when <code>updatedb</code> fails, it is important to get stable version of some modules we found causing problems</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>drush dl -y plugin-8.x-2.5 contribute-8.x-1.0-beta7 scheduler-8.x-1.0 views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap-8.x-2.9 easy_breadcrumb-8.x-1.6
</span></span><span class=line><span class=cl>drush en -y plugin contribute scheduler views_block_filter_block datalayer simple_menu_icons rabbit_hole metatag simple_sitemap <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>drush ev <span class=s2>&#34;Drupal::service(&#39;module_installer&#39;)-&gt;install([&#39;content_moderation&#39;,&#39;openy&#39;]);&#34;</span>
</span></span></code></pre></div><p>Ensure commands above finished with no error messages. Best way to check it - run them one more time. If next run shows</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ drush updatedb
</span></span><span class=line><span class=cl>No database updates required                                                                                    <span class=o>[</span>success<span class=o>]</span>
</span></span><span class=line><span class=cl>$ drush entup
</span></span><span class=line><span class=cl>No entity schema updates required                                                                               <span class=o>[</span>success<span class=o>]</span>
</span></span></code></pre></div><p>You almost 100% proved updated were executed correctly.</p><ol start=4><li><h3 id=check-for-regressions>Check for regressions<a class=td-heading-self-link href=#check-for-regressions aria-label="Heading self-link"></a></h3></li></ol><p>&mldr;</p><ol start=5><li><h3 id=backup-current-state-of-the-updated-site>Backup current state of the updated site<a class=td-heading-self-link href=#backup-current-state-of-the-updated-site aria-label="Heading self-link"></a></h3></li></ol><p>&mldr;</p><ol start=6><li><h3 id=proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)<a class=td-heading-self-link href=#proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1 aria-label="Heading self-link"></a></h3></li></ol><p>&mldr;</p></div><div class=td-content style=page-break-before:always><h1 id=pg-bffcf0befc5ba9efa917cebf13e6a9b4>54 - Upgrade use case from 8.2.2.3 to 8.2.7.3</h1><p>This document is archived but may contain useful information for troubleshooting future updates. For updated update steps, visit
<a href=/docs/development/openy-upgrade-how-to-for-developers/>How to upgrade YMCA Website Services</a>.</p><hr><p>1 uninstall <code>lndr</code> and <code>optimizely</code> modules before running
<a href=/docs/development/openy-upgrade-how-to-for-developers/#run-command-with-next-never-version--replace-new_version_here-with-the-version-you-are-upgrading-to-eg-8207->composer update commands</a></p><p>2 config to remove</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>
</span></span><span class=line><span class=cl>drush cdel image.style.browser_thumbnail
</span></span></code></pre></div><p>3 enable <code>openy_focal_point</code> and <code>media_directories_ui</code> should be enabled when upgrade from 8.2.2.3 to 8.2.7.3</p><p>4 - run drush updatedb
<a href=/docs/development/openy-upgrade-how-to-for-developers/#update-the-site>and next steps from tutorial</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-162c99cc4ea4af161d0d5efe9d6f9028>55 - Upgrading from 9.2.11.5 to 10.3</h1><h2 id=scenario>Scenario<a class=td-heading-self-link href=#scenario aria-label="Heading self-link"></a></h2><p>A YMCA website is currently running on Y USA Open Y (<code>openy-9.x-2.11.5</code>) using Drupal 9. They want to upgrade to the latest YMCA Website Services distribution (<code>10.3</code>) on Drupal 10.</p><h2 id=upgrade-steps>Upgrade Steps<a class=td-heading-self-link href=#upgrade-steps aria-label="Heading self-link"></a></h2><ol><li><p><strong>Prepare for Upgrade to WS</strong></p><ul><li><p>Ensure your site is on the latest Y USA Open Y 9.x release</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:9.2.13.0 drupal/core-project-message:^9.5  drupal/core-composer-scaffold:^9.5 drupal/core-recommended:^9.5
</span></span></code></pre></div></li><li><p>Run database updates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush updatedb -l <span class=nv>$SITE_URL</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Upgrade to WS 10.2</strong></p><ul><li><p>Require the 10.2.14 release of Y USA Open Y and update Drupal core and dependencies</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:10.2.14 drupal/core-project-message:^10.0.11  drupal/core-composer-scaffold:^10.0.11 drupal/core-recommended:^10.0.11 drupal/core:^10.0.11 <span class=s1>&#39;drupal/smtp:^1.4&#39;</span> consolidation/robo:^4
</span></span></code></pre></div></li></ul></li><li><p><strong>Address QuickEdit/RDF Dependency Issue</strong></p><ul><li><p>Temporarily require QuickEdit and RDF</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require drupal/quickedit drupal/rdf
</span></span></code></pre></div></li><li><p>Run database updates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush updatedb -l
</span></span></code></pre></div></li><li><p>Remove and re-add QuickEdit to resolve dependency conflicts</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer remove drupal/quickedit
</span></span><span class=line><span class=cl>composer require drupal/quickedit drupal/rdf
</span></span></code></pre></div></li></ul></li><li><p><strong>Upgrade to WS 10.3.0.1</strong></p><ul><li><p>Require the 10.3.0.1 release</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:10.3.0.1 drupal/core-project-message:^10.0.11  drupal/core-composer-scaffold:^10.0.11 drupal/core-recommended:^10.0.11 drupal/core:^10.0.11
</span></span></code></pre></div></li><li><p>Run database updates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush updatedb -l <span class=nv>$SITE_URL</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Upgrade to WS 10.3.1</strong></p><ul><li><p>Require the 10.3.1 release</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:10.3.1 drupal/core-project-message:^10.0.11  drupal/core-composer-scaffold:^10.0.11 drupal/core-recommended:^10.0.11 drupal/core:^10.0.11
</span></span></code></pre></div></li></ul></li><li><p><strong>Add CKEditor5 Paste Filter</strong></p><ul><li><p>Require the CKEditor5 Paste Filter module</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require drupal/ckeditor5_paste_filter
</span></span></code></pre></div></li><li><p>Run database updates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush updatedb -l <span class=nv>$SITE_URL</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Upgrade to WS 10.3.2</strong></p><ul><li><p>Require the 10.3.2 release</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:10.3.2 drupal/core-project-message:^10.0.11  drupal/core-composer-scaffold:^10.0.11 drupal/core-recommended:^10.0.11 drupal/core:^10.0.11
</span></span></code></pre></div></li></ul></li><li><p><strong>Upgrade to WS 10.3.3.2</strong></p><ul><li><p>Require the 10.3.3.2 release</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require -W ycloudyusa/yusaopeny:10.3.3.2
</span></span></code></pre></div></li><li><p>Run database updates</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush updatedb -l <span class=nv>$SITE_URL</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Address CKEditor5 Font Issue</strong></p><ul><li><p>Uninstall the existing CKEditor5 Font module</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uninstall ckeditor5_font
</span></span></code></pre></div></li><li><p>Require the latest beta version of CKEditor5 Font</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer require <span class=s1>&#39;drupal/ckeditor5_font:^1.1@beta&#39;</span>
</span></span></code></pre></div></li><li><p>Enable the CKEditor5 Font module</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../vendor/drush/drush/drush en ckeditor5_font
</span></span></code></pre></div></li></ul></li></ol><h2 id=important-considerations>Important Considerations<a class=td-heading-self-link href=#important-considerations aria-label="Heading self-link"></a></h2><ul><li><strong>Backup:</strong> Always back up your site and database before performing any major upgrades.</li><li><strong>Testing:</strong> Thoroughly test your site after each upgrade step on a staging environment before deploying to production.</li><li><strong>Customizations:</strong> If you have made significant customizations to your site, consult with a Drupal developer to ensure a smooth upgrade process.</li><li><strong>Drush Path:</strong> Adjust the <code>../vendor/drush/drush/drush</code> path if your Drush installation is located elsewhere.</li><li><strong>$SITE_URL:</strong> Replace <code>$SITE_URL</code> with the actual URL of your site.</li></ul><p><strong>Disclaimer:</strong> This use case provides a general outline for upgrading the YMCA Website Services Drupal distribution. Specific steps and commands may vary depending on your site&rsquo;s configuration and any additional modules or customizations you have installed. Always refer to the official YMCA Website Services documentation and Drupal.org for the most up-to-date information and best practices.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1fa923d650f02253cc2538ed936380ca>56 - Upgrading to a new version of the distribution</h1><p>Review a
<a href=https://youtu.be/geeO2goJo9s target=_blank>video about this document</a>.</p><p>Before upgrading, please review these
<a href=/docs/development/important-versions-for-upgrade-path/>required version steps for your upgrade path</a>.</p><h2 id=overview>Overview<a class=td-heading-self-link href=#overview aria-label="Heading self-link"></a></h2><ul><li><a href=#prepare-dedicated-environment-for-upgrade-testing>Prepare a dedicated environment for upgrade testing</a></li><li><a href=#obtain-local-copy-of-your-production-site>Obtain a local copy of your production site</a></li><li><a href=#run-command>Run command</a></li><li><a href=#update-the-site>Update the site</a></li><li><a href=#visit-openy-upgrade-tool-dashboard>Visit the YMCA Website Services upgrade tool dashboard</a></li><li><a href=#check-for-regressions>Check for regressions/Smoke tests</a></li><li><a href=#backup-current-state-of-the-updated-site>Backup current state of the updated site</a></li><li><a href=#proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)</a></li></ul><h2 id=upgrade-steps>Upgrade steps<a class=td-heading-self-link href=#upgrade-steps aria-label="Heading self-link"></a></h2><h3 id=prepare-dedicated-environment-for-upgrade-testing>Prepare dedicated environment for upgrade testing<a class=td-heading-self-link href=#prepare-dedicated-environment-for-upgrade-testing aria-label="Heading self-link"></a></h3><p>Ensure you have a working computer or virtual machine with:</p><ul><li>Ubuntu 20.04 (16.04, 18.04, or any decent Ubuntu LTS version) 64 bit</li><li>MySQL 5.7+ (8+ is preferred because of the performance improvements)</li><li>Apache 2.4 (or Nginx + php-fpm in case if you are fine with htaccess issues down the road)</li><li>PHP 8.1 (pre 8.1 could be an issue with some contrib modules)</li><li>Drush 12 || 10 || 11</li></ul><p>The YMCA Website Services team maintains
<a href=https://github.com/YCloudYUSA/yusaopeny-cibox-vm target=_blank>Vagrant preconfigured Virtualbox based virtual machine with OpenY</a>. Feel free to use it to get a working virtual environment.</p><p>Your own YMCA Website Services instance should have a virtual machine injected into your site codebase. Just find <code>Vagrantfile</code> and proceed with <code>vagrant up</code>
<a href=https://github.com/ymcatwincities/openy-cibox-vm/blob/master/README.md target=_blank>accordingly to the documentation</a>.</p><h3 id=obtain-local-copy-of-your-production-site>Obtain local copy of your production site<a class=td-heading-self-link href=#obtain-local-copy-of-your-production-site aria-label="Heading self-link"></a></h3><p>You have to create a local copy of your site locally to be able to proceed with the upgrade.</p><p>For that:</p><ul><li>Make a backup of your production database and copy it to your local machine</li><li>Make a copy of your production site codebase and copy it to your local machine</li><li><strong>Ensure you have not manually removed Drupal modules in your database without the uninstallation step being executed!</strong> In this case you&rsquo;ll need to return the module back to the codebase and uninstall it via Drupal Extend UI or Drush before running the next steps to upgrade YMCA Website Services.</li><li><strong>Upgrade your site to latest Open Y - 9.2.11.3</strong> See
<a href=https://github.com/open-y-subprojects/openy_docs/blob/main/content/en/docs/wiki/OpenY-upgrade-how-to-for-Developers.md target=_blank>respective docs from Open Y documentation</a></li></ul><h3 id=run-command>Run command<a class=td-heading-self-link href=#run-command aria-label="Heading self-link"></a></h3><p>In the same folder where your <code>docroot</code> is, run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>mv composer.json composer.json.bak <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>wget https://raw.githubusercontent.com/YCloudYUSA/yusaopeny-project/9.2.x/composer.json
</span></span><span class=line><span class=cl>composer update -W
</span></span></code></pre></div><p>The script above <em>replaces</em> your <code>composer.json</code> file, so it&rsquo;s only applicable to websites that have the file unmodified.</p><p>If your <code>composer.json</code> file is modified, merge the changes manually. Essentially, the <code>repositories</code> section of the file is updated.</p><h3 id=update-the-site>Update the site<a class=td-heading-self-link href=#update-the-site aria-label="Heading self-link"></a></h3><p>Go to the <code>docroot</code> folder of your codebase and run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>drush updatedb
</span></span></code></pre></div><h4 id=if-updatedb-fails>If updatedb fails&mldr;<a class=td-heading-self-link href=#if-updatedb-fails aria-label="Heading self-link"></a></h4><p>you can use Drupal&rsquo;s <code>hook_update_dependencies</code> API to change the order of running updates to eliminate issues.
<a href=https://github.com/YCloudYUSA/yusaopeny/pull/1560/files target=_blank>See this example</a>.</p><p>Ensure commands above have finished with no error messages. The best way to check it is to run them one more time. If the next run shows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ drush updatedb
</span></span><span class=line><span class=cl>No database updates required                                                                                    <span class=o>[</span>success<span class=o>]</span>
</span></span></code></pre></div><p>You have almost 100% proven updates were executed correctly.</p><h4 id=if-loading-the-site-fails>If loading the site fails&mldr;<a class=td-heading-self-link href=#if-loading-the-site-fails aria-label="Heading self-link"></a></h4><p>you may receive an error like this:</p><blockquote><p>Error: Class &mldr; not found in &mldr;</p></blockquote><p>This happens due to Drupal not finding the renamed modules. To resolve this, manually clear the Drupal caches:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>drush ev &#34;drupal_flush_all_caches();&#34;
</span></span><span class=line><span class=cl>drush cr
</span></span></code></pre></div><p>which should clear up the errors.</p><h3 id=visit-openy-upgrade-tool-dashboard>Visit OpenY upgrade tool dashboard<a class=td-heading-self-link href=#visit-openy-upgrade-tool-dashboard aria-label="Heading self-link"></a></h3><p>Review and revert or apply an updated version of the configs after the upgrade.</p><p><img src=https://user-images.githubusercontent.com/563412/55151463-01759b00-5157-11e9-878e-dc744698a021.png alt=image></p><h3 id=check-for-regressions>Check for regressions<a class=td-heading-self-link href=#check-for-regressions aria-label="Heading self-link"></a></h3><p>In order to check for regressions during the upgrade, it is best to work with smoke tests. YMCA Website Services maintains the
<a href="https://docs.google.com/spreadsheets/d/1yLUkMgJKK94hABy107_V-1AcJbRSSEf2s4wsQto1wfI/edit?usp=sharing" target=_blank>smoke tests database document</a> you should use for the process.</p><h3 id=backup-current-state-of-the-updated-site>Backup current state of the updated site<a class=td-heading-self-link href=#backup-current-state-of-the-updated-site aria-label="Heading self-link"></a></h3><p>Use
<a href=https://www.drush.org/latest/commands/sql_dump/ target=_blank><code>drush sql-dump</code></a> or another backup tool to take a backup of the site in its current state.</p><h3 id=proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1>Proceed with an update to next version until succeeded (Start from item 1)<a class=td-heading-self-link href=#proceed-with-an-update-to-next-version-until-succeeded-start-from-item-1 aria-label="Heading self-link"></a></h3></div><div class=td-content style=page-break-before:always><h1 id=pg-143fb946dce93f2b691f74685ff6064a>57 - Videos</h1><h1 id=video-tutorials>Video Tutorials<a class=td-heading-self-link href=#video-tutorials aria-label="Heading self-link"></a></h1><p>The YMCA Digital Services team maintains a
<a href=https://www.youtube.com/@ymcasdigitalservices/playlists target=_blank>YouTube channel</a> with video tutorials for developers, content editors, evaluators, and more. Visit YouTube for the full list of content.</p><h2 id=playlists>Playlists<a class=td-heading-self-link href=#playlists aria-label="Heading self-link"></a></h2><ul><li><a href="https://youtube.com/watch?v=f4FHYdU0VNM&amp;list=PL_QVggMcFfKa46PgvB89bqUxmy9I9nSte" target=_blank>Live Streaming Tutorial</a></li><li><a href="https://www.youtube.com/playlist?list=PL6Wo-UX6nhySujcn7UqWmg4BopJ2LuYRk" target=_blank>Legacy YMCA&rsquo;s Website Service How-To&rsquo;s (Open Y)</a></li><li><a href="https://www.youtube.com/playlist?list=PL6Wo-UX6nhySupPRWKqy0BFlzYLzYR8rB" target=_blank>Layout Builder</a></li><li><a href="https://www.youtube.com/playlist?list=PL6Wo-UX6nhyQxt5P6vu4a9nZI-xcF0-5O" target=_blank>Monthly Calls</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4a27a35c82c95f9ac91303400eed7ee2>58 - Virtual Y Configuration</h1><h2 id=virtual-y-predefined-pages>Virtual Y predefined pages<a class=td-heading-self-link href=#virtual-y-predefined-pages aria-label="Heading self-link"></a></h2><p>Once Virtual Y installed system creates set of required Landing pages with predefined URLs. These pages are:</p><ul><li>Virtual Y Landing page - <code>/virtual-ymca</code></li><li>Virtual Y Login Landing page - <code>/virtual-y-login</code></li></ul><p>URLs to pages above then set as configuration values at <code>/admin/openy/virtual-ymca</code>.</p><p>Admin user is obligated to keep pages in the system or properly update configuration with new values to keep Virtual Y functionality working correctly.</p><h2 id=protecting-virtual-y-pages>Protecting Virtual Y Pages<a class=td-heading-self-link href=#protecting-virtual-y-pages aria-label="Heading self-link"></a></h2><p>If content editors modify the alias or remove the Virtual Y pages above, the VY site may break. Site administrators may want to add additional protections to the site to prevent editors from making those changes. We recommend
<a href=https://www.drupal.org/project/node_keep target=_blank>Node Keep</a> for this purpose:</p><ul><li>Add <code>node_keep</code> to your repo with `composer require &lsquo;drupal/node_keep&rsquo;</li><li>Enable the module in Drupal</li><li>Edit each of the pages above and set the Node Keep options as you wish to protect the pages</li></ul><p><img src=./vy-node-keep.png alt="Screenshot displaying Node Keep options"></p><h2 id=virtual-y-log-module>Virtual Y Log module<a class=td-heading-self-link href=#virtual-y-log-module aria-label="Heading self-link"></a></h2><p>Virtual Y Log module can be configured via configuration files. Available settings:</p><ul><li><code>activity_granularity_interval</code>: Default value <code>600</code> - sets the interval in Seconds to track user activity on the site</li><li><code>archiver_enabled</code>: default value <code>true</code> - enable / disable activity logs archiver cron execution</li><li><code>archiver_store_period</code>: default value <code>1 year</code> - set the period when activity logs will be collected and placed to same archive. This value should be set to as Relative Date/Time PHP string, e.g. <code>1 week</code>, <code>2 months</code>, <code>1 year</code>, etc.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8f2050f68eaacd2d7561812d82b58c3c>59 - Website Services Terms of Use</h1><p>Version 2.1, December 2022</p><p>This is a free service provided by YUSA (“<strong>we</strong>,” “<strong>us</strong>,” and “<strong>our</strong>”) for users in the YMCA community (“<strong>users</strong>,” “<strong>you</strong>,” and “<strong>your</strong>”). <strong>By using the Website Services distribution repository, you agree to these Terms of Use.</strong></p><p>We reserve the right to modify or discontinue, temporarily or permanently any services or the Terms of Use at any time, with or without prior notice to users. YUSA is not liable for any damage to any user or other third party that may result from any such modification, suspension or discontinuance of the service or of the Terms of Use.</p><p><strong>Downloading</strong></p><p>YUSA is not responsible for the content maintained in the repository. Any material downloaded or otherwise obtained through your use of our services is done at your own discretion and risk, and you will be solely responsible for any damage to your computer system or loss of data that results from the download of any such material. You agree that we have no responsibility or liability for the deletion of or the failure to store or to transmit, any content or communication maintained by the service. We retain the right to create limits on use and storage at our sole discretion at any time with or without notice.</p><p>We are not responsible for the content, data, or actions of third parties, and you release YUSA, our directors, officers, employees, and agents from any claims and damages, known and unknown, arising out of or in any way connected with any claim you have against any such third parties. No advice or information, whether oral or written, obtained by you from us or through or from our services creates any warranty not expressly stated in these Terms of Use.</p><p>All code downloaded from Website Services distribution is based on the Drupal® code base, which is subject to the terms of the Drupal license (
<a href=www.drupal.org>www.drupal.org</a>). Website Services distribution code is a derivative work of Drupal and any distribution must be under the terms of the
<a href=http://www.gnu.org/licenses/old-licenses/gpl-2.0.html target=_blank>GNU General Public License</a> version 2 or later versions.</p><p>Unless otherwise stated, all content (excluding code), including user-generated content, such as comments and discussions on the Website Services distribution web site, is licensed under
<a href=https://creativecommons.org/licenses/by-sa/2.0/ target=_blank>Creative Commons License, Attribution-ShareAlike 2.0</a>.</p><p><strong>Contributing</strong></p><p>The term “contribution” means any source code, object code, patch, tool, sample, graphic, specification, manual, documentation, comments or any other content posted or submitted by you to Website Services distribution. We welcome proposed contributions, however, all contributions are subject to review and approval, and potential modification, before inclusion in a release as part of Website Services distribution.</p><p>It is your responsibility to obtain appropriate licensing and attribution for content that you submit to Website Services distribution. Content without appropriate licensing or attribution will be removed.</p><p>You represent and warrant that:</p><ul><li><p>Each contribution that you submit is an original work of authorship and you can legally grant the rights set out in these Terms of Use;</p></li><li><p>To the best of your knowledge, each contribution will not violate any third party&rsquo;s copyrights, trademarks, patents, or other intellectual property rights;</p></li><li><p>Each contribution shall be in compliance with U.S. export control laws and other applicable export and import laws.</p></li></ul><p>You agree to notify us if you become aware of any circumstance which would make any of the foregoing representations inaccurate in any respect.</p><p>All code must comply with the reasonable standards issued by Website Services distribution, including architecture and security protocols. All code submitted to the repository that is a derivative work must be
<a href=https://www.gnu.org/licenses/license-list.en.html#GPLCompatibleLicenses target=_blank>GPLv2+ compatible</a> and will automatically be redistributed as GPLv2+.</p><p>YUSA in its sole discretion will review, modify and determine whether to include code in its next release. We can refuse or remove any contributions at our discretion and without prior notice.</p><p><strong>Disclaimer</strong></p><p><strong>All content is provided “as is,” without any warranty of any kind, either expressed or implied, including, but not limited to, the implied warranties of merchantability, fitness for a particular purpose and non-infringement; (ii) YUSA makes no other warranty that its services will meet your requirements, be safe, secure, uninterrupted, timely, accurate, or error-free, or that your information will be secure; and (iii) the entire risk as to the quality and performance of the content is with you.</strong></p><p><strong>Limit of Liability</strong></p><p><strong>In no event will YUSA, its affiliates or their licensors, service providers, employees, agents, officers, or directors be liable for any indirect, special, incidental, consequential or punitive damages, including but not limited to loss of revenue, loss of profits, loss of business or anticipated savings, loss of goodwill, and whether caused by tort (including negligence), breach of contract or otherwise, even if foreseeable. The foregoing does not affect any liability which cannot be excluded or limited under applicable law.</strong></p><p><strong>Copyright DMCA Notice</strong></p><p>If a user or other third party believes that its content has been copied in a way that constitutes copyright infringement, that user or third party should provide YUSA with the following information: (a) an electronic or physical signature of the person authorized to act on behalf of the owner of the copyright</p><p>interest; (b) a description of the copyrighted work that has been infringed; (c) a description of where the allegedly infringing material is located; (d) the affected user or third party&rsquo;s address, telephone number and email address; (e) a statement by the affected user or third party that he or she has a good faith belief that the disputed use is not authorized by the copyright owner, its agent or the law; and (f) a statement by the affected user or third party, under penalty of perjury, that the above information is accurate and that such user or third party is the copyright owner or is otherwise authorized to act on the copyright owner&rsquo;s behalf. Please report any alleged copyright infringements to
<a href=https://ymca.org target=_blank>https://ymca.org</a>.</p><p><strong>Venue and Governing Law</strong>
This Agreement shall be governed by, and construed in accordance with, the laws of the State of Minnesota, without reference to conflicts of laws principles. The parties agree that the federal and state courts in the county of Hennepin, Minnesota will have exclusive jurisdiction and venue under this Agreement, and each party hereby agrees to submit to such jurisdiction exclusively.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="YMCA Website Services" aria-label="YMCA Website Services"><a target=_blank rel=noopener href=https://ds.ymca.org/ aria-label="YMCA Website Services"><i class="fa fa-globe"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=LinkedIn aria-label=LinkedIn><a target=_blank rel=noopener href=https://www.linkedin.com/company/ymcausa/ aria-label=LinkedIn><i class="fab fa-linkedin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=YouTube aria-label=YouTube><a target=_blank rel=noopener href=https://www.youtube.com/@ymcasdigitalservices aria-label=YouTube><i class="fab fa-youtube"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="YouTube (Archive)" aria-label="YouTube (Archive)"><a target=_blank rel=noopener href=https://www.youtube.com/channel/UC4hp3K9JFptqPZyNjJLvkJg aria-label="YouTube (Archive)"><i class="fab fa-youtube"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/YCloudYUSA/yusaopeny aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Slack aria-label=Slack><a target=_blank rel=noopener href="mailto:ycloud@ymca.net?subject=Slack%20Access%20Request" aria-label=Slack><i class="fab fa-slack"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Message Board" aria-label="Message Board"><a target=_blank rel=noopener href=https://community.ycloud.y.org aria-label="Message Board"><i class="fa fa-user-friends"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>YMCA Website Services</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://ds.ymca.org/ target=_blank rel=noopener>https://ds.ymca.org/</a></span></div></div></div></footer></div><script src=/js/main.min.fd96d5f2e6c43bcf373f2ce509c626f962ebc9437b894f0cd006baa4a70248e3.js integrity="sha256-/ZbV8ubEO883PyzlCcYm+WLryUN7iU8M0Aa6pKcCSOM=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.6.0 integrity="sha512-FtDaTWf3IS29TLuYzTPlytjGqcXkwrzG9ivq7xXElnOZeiYTbcIy/hwXAgrrRNnI0+PfN+WFz4/+4phhJmuS8Q==" crossorigin=anonymous></script><script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"IKYHW432S0",apiKey:"daf6dd319fdc9982386b73a0d53d9f89",indexName:"ds-y"})</script><script src=/js/tabpane-persist.js></script></body></html>